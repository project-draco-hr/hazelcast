{
  if (awsConfig == null) {
    throw new IllegalArgumentException("AwsConfig is required!");
  }
  if (awsConfig.getAccessKey() == null && awsConfig.getIamRole() == null) {
    throw new IllegalArgumentException("AWS access key or IAM Role is required!");
  }
  if (awsConfig.getSecretKey() == null && awsConfig.getIamRole() == null) {
    throw new IllegalArgumentException("AWS secret key or Iam Role is required!");
  }
  this.awsConfig=awsConfig;
  endpoint=awsConfig.getHostHeader();
  if (awsConfig.getRegion() != null && awsConfig.getRegion().length() > 0) {
    if (!awsConfig.getHostHeader().startsWith("ec2.")) {
      throw new InvalidConfigurationException("HostHeader should start with \"ec2.\" prefix");
    }
    setEndpoint(awsConfig.getHostHeader().replace("ec2.","ec2." + awsConfig.getRegion() + "."));
  }
}

{
  Iterator<Queue<ScheduledOperation>> it=mapScheduledOperations.values().iterator();
  while (it.hasNext()) {
    Queue<ScheduledOperation> qScheduledOps=it.next();
    Iterator<ScheduledOperation> itOps=qScheduledOps.iterator();
    while (itOps.hasNext()) {
      ScheduledOperation so=itOps.next();
      if (so.isValid() && so.expired()) {
        so.getOperation().onExpire();
        so.setValid(false);
        itOps.remove();
      }
    }
    if (qScheduledOps.isEmpty()) {
      it.remove();
    }
  }
}

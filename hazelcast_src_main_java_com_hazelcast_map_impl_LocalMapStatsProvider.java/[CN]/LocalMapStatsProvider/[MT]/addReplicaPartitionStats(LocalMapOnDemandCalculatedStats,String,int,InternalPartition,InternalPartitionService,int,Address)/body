{
  long heapCost=0;
  long backupEntryCount=0;
  long backupEntryMemoryCost=0;
  for (int replica=1; replica <= backupCount; replica++) {
    final Address replicaAddress=getReplicaAddress(replica,partition,partitionService,backupCount);
    if (notGotReplicaAddress(replicaAddress,partitionService,backupCount)) {
      printWarning(partition,replica);
      continue;
    }
    if (gotReplicaAddress(replicaAddress,thisAddress)) {
      RecordStore recordStore=getRecordStoreOrNull(mapName,partitionId);
      if (hasRecords(recordStore)) {
        heapCost+=recordStore.getHeapCost();
        backupEntryCount+=recordStore.size();
        backupEntryMemoryCost+=getMemoryCost(recordStore);
      }
    }
  }
  localMapOnDemandCalculatedStats.incrementHeapCost(heapCost);
  localMapOnDemandCalculatedStats.incrementBackupEntryCount(backupEntryCount);
  localMapOnDemandCalculatedStats.incrementBackupEntryMemoryCost(backupEntryMemoryCost);
}

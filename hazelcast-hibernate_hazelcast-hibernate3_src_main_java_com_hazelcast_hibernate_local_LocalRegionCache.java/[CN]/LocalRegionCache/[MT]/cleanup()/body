{
  final int maxSize;
  final long timeToLive;
  if (config != null) {
    maxSize=config.getMaxSizeConfig().getSize();
    timeToLive=config.getTimeToLiveSeconds() * SEC_TO_MS;
  }
 else {
    maxSize=MAX_SIZE;
    timeToLive=CacheEnvironment.getDefaultCacheTimeoutInMillis();
  }
  boolean limitSize=maxSize > 0 && maxSize != Integer.MAX_VALUE;
  if (limitSize || timeToLive > 0) {
    List<EvictionEntry> entries=searchEvictableEntries(timeToLive,limitSize);
    final int diff=cache.size() - maxSize;
    final int evictionRate=calculateEvictionRate(diff,maxSize);
    if (evictionRate > 0 && entries != null) {
      evictEntries(entries,evictionRate);
    }
  }
}

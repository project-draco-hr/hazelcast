{
  Config config=new Config();
  config.setProperty(GroupProperty.PARTITION_COUNT,"2");
  config.setProperty(GroupProperty.QUERY_RESULT_SIZE_LIMIT,"" + RESULT_SIZE_LIMIT);
  hz=createHazelcastInstance(config);
  map=hz.getMap(randomName());
  MapService mapService=getNodeEngineImpl(hz).getService(MapService.SERVICE_NAME);
  queryEngine=new MapQueryEngineImpl(mapService.getMapServiceContext(),new RuleBasedQueryOptimizer());
  QueryResultSizeLimiter resultSizeLimiter=queryEngine.getQueryResultSizeLimiter();
  limit=(int)resultSizeLimiter.getNodeResultLimit(1);
}

{
  Set<Integer>[] nodePartitions=nodePartitionsMap.get(node);
  if (nodePartitions == null) {
    nodePartitions=new Set[PartitionView.MAX_REPLICA_COUNT];
    for (int i=0; i < PartitionView.MAX_REPLICA_COUNT; i++) {
      nodePartitions[i]=new HashSet<Integer>();
    }
    nodePartitionsMap.put(node,nodePartitions);
  }
  return nodePartitions;
}

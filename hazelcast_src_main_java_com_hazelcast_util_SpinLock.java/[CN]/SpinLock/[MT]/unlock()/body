{
  final Thread currentThread=Thread.currentThread();
  if (currentThread.getId() != tid) {
    throw new IllegalMonitorStateException("Current thread is not owner of the lock!");
  }
  if (count > 1) {
    count--;
    return;
  }
  if (!locked.getAndSet(false)) {
    throw new IllegalMonitorStateException("Current thread is not owner of the lock!");
  }
  tid=-1L;
  count=0;
}

{
  final RegionFactory rf=settings.getRegionFactory();
  if (rf == null) {
    logger.log(Level.SEVERE,"Hibernate 2nd level cache has not been enabled!");
    return null;
  }
  if (rf instanceof RegionFactoryCacheProviderBridge) {
    final CacheProvider provider=((RegionFactoryCacheProviderBridge)rf).getCacheProvider();
    if (provider instanceof HazelcastCacheProvider) {
      return ((HazelcastCacheProvider)provider).getHazelcastInstance();
    }
    logger.log(Level.WARNING,"Current 2nd level cache implementation is not HazelcastCacheProvider!");
  }
 else   if (rf instanceof AbstractHazelcastCacheRegionFactory) {
    return ((AbstractHazelcastCacheRegionFactory)rf).getHazelcastInstance();
  }
 else {
    logger.log(Level.WARNING,"Current 2nd level cache implementation is not HazelcastCacheRegionFactory!");
  }
  return null;
}

{
  if (evictableSize <= 0) {
    return Collections.emptyList();
  }
  final Map<Data,Record> entries=recordStore.getReadonlyRecordMap();
  final int size=entries.size();
  final long[] criterias=new long[size];
  int index=0;
  for (  final Record record : entries.values()) {
    if (record.getStatistics() == null) {
      criterias[index]=0L;
    }
 else {
      final long criteriaValue=getEvictionCriteriaValue(record,evictionPolicy);
      criterias[index]=criteriaValue;
    }
    index++;
    if (index == size) {
      break;
    }
  }
  Arrays.sort(criterias);
  final List<Record> evictableRecords=new ArrayList<Record>(evictableSize);
  final long criteriaValue=criterias[evictableSize - 1];
  int evictionCounter=0;
  for (  final Map.Entry<Data,Record> entry : entries.entrySet()) {
    final Record record=entry.getValue();
    final long value=getEvictionCriteriaValue(record,evictionPolicy);
    if (value <= criteriaValue) {
      evictableRecords.add(record);
      evictionCounter++;
    }
    if (evictionCounter >= evictableSize) {
      break;
    }
  }
  return evictableRecords;
}

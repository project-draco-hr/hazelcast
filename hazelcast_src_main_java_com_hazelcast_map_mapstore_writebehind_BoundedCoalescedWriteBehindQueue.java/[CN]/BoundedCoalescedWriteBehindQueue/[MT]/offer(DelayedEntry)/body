{
  if (entry == null) {
    return false;
  }
  final int currentPerNodeCount=currentPerNodeCount();
  if (hasReachedMaxSize(currentPerNodeCount)) {
    throw new ReachedMaxSizeException("Queue already reached per node max capacity [" + maxSize + "]");
  }
  incrementPerNodeMaxSize();
  return super.offer(entry);
}

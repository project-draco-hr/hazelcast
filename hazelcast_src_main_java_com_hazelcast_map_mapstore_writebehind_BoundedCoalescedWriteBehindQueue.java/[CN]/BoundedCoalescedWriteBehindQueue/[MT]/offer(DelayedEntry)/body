{
  if (entry == null) {
    return false;
  }
  final int currentPerNodeCount=currentPerNodeCount();
  if (hasReachedMaxSize(currentPerNodeCount)) {
    throw new ReachedMaxSizeException("Queue already reached per node max capacity [" + maxSize + "]");
  }
  final int beforeOffer=queue.size();
  final boolean result=super.offer(entry);
  final int afterOffer=queue.size();
  incrementPerNodeMaxSize(afterOffer - beforeOffer);
  return result;
}

{
  checkIfLoaded();
  final long now=getNow();
  final MapEntrySet mapEntrySet=new MapEntrySet();
  final Iterator<Data> iterator=keys.iterator();
  while (iterator.hasNext()) {
    final Data key=iterator.next();
    final Record record=getRecordOrNull(key,now,false);
    if (record != null) {
      addMapEntrySet(record.getKey(),record.getValue(),mapEntrySet);
      accessRecord(record);
      iterator.remove();
    }
  }
  Map loadedEntries=loadEntries(keys);
  addMapEntrySet(loadedEntries,mapEntrySet);
  return mapEntrySet;
}

{
  if (lockStore == null) {
    return Collections.emptyMap();
  }
  final Collection<Data> lockedKeys=lockStore.getLockedKeys();
  if (lockedKeys.isEmpty()) {
    return Collections.emptyMap();
  }
  final Map<Data,Record> lockedRecords=new HashMap<Data,Record>(lockedKeys.size());
  for (  Data key : lockedKeys) {
    final Record record=records.get(key);
    if (record != null) {
      lockedRecords.put(key,record);
    }
  }
  return lockedRecords;
}

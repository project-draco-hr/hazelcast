{
synchronized (this) {
    if (!ended) {
      connection.close();
      ended=true;
    }
  }
}

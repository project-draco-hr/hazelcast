{
  while (connectionManager.isLive()) {
    int keyCount=selector.select();
    if (isInterrupted()) {
      break;
    }
    if (keyCount == 0) {
      continue;
    }
    Iterator<SelectionKey> it=selector.selectedKeys().iterator();
    while (it.hasNext()) {
      SelectionKey sk=it.next();
      it.remove();
      if (sk.isValid() && sk.isAcceptable()) {
        acceptSocket();
      }
    }
  }
}

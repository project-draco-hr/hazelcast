{
  ClusterService clusterService=nodeEngine.getClusterService();
  ClusterState clusterState=clusterService.getClusterState();
  if (clusterState == ClusterState.FROZEN || clusterState == ClusterState.PASSIVE) {
    notifyError(new IllegalStateException("Partitions can't be assigned since cluster-state: " + clusterState));
  }
 else   if (clusterService.getSize(DATA_MEMBER_SELECTOR) == 0) {
    notifyError(new NoDataMemberInClusterException("Partitions can't be assigned since all nodes in the cluster are lite members"));
  }
 else {
    notifyError(new WrongTargetException(nodeEngine.getThisAddress(),null,op.getPartitionId(),op.getReplicaIndex(),op.getClass().getName(),op.getServiceName()));
  }
}

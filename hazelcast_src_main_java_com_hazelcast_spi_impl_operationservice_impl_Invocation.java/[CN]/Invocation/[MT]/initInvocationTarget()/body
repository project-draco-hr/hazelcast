{
  Address thisAddress=nodeEngine.getThisAddress();
  invTarget=getTarget();
  final ClusterService clusterService=nodeEngine.getClusterService();
  if (invTarget == null) {
    remote=false;
    notifyWithExceptionWhenTargetIsNull();
    return false;
  }
  targetMember=clusterService.getMember(invTarget);
  if (targetMember == null && !(isJoinOperation(op) || isWanReplicationOperation(op))) {
    notifyError(new TargetNotMemberException(invTarget,partitionId,op.getClass().getName(),serviceName));
    return false;
  }
  if (op.getPartitionId() != partitionId) {
    notifyError(new IllegalStateException("Partition id of operation: " + op.getPartitionId() + " is not equal to the partition id of invocation: "+ partitionId));
    return false;
  }
  if (op.getReplicaIndex() != replicaIndex) {
    notifyError(new IllegalStateException("Replica index of operation: " + op.getReplicaIndex() + " is not equal to the replica index of invocation: "+ replicaIndex));
    return false;
  }
  remote=!thisAddress.equals(invTarget);
  return true;
}

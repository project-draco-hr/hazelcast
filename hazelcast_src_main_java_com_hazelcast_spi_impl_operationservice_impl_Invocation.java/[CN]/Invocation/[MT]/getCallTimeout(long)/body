{
  if (callTimeout > 0) {
    return callTimeout;
  }
  long defaultCallTimeout=operationService.defaultCallTimeoutMillis;
  if (!(op instanceof BlockingOperation)) {
    return defaultCallTimeout;
  }
  long waitTimeoutMillis=op.getWaitTimeout();
  if (waitTimeoutMillis > 0 && waitTimeoutMillis < Long.MAX_VALUE) {
    long max=Math.max(waitTimeoutMillis,MIN_TIMEOUT);
    return Math.min(max,defaultCallTimeout);
  }
  return defaultCallTimeout;
}

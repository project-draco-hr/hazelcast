{
  final List<PartitionLostEvent> failedPartitions=listener.getEvents();
  assertFalse(survivingPartitions.isEmpty());
  for (  PartitionLostEvent event : failedPartitions) {
    final int failedPartitionId=event.getPartitionId();
    final int lostReplicaIndex=event.getLostBackupCount();
    final int survivingReplicaIndex=survivingPartitions.get(failedPartitionId);
    final String message=log + ", Event: " + event+ " SurvivingReplicaIndex: "+ survivingReplicaIndex+ " PartitionTable: "+ partitionTables.get(failedPartitionId);
    assertTrue(message,survivingReplicaIndex > 0);
    assertTrue(message,lostReplicaIndex >= 0 && lostReplicaIndex < survivingReplicaIndex);
  }
}

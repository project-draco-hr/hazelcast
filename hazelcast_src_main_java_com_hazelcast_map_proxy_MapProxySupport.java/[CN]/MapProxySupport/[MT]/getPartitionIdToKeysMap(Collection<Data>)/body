{
  if (keys == null || keys.isEmpty()) {
    return Collections.emptyMap();
  }
  final InternalPartitionService partitionService=getNodeEngine().getPartitionService();
  final Map<Integer,Collection<Data>> idToKeys=new HashMap<Integer,Collection<Data>>();
  final Iterator<Data> iterator=keys.iterator();
  while (iterator.hasNext()) {
    final Data key=iterator.next();
    final int partitionId=partitionService.getPartitionId(key);
    Collection<Data> keyList=idToKeys.get(partitionId);
    if (keyList == null) {
      keyList=new ArrayList<Data>();
      idToKeys.put(partitionId,keyList);
    }
    keyList.add(key);
  }
  return idToKeys;
}

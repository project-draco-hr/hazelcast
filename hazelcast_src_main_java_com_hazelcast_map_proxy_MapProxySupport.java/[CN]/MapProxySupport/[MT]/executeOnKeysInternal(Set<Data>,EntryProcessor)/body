{
  Map result=new HashMap();
  final NodeEngine nodeEngine=getNodeEngine();
  final Collection<Integer> partitionsForKeys=getPartitionsForKeys(keys);
  try {
    MultipleEntryOperationFactory operationFactory=new MultipleEntryOperationFactory(name,keys,entryProcessor);
    Map<Integer,Object> results=nodeEngine.getOperationService().invokeOnPartitions(SERVICE_NAME,operationFactory,partitionsForKeys);
    for (    Object o : results.values()) {
      if (o != null) {
        final MapService service=getService();
        final MapEntrySet mapEntrySet=(MapEntrySet)o;
        for (        Entry<Data,Data> entry : mapEntrySet.getEntrySet()) {
          result.put(service.toObject(entry.getKey()),service.toObject(entry.getValue()));
        }
      }
    }
    invalidateNearCache(keys);
  }
 catch (  Throwable t) {
    throw ExceptionUtil.rethrow(t);
  }
  return result;
}

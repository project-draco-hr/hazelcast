{
  final NodeEngine nodeEngine=getNodeEngine();
  final MapService mapService=getService();
  Set<Data> keySet=new HashSet<Data>();
  try {
    List<Integer> memberPartitions=nodeEngine.getPartitionService().getMemberPartitions(nodeEngine.getThisAddress());
    for (    Integer memberPartition : memberPartitions) {
      RecordStore recordStore=mapService.getRecordStore(memberPartition,name);
      keySet.addAll(recordStore.getReadonlyRecordMap().keySet());
    }
    return keySet;
  }
 catch (  Throwable t) {
    throw ExceptionUtil.rethrow(t);
  }
}

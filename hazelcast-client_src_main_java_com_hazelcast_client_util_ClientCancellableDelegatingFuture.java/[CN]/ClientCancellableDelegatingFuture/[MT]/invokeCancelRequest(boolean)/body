{
  CancellationRequest request;
  Address address=getTargetAddress();
  if (address != null) {
    request=new CancellationRequest(uuid,address,mayInterruptIfRunning);
  }
 else {
    final ClientPartitionService partitionService=context.getPartitionService();
    address=partitionService.getPartitionOwner(partitionId);
    request=new CancellationRequest(uuid,partitionId,mayInterruptIfRunning);
  }
  final HazelcastClientInstanceImpl client=(HazelcastClientInstanceImpl)context.getHazelcastInstance();
  try {
    final ClientInvocation clientInvocation=new ClientInvocation(client,request,address);
    return clientInvocation.invoke();
  }
 catch (  Exception e) {
    throw rethrow(e);
  }
}

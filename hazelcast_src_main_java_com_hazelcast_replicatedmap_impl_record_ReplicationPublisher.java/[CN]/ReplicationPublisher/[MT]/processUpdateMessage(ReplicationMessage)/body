{
  if (localMember.equals(update.getOrigin())) {
    return;
  }
  mapStats.incrementReceivedReplicationEvents();
  if (update.getKey() instanceof String) {
    String key=(String)update.getKey();
    if (AbstractReplicatedRecordStore.CLEAR_REPLICATION_MAGIC_KEY.equals(key)) {
      storage.clear();
      return;
    }
  }
  K marshalledKey=(K)replicatedRecordStore.marshallKey(update.getKey());
synchronized (replicatedRecordStore.getMutex(marshalledKey)) {
    final ReplicatedRecord<K,V> localEntry=storage.get(marshalledKey);
    if (localEntry == null) {
      createLocalEntry(update,marshalledKey);
    }
 else {
      updateLocalEntry(localEntry,update);
    }
  }
}

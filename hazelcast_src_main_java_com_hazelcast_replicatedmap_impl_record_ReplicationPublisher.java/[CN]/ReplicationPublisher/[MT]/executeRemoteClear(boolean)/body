{
  MemberSelector selector=MemberSelectors.and(DATA_MEMBER_SELECTOR,NON_LOCAL_MEMBER_SELECTOR);
  List<Member> failedMembers=new ArrayList<Member>(clusterService.getMembers(selector));
  for (int i=0; i < MAX_CLEAR_EXECUTION_RETRY; i++) {
    Map<Member,InternalCompletableFuture> futures=executeClearOnMembers(failedMembers,emptyReplicationQueue);
    failedMembers.clear();
    for (    Entry<Member,InternalCompletableFuture> future : futures.entrySet()) {
      try {
        future.getValue().get();
      }
 catch (      Exception e) {
        nodeEngine.getLogger(ReplicationPublisher.class).finest(e);
        failedMembers.add(future.getKey());
      }
    }
    if (failedMembers.size() == 0) {
      return;
    }
  }
  throw new OperationTimeoutException("ReplicatedMap::clear couldn't be finished, failed nodes: " + failedMembers);
}

{
  server1=Hazelcast.newHazelcastInstance();
  server2=Hazelcast.newHazelcastInstance();
  client=HazelcastClient.newHazelcastClient(null);
  q=client.getQueue(name);
  final CountDownLatch latch=new CountDownLatch(1);
  new Thread(){
    public void run(){
      for (int i=0; i < 100; i++) {
        if (q.offer("item" + i)) {
          System.err.println("offered item" + i);
        }
        try {
          Thread.sleep(50);
        }
 catch (        InterruptedException e) {
          e.printStackTrace();
        }
      }
      latch.countDown();
      System.err.println("-------------done");
    }
  }
.start();
  Thread.sleep(1000);
  server2.getLifecycleService().shutdown();
  latch.await();
  q.offer("item");
  System.err.println("size : " + q.size());
  client.getLifecycleService().shutdown();
  Hazelcast.shutdownAll();
}

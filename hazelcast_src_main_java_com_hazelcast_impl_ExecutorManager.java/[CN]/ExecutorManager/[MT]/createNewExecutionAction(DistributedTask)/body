{
  if (task == null)   throw new RuntimeException("task cannot be null");
  Long executionId=null;
  try {
    executionId=executionIds.take();
  }
 catch (  InterruptedException e) {
    throw new RuntimeException(e);
  }
  final InnerFutureTask inner=(InnerFutureTask)task.getInner();
  final Callable callable=inner.getCallable();
  final Data callableData=toData(callable);
  final DistributedExecutorAction action=new DistributedExecutorAction(executionId,task,callableData,callable);
  inner.setExecutionManagerCallback(action);
  return action;
}

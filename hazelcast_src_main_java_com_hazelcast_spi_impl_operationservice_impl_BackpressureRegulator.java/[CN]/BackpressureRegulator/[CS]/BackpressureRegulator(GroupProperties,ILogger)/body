{
  this.enabled=properties.BACKPRESSURE_ENABLED.getBoolean();
  this.disabled=!enabled;
  this.logger=logger;
  this.partitionCount=properties.PARTITION_COUNT.getInteger();
  this.syncWindow=getSyncWindow(properties);
  this.maxConcurrentInvocations=getMaxConcurrentInvocations(properties);
  this.backoffTimeoutMs=getBackoffTimeoutMs(properties);
  this.syncDelays=new AtomicInteger[partitionCount + 1];
  for (int k=0; k < syncDelays.length; k++) {
    syncDelays[k]=new AtomicInteger(randomSyncDelay());
  }
  if (enabled) {
    logger.info("Backpressure is enabled" + ", maxConcurrentInvocations:" + maxConcurrentInvocations + ", syncWindow: "+ syncWindow);
  }
 else {
    logger.info("Backpressure is disabled");
  }
}

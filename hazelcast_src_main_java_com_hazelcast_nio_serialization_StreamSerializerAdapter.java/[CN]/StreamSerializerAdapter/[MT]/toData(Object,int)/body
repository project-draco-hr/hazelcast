{
  final BufferObjectDataOutput out=service.pop();
  try {
    serializer.write(out,object);
    byte[] header=null;
    if (out instanceof PortableDataOutput) {
      header=((PortableDataOutput)out).getPortableHeader();
    }
    return new HeapData(serializer.getTypeId(),out.toByteArray(),partitionHash,header);
  }
  finally {
    service.push(out);
  }
}

{
  final String cacheName=randomMapName();
  CacheManager cacheManager=cachingProvider1.getCacheManager();
  assertNotNull(cacheManager);
  assertNull(cacheManager.getCache(cacheName));
  CompleteConfiguration<Integer,Integer> config=new CacheConfig<Integer,Integer>().setTypes(Integer.class,Integer.class).setReadThrough(true).setCacheLoaderFactory(FactoryBuilder.factoryOf(new GetAllAsyncCacheLoader()));
  Cache<Integer,Integer> cache=cacheManager.createCache(cacheName,config);
  assertNotNull(cache);
  assertTrueEventually(new AssertTask(){
    @Override public void run() throws Exception {
      CacheManager cm2=cachingProvider2.getCacheManager();
      assertNotNull(cm2.getCache(cacheName,Integer.class,Integer.class));
    }
  }
);
  Set<Integer> keys=new HashSet<Integer>();
  for (int i=0; i < 150; i++) {
    keys.add(i);
  }
  final CountDownLatch latch=new CountDownLatch(1);
  cache.loadAll(keys,false,new CompletionListener(){
    @Override public void onCompletion(){
      latch.countDown();
    }
    @Override public void onException(    Exception e){
      e.printStackTrace();
      latch.countDown();
    }
  }
);
  latch.await();
  assertEquals(100,cache.unwrap(ICache.class).size());
}

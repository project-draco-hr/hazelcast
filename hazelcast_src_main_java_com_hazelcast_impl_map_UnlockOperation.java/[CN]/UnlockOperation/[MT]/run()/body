{
  int partitionId=getPartitionId();
  ResponseHandler responseHandler=getResponseHandler();
  MapService mapService=(MapService)getService();
  PartitionContainer pc=mapService.getPartitionContainer(partitionId);
  MapPartition mapPartition=mapService.getMapPartition(partitionId,name);
  LockInfo lock=mapPartition.getLock(getKey());
  if (lock != null && lock.testLock(threadId,getCaller())) {
    if (lock.unlock(getCaller(),threadId)) {
      GenericBackupOperation backupOp=new GenericBackupOperation(name,dataKey,null,ttl,pc.incrementAndGetVersion());
      backupOp.setBackupOpType(GenericBackupOperation.BackupOpType.UNLOCK);
      int backupCount=mapPartition.getBackupCount();
      getNodeService().sendBackups(MapService.MAP_SERVICE_NAME,backupOp,partitionId,backupCount);
    }
    if (!lock.isLocked()) {
      pc.onUnlock(lock,name,getKey());
      mapPartition.removeLock(getKey());
    }
    responseHandler.sendResponse(Boolean.TRUE);
  }
 else {
    responseHandler.sendResponse(Boolean.FALSE);
  }
}

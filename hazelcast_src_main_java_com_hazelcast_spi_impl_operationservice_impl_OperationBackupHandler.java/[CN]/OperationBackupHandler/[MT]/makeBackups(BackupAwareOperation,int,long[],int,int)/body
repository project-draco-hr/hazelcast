{
  int sendSyncBackups=0;
  InternalPartitionService partitionService=node.getPartitionService();
  InternalPartition partition=partitionService.getPartition(partitionId);
  Operation backupOp=backupAwareOp.getBackupOperation();
  if (backupOp == null) {
    throw new IllegalArgumentException("Backup operation should not be null! " + backupAwareOp);
  }
  Operation op=(Operation)backupAwareOp;
  backupOp.setServiceName(op.getServiceName());
  Data backupOpData=nodeEngine.getSerializationService().toData(backupOp);
  for (int replicaIndex=1; replicaIndex <= syncBackups + asyncBackups; replicaIndex++) {
    Address target=partition.getReplicaAddress(replicaIndex);
    if (target == null) {
      continue;
    }
    assertNoBackupOnPrimaryMember(partition,target);
    boolean isSyncBackup=replicaIndex <= syncBackups;
    Backup backup=newBackup(backupAwareOp,backupOpData,replicaVersions,replicaIndex,isSyncBackup);
    operationService.send(backup,target);
    if (isSyncBackup) {
      sendSyncBackups++;
    }
  }
  return sendSyncBackups;
}

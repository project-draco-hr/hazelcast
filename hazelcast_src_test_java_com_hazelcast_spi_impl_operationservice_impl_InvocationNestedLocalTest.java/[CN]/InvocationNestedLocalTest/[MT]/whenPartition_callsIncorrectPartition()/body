{
  HazelcastInstance hz=createHazelcastInstance();
  OperationService operationService=getOperationService(hz);
  int outerPartitionId=0;
  int innerPartitionId=1;
  for (; innerPartitionId < hz.getPartitionService().getPartitions().size(); innerPartitionId++) {
    if (!mappedToSameThread(operationService,outerPartitionId,innerPartitionId)) {
      break;
    }
  }
  InnerOperation innerOperation=new InnerOperation(response,innerPartitionId);
  OuterOperation outerOperation=new OuterOperation(innerOperation,outerPartitionId);
  InternalCompletableFuture f=operationService.invokeOnPartition(null,outerOperation,outerOperation.getPartitionId());
  try {
    f.getSafely();
    fail();
  }
 catch (  IllegalThreadStateException e) {
  }
}

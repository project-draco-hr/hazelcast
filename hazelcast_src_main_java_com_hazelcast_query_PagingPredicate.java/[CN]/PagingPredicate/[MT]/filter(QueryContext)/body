{
  if (predicate instanceof IndexAwarePredicate) {
    Set<QueryableEntry> set=((IndexAwarePredicate)predicate).filter(queryContext);
    if (set == null) {
      return null;
    }
    List<QueryableEntry> list=new LinkedList<QueryableEntry>();
    for (    QueryableEntry entry : set) {
      if (anchor != null && SortingUtil.compare(comparator,anchor,entry.getValue()) >= 0) {
        continue;
      }
      list.add(entry);
    }
    Collections.sort(list,new Comparator<QueryableEntry>(){
      public int compare(      QueryableEntry o1,      QueryableEntry o2){
        final Object value1=o1.getValue();
        final Object value2=o2.getValue();
        return SortingUtil.compare(comparator,value1,value2);
      }
    }
);
    if (list.size() > pageSize) {
      list=list.subList(0,pageSize);
    }
    return new LinkedHashSet<QueryableEntry>(list);
  }
  return null;
}

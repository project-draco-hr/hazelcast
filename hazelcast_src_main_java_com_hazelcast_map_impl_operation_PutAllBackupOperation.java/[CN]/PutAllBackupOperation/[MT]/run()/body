{
  int partitionId=getPartitionId();
  recordStore=mapService.getMapServiceContext().getRecordStore(partitionId,name);
  boolean wanEnabled=mapContainer.getWanReplicationPublisher() != null && mapContainer.getWanMergePolicy() != null;
  for (int i=0; i < entries.size(); i++) {
    final RecordInfo recordInfo=recordInfos.get(i);
    final Map.Entry<Data,Data> entry=entries.get(i);
    final Record record=recordStore.putBackup(entry.getKey(),entry.getValue());
    Records.applyRecordInfo(record,recordInfo);
    if (wanEnabled) {
      final Data dataValueAsData=mapService.getMapServiceContext().toData(entry.getValue());
      final EntryView entryView=EntryViews.createSimpleEntryView(entry.getKey(),dataValueAsData,record);
      mapService.getMapServiceContext().getMapEventPublisher().publishWanReplicationUpdateBackup(name,entryView);
    }
  }
}

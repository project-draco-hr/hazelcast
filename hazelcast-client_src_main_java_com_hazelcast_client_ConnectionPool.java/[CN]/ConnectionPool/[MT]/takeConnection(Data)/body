{
  if (key == null)   return singlePool.take();
  if (partitionCount.get() == 0) {
    return mPool.values().iterator().next().take();
  }
  int id=key.getPartitionHash() % partitionCount.get();
  Member member=partitionTable.get(id);
  if (member == null) {
    return singlePool.take();
  }
  return mPool.get(member.getInetSocketAddress()).take();
}

{
  NodeEngine nodeEngine=getNodeEngine();
  InternalPartitionServiceImpl partitionService=getService();
  int partitionId=getPartitionId();
  int replicaIndex=getReplicaIndex();
  InternalPartitionImpl partition=partitionService.getPartition(partitionId,false);
  boolean isBackup=partition.isOwnerOrBackup(nodeEngine.getThisAddress());
  try {
    if (isBackup) {
      executeTasks();
    }
 else {
      ILogger logger=getLogger();
      if (logger.isFinestEnabled()) {
        logger.finest("This node is not backup replica of partition: " + partitionId + ", replica: "+ replicaIndex+ " anymore.");
      }
    }
    if (tasks != null) {
      tasks.clear();
    }
  }
  finally {
    if (isBackup) {
      partitionService.finalizeReplicaSync(partitionId,replicaIndex,replicaVersions);
    }
 else {
      partitionService.clearReplicaSync(partitionId,replicaIndex);
    }
  }
}

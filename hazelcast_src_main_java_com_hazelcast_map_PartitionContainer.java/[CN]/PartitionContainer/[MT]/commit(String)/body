{
  TransactionLog txnLog=transactions.remove(txnId);
  if (txnLog == null)   return;
  for (  TransactionLogItem txnLogItem : txnLog.changes.values()) {
    System.out.println(mapService.getNodeEngine().getThisAddress() + " pc.commit " + txnLogItem);
    RecordStore recordStore=getRecordStore(txnLogItem.getName());
    Data key=txnLogItem.getKey();
    if (txnLogItem.isRemoved()) {
      recordStore.remove(key);
    }
 else {
      Record record=recordStore.getRecords().get(key);
      if (record == null) {
        record=mapService.createRecord(txnLogItem.getName(),key,txnLogItem.getValue(),-1);
        recordStore.getRecords().put(key,record);
      }
 else {
        recordStore.setRecordValue(record,txnLogItem.getValue());
      }
    }
  }
}

{
  if (!valid) {
    onExecutionFailure(new IllegalStateException("Wrong target! " + toString() + " cannot be processed!"));
    return;
  }
  NodeEngine nodeEngine=getNodeEngine();
  if (backupOp == null && backupOpData != null) {
    backupOp=nodeEngine.getSerializationService().toObject(backupOpData);
  }
  if (backupOp != null) {
    ensureBackupOperationInitialized();
    backupOp.beforeRun();
    backupOp.run();
    backupOp.afterRun();
  }
  InternalPartitionService partitionService=nodeEngine.getPartitionService();
  partitionService.updatePartitionReplicaVersions(getPartitionId(),replicaVersions,getReplicaIndex());
}

{
  checkLive();
  if (address == null) {
    address=router.next();
    if (address == null) {
      throw new IOException("LoadBalancer '" + router + "' could not find a address to route to");
    }
  }
  final ObjectPool<Connection> pool=getConnectionPool(address);
  final Connection connection=pool.take();
  if (connection == null) {
    checkLive();
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException ignored) {
    }
    return getConnection(null);
  }
  if (!heartbeat.checkHeartBeat(connection)) {
    try {
      connection.close();
    }
 catch (    IOException ignored) {
    }
    return getConnection(null);
  }
  return connection;
}

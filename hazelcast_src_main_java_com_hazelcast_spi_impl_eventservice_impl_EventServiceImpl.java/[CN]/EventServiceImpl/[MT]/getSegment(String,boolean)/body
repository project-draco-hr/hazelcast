{
  EventServiceSegment segment=segments.get(service);
  if (segment == null && forceCreate) {
    ConstructorFunction<String,EventServiceSegment> func=new ConstructorFunction<String,EventServiceSegment>(){
      @Override public EventServiceSegment createNew(      String key){
        return new EventServiceSegment(key,nodeEngine.getService(key));
      }
    }
;
    return ConcurrencyUtil.getOrPutIfAbsent(segments,service,func);
  }
  return segment;
}

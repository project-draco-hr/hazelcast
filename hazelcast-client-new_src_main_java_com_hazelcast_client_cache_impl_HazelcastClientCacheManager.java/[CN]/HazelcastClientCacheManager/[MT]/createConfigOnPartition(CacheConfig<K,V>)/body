{
  HazelcastClientInstanceImpl client=(HazelcastClientInstanceImpl)clientContext.getHazelcastInstance();
  try {
    int partitionId=clientContext.getPartitionService().getPartitionId(cacheConfig.getNameWithPrefix());
    Data cacheConfigData=clientContext.getSerializationService().toData(cacheConfig);
    ClientMessage request=CacheCreateConfigParameters.encode(cacheConfigData,false);
    ClientInvocation clientInvocation=new ClientInvocation(client,request,partitionId);
    Future<ClientMessage> future=clientInvocation.invoke();
    ClientMessage responseMessage=future.get();
    final Data result=GenericResultParameters.decode(responseMessage).result;
    return (CacheConfig<K,V>)clientContext.getSerializationService().toObject(result);
  }
 catch (  Exception e) {
    throw ExceptionUtil.rethrow(e);
  }
}

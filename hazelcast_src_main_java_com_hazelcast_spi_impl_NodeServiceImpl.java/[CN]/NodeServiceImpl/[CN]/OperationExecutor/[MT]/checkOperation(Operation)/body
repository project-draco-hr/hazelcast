{
  final int partitionId=op.getPartitionId();
  if (partitionId >= 0) {
    PartitionInfo partitionInfo=getPartitionInfo(partitionId);
    Address owner=partitionInfo.getReplicaAddress(op.getReplicaIndex());
    if (!isPartitionLockFreeOperation(op) && node.partitionService.isPartitionLocked(partitionId)) {
      throw new PartitionMigratingException(getThisAddress(),owner,partitionId,op.getClass().getName(),op.getServiceName());
    }
    final boolean shouldValidateTarget=op.shouldValidateTarget();
    if (shouldValidateTarget && !getThisAddress().equals(owner)) {
      throw new WrongTargetException(getThisAddress(),owner,partitionId,op.getClass().getName(),op.getServiceName());
    }
  }
}

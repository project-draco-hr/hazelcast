{
  if (!localMember)   throw new UnsupportedOperationException("Attributes on remote members must not be changed");
  if (value == null)   throw new IllegalArgumentException("value must not be null");
  if (value != null) {
    Object oldValue=attributes.put(key,value);
    if (value.equals(oldValue)) {
      return;
    }
  }
 else {
    attributes.remove(key);
  }
  if (instance != null) {
    NodeEngineImpl nodeEngine=instance.node.nodeEngine;
    OperationService os=nodeEngine.getOperationService();
    MemberAttributeChangedOperation operation;
    if (value != null) {
      operation=new MemberAttributeChangedOperation(MapOperationType.PUT,key,value);
    }
 else {
      operation=new MemberAttributeChangedOperation(MapOperationType.REMOVE,key,null);
    }
    String uuid=nodeEngine.getLocalMember().getUuid();
    operation.setCallerUuid(uuid).setNodeEngine(nodeEngine);
    try {
      for (      MemberImpl member : nodeEngine.getClusterService().getMemberList()) {
        os.send(operation,member.getAddress());
      }
    }
 catch (    Throwable t) {
      throw ExceptionUtil.rethrow(t);
    }
  }
}

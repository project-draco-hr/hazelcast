{
  if (!node.joined() || !node.isActive()) {
    return;
  }
  long now=Clock.currentTimeMillis();
  long clockJump=0L;
  if (lastHeartBeat != 0L) {
    clockJump=now - lastHeartBeat - TimeUnit.SECONDS.toMillis(heartbeatInterval);
    if (Math.abs(clockJump) > HEARTBEAT_LOG_THRESHOLD) {
      SimpleDateFormat sdf=new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS");
      logger.info("System clock apparently jumped from " + sdf.format(new Date(lastHeartBeat)) + " to "+ sdf.format(new Date(now))+ " since last heartbeat ("+ String.format("%+d",clockJump)+ "ms).");
    }
    clockJump=Math.max(0L,clockJump);
    if (clockJump >= maxNoMasterConfirmationMillis / 2) {
      logger.warning("Resetting master confirmation timestamps because of huge system clock jump! " + "Clock-Jump: " + clockJump + "ms, Master-Confirmation-Timeout: "+ maxNoMasterConfirmationMillis+ "ms.");
      resetMemberMasterConfirmations();
    }
  }
  lastHeartBeat=now;
  if (node.isMaster()) {
    heartBeaterMaster(now,clockJump);
  }
 else {
    heartBeaterSlave(now,clockJump);
  }
}

{
  Map<Integer,Integer> map=hz.getMap("map");
  int itemCount=10000;
  for (int k=0; k < itemCount; k++) {
    map.put(k,k);
  }
  RestartThread restartThread=new RestartThread();
  restartThread.start();
  Random random=new Random();
  long endTime=System.currentTimeMillis() + TimeUnit.SECONDS.toMillis(DURATION_SECONDS);
  int k=0;
  for (; ; ) {
    int key=random.nextInt(itemCount);
    assertEquals(new Integer(key),map.put(key,key));
    if (k % 10000 == 0) {
      System.out.println("at: " + k);
    }
    k++;
    if (System.currentTimeMillis() > endTime) {
      break;
    }
  }
  restartThread.stop=true;
}

{
  Config config=new Config();
  SocketInterceptorConfig socketInterceptorConfig=new SocketInterceptorConfig();
  MySocketInterceptor mySocketInterceptor=new MySocketInterceptor(true);
  socketInterceptorConfig.setImplementation(mySocketInterceptor).setEnabled(true);
  config.getNetworkConfig().setSocketInterceptorConfig(socketInterceptorConfig);
  HazelcastInstance h1=Hazelcast.newHazelcastInstance(config);
  HazelcastInstance h2=Hazelcast.newHazelcastInstance(config);
  assertEquals(2,h2.getCluster().getMembers().size());
  assertEquals(2,h1.getCluster().getMembers().size());
  ClientConfig clientConfig=new ClientConfig();
  MySocketInterceptor myClientSocketInterceptor=new MySocketInterceptor(true);
  clientConfig.getNetworkConfig().setSocketInterceptorConfig(new SocketInterceptorConfig().setEnabled(true).setImplementation(myClientSocketInterceptor));
  HazelcastInstance client=HazelcastClient.newHazelcastClient(clientConfig);
  assertEquals(2,client.getCluster().getMembers().size());
  assertEquals(3,mySocketInterceptor.getAcceptCallCount());
  assertEquals(1,mySocketInterceptor.getConnectCallCount());
  assertEquals(0,mySocketInterceptor.getAcceptFailureCount());
  assertEquals(0,mySocketInterceptor.getConnectFailureCount());
  assertTrue(myClientSocketInterceptor.getConnectCallCount() >= 2);
  assertEquals(0,myClientSocketInterceptor.getAcceptCallCount());
  assertEquals(0,myClientSocketInterceptor.getAcceptFailureCount());
  assertEquals(0,myClientSocketInterceptor.getConnectFailureCount());
}

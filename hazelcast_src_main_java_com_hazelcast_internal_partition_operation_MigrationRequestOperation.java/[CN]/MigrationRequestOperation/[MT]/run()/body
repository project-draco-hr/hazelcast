{
  NodeEngine nodeEngine=getNodeEngine();
  verifyGoodMaster(nodeEngine);
  Address source=migrationInfo.getSource();
  Address destination=migrationInfo.getDestination();
  verifyExistingTarget(nodeEngine,destination);
  if (destination.equals(source)) {
    getLogger().warning("Source and destination addresses are the same! => " + toString());
    setFailed();
    return;
  }
  verifyNotThisNode(nodeEngine,source);
  InternalPartitionServiceImpl partitionService=getService();
  InternalPartition partition=partitionService.getPartition(migrationInfo.getPartitionId());
  Address owner=partition.getOwnerOrNull();
  verifyOwnerExists(owner);
  if (!migrationInfo.startProcessing()) {
    getLogger().warning("Migration is cancelled -> " + migrationInfo);
    setFailed();
    return;
  }
  if (!source.equals(owner)) {
    getLogger().warning("Cannot migrate! This node is not owner of the partition => " + migrationInfo + " -> partitionId="+ partition.getPartitionId()+ " , "+ partition);
    setFailed();
    return;
  }
  MigrationManager migrationManager=partitionService.getMigrationManager();
  if (!migrationManager.addActiveMigration(migrationInfo)) {
    setFailed();
    return;
  }
  try {
    Collection<Operation> tasks=prepareMigrationTasks();
    long[] replicaVersions=partitionService.getPartitionReplicaVersions(migrationInfo.getPartitionId());
    invokeMigrationOperation(destination,replicaVersions,tasks);
    returnResponse=false;
  }
 catch (  Throwable e) {
    logThrowable(e);
    setFailed();
  }
 finally {
    migrationInfo.doneProcessing();
  }
}

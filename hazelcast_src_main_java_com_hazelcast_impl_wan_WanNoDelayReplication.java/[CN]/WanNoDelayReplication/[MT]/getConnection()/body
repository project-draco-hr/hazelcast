{
  final int defaultPort=node.getConfig().getNetworkConfig().getPort();
  while (running) {
    String targetStr=addressQueue.take();
    try {
      final AddressHolder addressHolder=AddressUtil.getAddressHolder(targetStr,defaultPort);
      final Address target=new Address(addressHolder.address,addressHolder.port);
      final ConnectionManager connectionManager=node.getConnectionManager();
      Connection conn=connectionManager.getOrConnect(target);
      for (int i=0; i < 10; i++) {
        if (conn == null) {
          Thread.sleep(1000);
        }
 else {
          return conn;
        }
        conn=connectionManager.getConnection(target);
      }
    }
 catch (    Throwable e) {
      Thread.sleep(1000);
    }
 finally {
      addressQueue.offer(targetStr);
    }
  }
  return null;
}

{
  operationData=new Data[responses.length];
  for (int i=0; i < responses.length; i++) {
    if (responses[i] instanceof MultiResponse) {
      MultiResponse mr=(MultiResponse)responses[i];
      if (mr.hasResponse) {
        markHasResponse();
      }
      Data[] newOperationData=new Data[operationData.length + mr.operationData.length - 1];
      System.arraycopy(operationData,0,newOperationData,0,i);
      System.arraycopy(mr.operationData,0,newOperationData,i,mr.operationData.length);
      operationData=newOperationData;
    }
 else     if (responses[i] instanceof Operation) {
      if (responses[i] instanceof Response) {
        markHasResponse();
      }
      operationData[i]=IOUtil.toData(responses[i]);
    }
 else {
      markHasResponse();
      operationData[i]=IOUtil.toData(new Response(responses[i]));
    }
  }
}

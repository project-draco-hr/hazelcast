{
  LockInfo lock=locks.get(dataKey);
  boolean result=false;
  if (lock == null)   return result;
  if (lock.testLock(threadId,caller)) {
    if (lock.unlock(caller,threadId)) {
      result=true;
    }
  }
  if (!lock.isLocked()) {
    locks.remove(dataKey);
  }
  return result;
}

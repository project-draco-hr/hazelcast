{
  LockInfo lock=locks.get(dataKey);
  if (lock == null)   return false;
  if (lock.testLock(threadId,caller)) {
    if (lock.unlock(caller,threadId)) {
      return true;
    }
  }
  return false;
}

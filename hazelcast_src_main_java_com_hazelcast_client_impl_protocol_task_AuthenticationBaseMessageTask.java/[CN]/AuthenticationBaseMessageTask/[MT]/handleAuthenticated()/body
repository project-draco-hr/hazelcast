{
  if (isOwnerConnection()) {
    final String uuid=getUuid();
    final String localMemberUUID=clientEngine.getLocalMember().getUuid();
    principal=new ClientPrincipal(uuid,localMemberUUID);
    reAuthLocal();
    Collection<MemberImpl> members=nodeEngine.getClusterService().getMemberList();
    for (    MemberImpl member : members) {
      if (!member.localMember()) {
        ClientReAuthOperation op=new ClientReAuthOperation(uuid);
        op.setCallerUuid(localMemberUUID);
        nodeEngine.getOperationService().send(op,member.getAddress());
      }
    }
  }
  boolean isNotMember=clientEngine.getClusterService().getMember(principal.getOwnerUuid()) == null;
  if (isNotMember) {
    throw new AuthenticationException("Invalid owner-uuid: " + principal.getOwnerUuid() + ", it's not member of this cluster!");
  }
  Connection connection=endpoint.getConnection();
  ILogger logger=clientEngine.getLogger(getClass());
  logger.log(Level.INFO,"Received auth from " + connection + ", successfully authenticated"+ ", principal : "+ principal+ ", owner connection : "+ isOwnerConnection());
  endpoint.authenticated(principal,credentials,isOwnerConnection());
  endpointManager.registerEndpoint(endpoint);
  clientEngine.bind(endpoint);
  final Address thisAddress=clientEngine.getThisAddress();
  return encodeAuth(thisAddress,principal.getUuid(),principal.getOwnerUuid());
}

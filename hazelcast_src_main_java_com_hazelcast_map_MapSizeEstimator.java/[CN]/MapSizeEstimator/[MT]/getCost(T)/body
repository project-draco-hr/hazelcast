{
  if (record == null) {
    return 0;
  }
  if (record instanceof NearCache.CacheRecord) {
    final NearCache.CacheRecord rec=(NearCache.CacheRecord)record;
    final long cost=rec.getCost();
    if (cost == 0)     return 0;
    long size=0;
    size+=((Integer.SIZE / Byte.SIZE));
    size+=rec.getCost();
    return size;
  }
 else   if (record instanceof DataRecord) {
    final Record rec=(Record)record;
    long size=0;
    size+=((Integer.SIZE / Byte.SIZE));
    size+=rec.getCost();
    return size;
  }
 else   if (record instanceof ObjectRecord) {
    return 0;
  }
  final String msg="MapSizeEstimator::not known object for map heap cost" + " calculation [" + record.getClass().getCanonicalName() + "]";
  throw new RuntimeException(msg);
}

{
  if (record instanceof NearCache.CacheRecord) {
    final NearCache.CacheRecord rec=(NearCache.CacheRecord)record;
    final long keySize=rec.getKey().totalSize();
    final long valueSize=rec.getCost();
    return keySize + valueSize;
  }
 else   if (record instanceof Record) {
    final Record rec=(Record)record;
    final long keySize=rec.getKey().totalSize();
    final long valueSize=rec.getCost();
    return keySize + valueSize;
  }
  final String msg="MapSizeEstimator::not known object for cost" + " calculation of a map [" + record.getClass().getCanonicalName() + "]";
  throw new RuntimeException(msg);
}

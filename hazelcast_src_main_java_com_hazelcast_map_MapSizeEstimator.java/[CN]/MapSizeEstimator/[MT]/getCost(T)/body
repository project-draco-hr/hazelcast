{
  if (record instanceof NearCache.CacheRecord) {
    final NearCache.CacheRecord rec=(NearCache.CacheRecord)record;
    final long keySize=rec.getKey().totalSize();
    final long valueSize=rec.getCost();
    return keySize + valueSize;
  }
 else   if (record instanceof DataRecord) {
    final Record rec=(Record)record;
    final long keySize=rec.getKey().totalSize();
    final long valueSize=rec.getCost();
    return keySize + valueSize;
  }
 else   if (record instanceof ObjectRecord) {
    return 0;
  }
  final String msg="MapSizeEstimator::not known object for map heap cost" + " calculation [" + record.getClass().getCanonicalName() + "]";
  throw new RuntimeException(msg);
}

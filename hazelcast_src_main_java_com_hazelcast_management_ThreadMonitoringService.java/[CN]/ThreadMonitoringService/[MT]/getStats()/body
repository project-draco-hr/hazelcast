{
  try {
    Set<MonitoredThread> monitoredThreads=new TreeSet<MonitoredThread>();
    int count=threadGroup.activeCount();
    Thread[] threads=new Thread[count];
    threadGroup.enumerate(threads);
    long now=System.nanoTime();
    for (    Thread thread : threads) {
      ThreadCpuInfoConstructor constructor=new ThreadCpuInfoConstructor(thread);
      final ThreadCpuInfo t=ConcurrencyUtil.getOrPutIfAbsent(knownThreads,thread.getId(),constructor);
      int percentage=(int)((t.setNewValue(threadMXBean.getThreadCpuTime(thread.getId()),now)) * PERCENT_MULTIPLIER);
      monitoredThreads.add(new MonitoredThread(thread.getName(),thread.getId(),percentage));
    }
    return monitoredThreads;
  }
 catch (  Exception e) {
    return null;
  }
}

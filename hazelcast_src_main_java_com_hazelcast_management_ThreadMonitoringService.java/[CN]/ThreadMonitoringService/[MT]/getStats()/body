{
  try {
    Set<MonitoredThread> monitoredThreads=new TreeSet<MonitoredThread>();
    int count=threadGroup.activeCount();
    Thread[] threads=new Thread[count];
    threadGroup.enumerate(threads);
    long now=System.nanoTime();
    for (    Thread thread : threads) {
      ThreadCpuInfo t=knownThreads.get(thread.getId());
      if (t == null) {
        knownThreads.putIfAbsent(thread.getId(),new ThreadCpuInfo(thread));
      }
 else {
        int percentage=(int)((t.setNewValue(threadMXBean.getThreadCpuTime(thread.getId()),now)) * 100);
        monitoredThreads.add(new MonitoredThread(thread.getName(),thread.getId(),percentage));
      }
    }
    return monitoredThreads;
  }
 catch (  Exception e) {
    return null;
  }
}

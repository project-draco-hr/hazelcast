{
  final Collection<Data> locks=lockStore != null ? lockStore.getLockedKeys() : Collections.<Data>emptySet();
  Map<Data,MultiMapWrapper> lockedKeys=new HashMap<Data,MultiMapWrapper>(locks.size());
  for (  Data key : locks) {
    MultiMapWrapper wrapper=multiMapWrappers.get(key);
    if (wrapper != null) {
      lockedKeys.put(key,wrapper);
    }
  }
  int numberOfAffectedEntries=multiMapWrappers.size() - lockedKeys.size();
  multiMapWrappers.clear();
  multiMapWrappers.putAll(lockedKeys);
  return numberOfAffectedEntries;
}

{
  V old;
  Object marshalledKey=marshallKey(key);
synchronized (getMutex(marshalledKey)) {
    final ReplicatedRecord current=storage.get(marshalledKey);
    final Vector vector;
    if (current == null) {
      old=null;
    }
 else {
      vector=current.getVector();
      old=(V)current.getValue();
      current.setValue(null,0);
      incrementClock(vector);
      publishReplicatedMessage(new ReplicationMessage(name,key,null,vector,localMember,localMemberHash));
    }
  }
  return unmarshallValue(old);
}

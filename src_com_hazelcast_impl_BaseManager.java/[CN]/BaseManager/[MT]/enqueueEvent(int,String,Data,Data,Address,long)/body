{
  EventTask eventTask=new EventTask(eventType,name,eventKey,eventValue,recordId);
  System.out.println(name + "  " + recordId);
  if (name.startsWith("q:t:")) {
    OrderedEventQueue orderedEventQueue=orderedEventQueues.get(name);
    if (orderedEventQueue == null) {
      orderedEventQueue=new OrderedEventQueue();
      orderedEventQueues.put(name,orderedEventQueue);
    }
    orderedEventQueue.offer(eventTask);
    executeLocally(orderedEventQueue);
  }
 else {
    int eventQueueIndex=-1;
    if (eventKey != null) {
      eventQueueIndex=Math.abs(eventKey.hashCode()) % 100;
    }
 else {
      eventQueueIndex=Math.abs(from.hashCode()) % 100;
    }
    EventQueue eventQueue=eventQueues[eventQueueIndex];
    boolean offered=eventQueue.offer(eventTask);
    if (!offered)     throw new RuntimeException("event cannot be offered!");
    executeLocally(eventQueue);
  }
}

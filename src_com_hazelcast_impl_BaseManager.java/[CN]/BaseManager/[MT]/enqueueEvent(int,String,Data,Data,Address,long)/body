{
  final EventTask eventTask=new EventTask(eventType,name,eventKey,eventValue,recordId);
  if (name.startsWith("q:t:")) {
    OrderedEventQueue orderedEventQueue=mapOrderedEventQueues.get(name);
    if (orderedEventQueue == null) {
      orderedEventQueue=new OrderedEventQueue(recordId);
      mapOrderedEventQueues.put(name,orderedEventQueue);
    }
    logger.log(Level.FINE,eventTask.recordId + "offering eventTask " + recordId);
    orderedEventQueue.offer(eventTask);
    executeLocally(orderedEventQueue);
  }
 else {
    int eventQueueIndex=-1;
    if (eventKey != null) {
      eventQueueIndex=Math.abs(eventKey.hashCode()) % EVENT_QUEUE_COUNT;
    }
 else {
      eventQueueIndex=Math.abs(from.hashCode()) % EVENT_QUEUE_COUNT;
    }
    final EventQueue eventQueue=eventQueues[eventQueueIndex];
    final int size=eventQueue.offerRunnable(eventTask);
    if (size == 1)     executeLocally(eventQueue);
  }
}

{
  int size=100000;
  StaticNodeFactory nodeFactory=new StaticNodeFactory(5);
  HazelcastInstance h1=nodeFactory.newHazelcastInstance(new Config());
  IMap m1=h1.getMap("default");
  for (int i=0; i < size; i++) {
    m1.put(i,i);
  }
  HazelcastInstance h2=Hazelcast.newHazelcastInstance(new Config());
  IMap m2=h2.getMap("default");
  h1.getLifecycleService().shutdown();
  Thread.sleep(1000);
  assertEquals(size,m2.size());
  HazelcastInstance h3=Hazelcast.newHazelcastInstance(new Config());
  IMap m3=h3.getMap("default");
  h2.getLifecycleService().shutdown();
  assertEquals(size,m3.size());
  HazelcastInstance h4=Hazelcast.newHazelcastInstance(new Config());
  h4.getLifecycleService().shutdown();
  assertEquals(size,m3.size());
}

{
  int size=50000;
  TestHazelcastInstanceFactory nodeFactory=createHazelcastInstanceFactory(4);
  Config config=getConfig();
  HazelcastInstance h1=nodeFactory.newHazelcastInstance(config);
  IMap<Integer,Integer> m1=h1.getMap(MAP_NAME);
  for (int i=0; i < size; i++) {
    m1.put(i,i);
  }
  HazelcastInstance h2=nodeFactory.newHazelcastInstance(config);
  IMap<Integer,Integer> m2=h2.getMap(MAP_NAME);
  h1.shutdown();
  checkSizeEventually(size,m2);
  HazelcastInstance h3=nodeFactory.newHazelcastInstance(config);
  IMap<Integer,Integer> m3=h3.getMap(MAP_NAME);
  h2.shutdown();
  checkSizeEventually(size,m3);
  HazelcastInstance h4=nodeFactory.newHazelcastInstance(config);
  IMap<Integer,Integer> m4=h4.getMap(MAP_NAME);
  h3.shutdown();
  checkSizeEventually(size,m4);
}

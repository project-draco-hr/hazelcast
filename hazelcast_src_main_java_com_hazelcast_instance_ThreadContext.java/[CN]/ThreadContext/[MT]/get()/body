{
  Thread currentThread=Thread.currentThread();
  ThreadContext context=lastThreadContext;
  return (context != null && context.thread == currentThread) ? context : contexts.get(currentThread);
}

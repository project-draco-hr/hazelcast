{
  for (  Map.Entry<String,AtomicInteger> entry : attachedSemaphorePermits.entrySet()) {
    final ISemaphore semaphore=node.factory.getSemaphore(entry.getKey());
    final int permits=entry.getValue().get();
    if (permits > 0) {
      semaphore.releaseDetach(permits);
    }
 else {
      semaphore.reducePermits(permits);
      semaphore.attach(permits);
    }
  }
}

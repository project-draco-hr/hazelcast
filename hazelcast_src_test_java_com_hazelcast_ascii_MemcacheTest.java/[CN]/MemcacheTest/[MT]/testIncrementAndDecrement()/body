{
  final HazelcastInstance instance=Hazelcast.newHazelcastInstance(config);
  MemcachedClient client=getMemcacheClient(instance);
  try {
    for (int i=0; i < 100; i++) {
      final OperationFuture<Boolean> future=client.set(String.valueOf(i),0,i);
      future.get();
    }
    for (int i=0; i < 100; i++) {
      assertEquals(i * 2,client.incr(String.valueOf(i),i));
    }
    for (int i=100; i < 120; i++) {
      assertEquals(-1,client.incr(String.valueOf(i),i));
    }
    for (int i=0; i < 100; i++) {
      assertEquals(i,client.decr(String.valueOf(i),i));
    }
    for (int i=100; i < 130; i++) {
      assertEquals(-1,client.decr(String.valueOf(i),i));
    }
    for (int i=0; i < 100; i++) {
      assertEquals(i,client.get(String.valueOf(i)));
    }
    final Map<String,String> stats=client.getStats().get(instance.getCluster().getLocalMember().getInetSocketAddress());
    assertEquals("100",stats.get("cmdSet"));
    assertEquals("100",stats.get("cmdGet"));
    assertEquals("100",stats.get("incrHits"));
    assertEquals("20",stats.get("incrMisses"));
    assertEquals("100",stats.get("decrHits"));
    assertEquals("30",stats.get("decrMisses"));
  }
  finally {
    client.shutdown();
  }
}

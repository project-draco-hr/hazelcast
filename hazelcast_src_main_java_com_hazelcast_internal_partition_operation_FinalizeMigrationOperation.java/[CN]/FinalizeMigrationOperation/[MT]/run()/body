{
  InternalPartitionServiceImpl partitionService=getService();
  int partitionId=getPartitionId();
  MigrationManager migrationManager=partitionService.getMigrationManager();
  NodeEngineImpl nodeEngine=(NodeEngineImpl)getNodeEngine();
  PartitionMigrationEvent event=new PartitionMigrationEvent(endpoint,migrationInfo.getType(),partitionId,migrationInfo.getReplicaIndex(),migrationInfo.getKeepReplicaIndex());
  for (  MigrationAwareService service : nodeEngine.getServices(MigrationAwareService.class)) {
    finishMigration(event,service);
  }
  if (endpoint == MigrationEndpoint.SOURCE && success) {
    partitionService.clearPartitionReplicaVersions(partitionId);
  }
 else   if (endpoint == MigrationEndpoint.DESTINATION && !success) {
    partitionService.clearPartitionReplicaVersions(partitionId);
  }
  if (success) {
    nodeEngine.onPartitionMigrate(migrationInfo);
  }
}

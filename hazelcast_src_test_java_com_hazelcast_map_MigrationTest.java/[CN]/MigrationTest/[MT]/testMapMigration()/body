{
  TestHazelcastInstanceFactory nodeFactory=createHazelcastInstanceFactory(3);
  Config cfg=new Config();
  HazelcastInstance instance1=nodeFactory.newHazelcastInstance(cfg);
  int size=1000;
  Map map=instance1.getMap("testMapMigration");
  for (int i=0; i < size; i++) {
    map.put(i,i);
  }
  HazelcastInstance instance2=nodeFactory.newHazelcastInstance(cfg);
  Thread.sleep(1000);
  for (int i=0; i < size; i++) {
    assertEquals(map.get(i),i);
  }
  HazelcastInstance instance3=nodeFactory.newHazelcastInstance(cfg);
  Thread.sleep(1000);
  for (int i=0; i < size; i++) {
    assertEquals(map.get(i),i);
  }
}

{
  int ownedCount=0;
  ILogger responseLogger=node.getLogger(SyncReplicaVersion.class);
  ResponseHandler responseHandler=ResponseHandlerFactory.createErrorLoggingResponseHandler(responseLogger);
  for (  InternalPartitionImpl partition : partitions) {
    Address owner=partition.getOwnerOrNull();
    if (thisAddress.equals(owner)) {
      for (int i=1; i <= getMaxBackupCount(); i++) {
        if (partition.getReplicaAddress(i) != null) {
          SyncReplicaVersion op=new SyncReplicaVersion(i,callback);
          op.setService(this);
          op.setNodeEngine(nodeEngine);
          op.setResponseHandler(responseHandler);
          op.setPartitionId(partition.getPartitionId());
          nodeEngine.getOperationService().executeOperation(op);
        }
 else {
          ok.set(false);
          s.release();
        }
      }
      ownedCount++;
    }
 else     if (owner == null) {
      ok.set(false);
    }
  }
  return ownedCount;
}

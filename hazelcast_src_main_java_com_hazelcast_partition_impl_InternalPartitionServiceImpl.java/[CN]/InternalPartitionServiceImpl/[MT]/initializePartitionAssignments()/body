{
  PartitionStateGenerator psg=partitionStateGenerator;
  Collection<MemberGroup> memberGroups=createMemberGroups();
  if (memberGroups.isEmpty()) {
    logger.warning("No member group is available to assign partition ownership...");
    return true;
  }
  logger.info("Initializing cluster partition table first arrangement...");
  Address[][] newState=psg.initialize(memberGroups,partitionCount);
  if (newState.length != partitionCount) {
    throw new HazelcastException("Invalid partition count! " + "Expected: " + partitionCount + ", Actual: "+ newState.length);
  }
  for (int partitionId=0; partitionId < partitionCount; partitionId++) {
    InternalPartitionImpl partition=partitions[partitionId];
    Address[] replicas=newState[partitionId];
    partition.setReplicaAddresses(replicas);
  }
  initialized=true;
  return false;
}

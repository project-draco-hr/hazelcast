{
  if (!member.localMember()) {
    updateMemberGroupsSize();
  }
  stateVersion.incrementAndGet();
  if (node.isMaster()) {
    lock.lock();
    try {
      migrationQueue.clear();
      if (initialized) {
        final ClusterState clusterState=nodeEngine.getClusterService().getClusterState();
        if (clusterState == ClusterState.ACTIVE) {
          migrationQueue.add(new RepartitioningTask());
        }
        Collection<MemberImpl> members=getCurrentMembersAndMembersRemovedWhileNotClusterNotActive();
        PartitionStateOperation op=new PartitionStateOperation(createPartitionState(members));
        nodeEngine.getOperationService().send(op,member.getAddress());
      }
    }
  finally {
      lock.unlock();
    }
  }
}

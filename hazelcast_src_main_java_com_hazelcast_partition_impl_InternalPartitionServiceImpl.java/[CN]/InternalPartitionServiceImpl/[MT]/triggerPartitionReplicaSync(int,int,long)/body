{
  if (replicaIndex < 0 || replicaIndex > InternalPartition.MAX_REPLICA_COUNT) {
    throw new IllegalArgumentException("Invalid replica index: " + replicaIndex);
  }
  final InternalPartitionImpl partitionImpl=getPartitionImpl(partitionId);
  final Address target=partitionImpl.getOwnerOrNull();
  if (target == null) {
    logger.info("Sync replica target is null, no need to sync -> partition: " + partitionId + ", replica: "+ replicaIndex);
    return;
  }
  if (!checkSyncPartitionTarget(partitionId,replicaIndex,target)) {
    return;
  }
  ReplicaSyncInfo syncInfo=new ReplicaSyncInfo(partitionId,replicaIndex,target);
  if (delayMillis <= 0) {
    if (replicaSyncRequests.compareAndSet(partitionId,null,syncInfo)) {
      if (startReplicaSyncProcess()) {
        fireSyncReplicaRequest(syncInfo,target);
      }
 else {
        schedulePartitionReplicaSync(syncInfo,target,REPLICA_SYNC_RETRY_DELAY);
      }
    }
 else {
      schedulePartitionReplicaSync(syncInfo,target,DEFAULT_REPLICA_SYNC_DELAY);
    }
  }
 else {
    schedulePartitionReplicaSync(syncInfo,target,delayMillis);
  }
}

{
  migrationQueue.clear();
  for (int k=0; k < replicaSyncRequests.length(); k++) {
    replicaSyncRequests.set(k,null);
  }
  replicaSyncScheduler.cancelAll();
  replicaSyncProcessLock.drainPermits();
  replicaSyncProcessLock.release(maxParallelReplications);
  lock.lock();
  try {
    initialized=false;
    for (    InternalPartitionImpl partition : partitions) {
      for (int i=0; i < InternalPartition.MAX_REPLICA_COUNT; i++) {
        partition.setReplicaAddress(i,null);
        partition.setMigrating(false);
      }
    }
    activeMigrations.clear();
    completedMigrations.clear();
    stateVersion.set(0);
  }
  finally {
    lock.unlock();
  }
}

{
  if (!node.isMaster()) {
    return;
  }
  lock.lock();
  try {
    if (!initialized) {
      return;
    }
    if (!isMigrationAllowed()) {
      return;
    }
    migrationQueue.clear();
    PartitionStateGenerator psg=partitionStateGenerator;
    Collection<MemberGroup> memberGroups=createMemberGroups();
    Address[][] newState=psg.reArrange(memberGroups,partitions);
    if (!isMigrationAllowed()) {
      return;
    }
    processNewPartitionState(newState);
    syncPartitionRuntimeState();
  }
  finally {
    lock.unlock();
  }
}

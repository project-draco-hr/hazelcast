{
  if (!sent.compareAndSet(false,true)) {
    throw new IllegalStateException("Response already sent for call: " + callId + " to "+ conn.getEndPoint());
  }
  final Operation response;
  if (obj instanceof Operation) {
    response=(Operation)obj;
  }
 else {
    response=new Response(obj);
  }
  OperationAccessor.setCallId(response,callId);
  response.setPartitionId(partitionId);
  nodeEngine.getOperationService().send(response,conn);
}

{
  final HazelcastInstance h1=Hazelcast.newHazelcastInstance(new Config());
  final HazelcastInstance h2=Hazelcast.newHazelcastInstance(new Config());
  final HazelcastInstance h3=Hazelcast.newHazelcastInstance(new Config());
  final HazelcastInstance h4=Hazelcast.newHazelcastInstance(new Config());
  HazelcastClient client=newHazelcastClient(h2);
  final IMap c1=client.getMap("default");
  final IMap m1=h4.getMap("default");
  int count=1000;
  OrderKey[] keys=new OrderKey[count];
  for (int i=0; i < count; i++) {
    OrderKey key=new OrderKey(i,i % 119);
    keys[i]=key;
    m1.put(key,i);
  }
  for (  OrderKey key : keys) {
    Member member1=h1.getPartitionService().getPartition(key).getOwner();
    Member member2=h1.getPartitionService().getPartition(key.getPartitionKey()).getOwner();
    assertEquals(member1,member2);
    assertEquals(key.getOrderId(),c1.get(key));
    assertEquals(key.getOrderId(),m1.get(key));
  }
}

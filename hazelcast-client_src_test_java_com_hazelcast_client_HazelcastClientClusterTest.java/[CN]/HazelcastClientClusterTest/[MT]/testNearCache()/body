{
  final Config config=new Config();
  NearCacheConfig nearCacheConfig=new NearCacheConfig();
  nearCacheConfig.setMaxSize(1000);
  config.getMapConfig("default").setNearCacheConfig(nearCacheConfig);
  HazelcastInstance h1=Hazelcast.newHazelcastInstance(config);
  IMap m1=h1.getMap("default");
  m1.put("1","value");
  HazelcastInstance h2=Hazelcast.newHazelcastInstance(config);
  IMap m2=h2.getMap("default");
  assertEquals("value",m2.get("1"));
  assertEquals("value",m1.get("1"));
  HazelcastClient client1=newHazelcastClient(h1);
  HazelcastClient client2=newHazelcastClient(h2);
  for (int i=0; i < 10; i++) {
    assertEquals("value",client1.getMap("default").get("1"));
    assertEquals("value",client2.getMap("default").get("1"));
  }
}

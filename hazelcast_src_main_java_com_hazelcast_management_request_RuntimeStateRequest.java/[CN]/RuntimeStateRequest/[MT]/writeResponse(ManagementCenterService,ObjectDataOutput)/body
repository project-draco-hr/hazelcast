{
  final HazelcastInstanceImpl instance=mcs.getHazelcastInstance();
  final ClusterServiceImpl cluster=instance.node.getClusterService();
  final PartitionServiceImpl partitionService=instance.node.partitionService;
  final Collection<LockResource> lockedRecords=collectLockState(instance);
  final Map<Address,Connection> connectionMap=instance.node.connectionManager.getReadonlyConnectionMap();
  final ClusterRuntimeState clusterRuntimeState=new ClusterRuntimeState(cluster.getMembers(),partitionService.getPartitions(),partitionService.getActiveMigrations(),connectionMap,lockedRecords);
  clusterRuntimeState.writeData(dos);
}

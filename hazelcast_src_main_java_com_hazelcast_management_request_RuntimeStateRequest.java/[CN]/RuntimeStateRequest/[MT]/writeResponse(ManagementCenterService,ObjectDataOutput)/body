{
  HazelcastInstanceImpl instance=mcs.getHazelcastInstance();
  Node node=instance.node;
  ClusterServiceImpl cluster=node.getClusterService();
  InternalPartitionService partitionService=node.partitionService;
  Collection<LockResource> lockedRecords=collectLockState(instance);
  Map<Address,Connection> connectionMap=node.connectionManager.getReadonlyConnectionMap();
  ClusterRuntimeState clusterRuntimeState=new ClusterRuntimeState(cluster.getMembers(),partitionService.getPartitions(),partitionService.getActiveMigrations(),connectionMap,lockedRecords);
  clusterRuntimeState.writeData(dos);
}

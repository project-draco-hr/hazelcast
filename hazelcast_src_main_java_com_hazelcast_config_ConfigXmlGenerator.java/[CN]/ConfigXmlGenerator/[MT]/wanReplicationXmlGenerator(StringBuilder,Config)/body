{
  final Collection<WanReplicationConfig> wanRepConfigs=config.getWanReplicationConfigs().values();
  for (  WanReplicationConfig wan : wanRepConfigs) {
    xml.append("<wan-replication name=\"").append(wan.getName()).append("\" ").append("snapshot-enabled=\"").append(wan.isSnapshotEnabled()).append("\">");
    final List<WanTargetClusterConfig> targets=wan.getTargetClusterConfigs();
    for (    WanTargetClusterConfig t : targets) {
      xml.append("<target-cluster group-name=\"").append(t.getGroupName()).append("\" group-password=\"").append(t.getGroupPassword()).append("\">");
      xml.append("<replication-impl>").append(t.getReplicationImpl()).append("</replication-impl>");
      xml.append("<end-points>");
      final List<String> eps=t.getEndpoints();
      for (      String ep : eps) {
        xml.append("<address>").append(ep).append("</address>");
      }
      xml.append("</end-points>").append("</target-cluster>");
    }
    xml.append("</wan-replication>");
  }
}

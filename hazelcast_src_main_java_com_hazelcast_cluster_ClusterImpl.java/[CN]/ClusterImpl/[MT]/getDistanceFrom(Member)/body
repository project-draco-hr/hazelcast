{
  if (member.localMember()) {
    return 0;
  }
  Integer distance=distances.get(member);
  if (distance != null) {
    return distance;
  }
  Set<Member> currentMembers=members.get();
  int size=currentMembers.size();
  Member localMember=getLocalMember();
  int index=0;
  int toIndex=getIndexOf(localMember,currentMembers);
  for (  Member m : currentMembers) {
    if (!m.equals(localMember)) {
      distance=((toIndex - index) + size) % size;
      distances.put(m,distance);
    }
    index++;
  }
  Integer d=distances.get(member);
  return (d == null) ? -1 : d;
}

{
  try {
    final ClientEndpoint endpoint=getEndpoint();
    final ClientEngine engine=getClientEngine();
    MapReduceService mapReduceService=getService();
    NodeEngine nodeEngine=mapReduceService.getNodeEngine();
    AbstractJobTracker jobTracker=(AbstractJobTracker)mapReduceService.createDistributedObject(name);
    TrackableJobFuture jobFuture=new TrackableJobFuture(name,jobId,jobTracker,nodeEngine,null);
    if (jobTracker.registerTrackableJob(jobFuture)) {
      CompletableFuture future=startSupervisionTask(jobFuture,mapReduceService,nodeEngine,jobTracker);
      future.andThen(new ExecutionCallback(){
        @Override public void onResponse(        Object response){
          engine.sendResponse(endpoint,response);
        }
        @Override public void onFailure(        Throwable t){
          engine.sendResponse(endpoint,t);
        }
      }
);
    }
  }
 catch (  Exception e) {
    throw new IllegalStateException("Could not register map reduce job",e);
  }
}

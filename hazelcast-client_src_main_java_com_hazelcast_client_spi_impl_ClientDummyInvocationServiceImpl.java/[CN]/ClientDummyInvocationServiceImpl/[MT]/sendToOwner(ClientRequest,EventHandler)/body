{
  int count=0;
  Exception lastError=null;
  long retryCount=retryTimeoutInSeconds / RETRY_WAIT_TIME_IN_SECONDS;
  while (count++ < retryCount) {
    try {
      final Address ownerConnectionAddress=clusterListenerSupport.getOwnerConnectionAddress();
      if (ownerConnectionAddress != null) {
        final Connection conn=connectionManager.getConnection(ownerConnectionAddress);
        if (conn != null) {
          return send(request,(ClientConnection)conn,handler);
        }
      }
    }
 catch (    HazelcastInstanceNotActiveException e) {
      lastError=e;
    }
    if (!client.getLifecycleService().isRunning()) {
      throw new HazelcastInstanceNotActiveException();
    }
    Thread.sleep(TimeUnit.SECONDS.toMillis(RETRY_WAIT_TIME_IN_SECONDS));
  }
  if (lastError == null) {
    throw new OperationTimeoutException("Could not invoke request on cluster in " + retryTimeoutInSeconds + " seconds");
  }
  throw lastError;
}

{
  HazelcastInstance[] cluster=createHazelcastInstanceFactory(2).newInstances();
  HazelcastInstance local=cluster[0];
  HazelcastInstance remote=cluster[1];
  String response="someresponse";
  int remotePartitionId=getPartitionId(remote);
  int badPartitionId=(remotePartitionId + 1) % getNode(local).partitionService.getPartitionCount();
  DummyOperation nestedOperation=new DummyOperation(response);
  nestedOperation.setPartitionId(badPartitionId);
  NestedOperation operation=new NestedOperation(nestedOperation);
  OperationService operationService=getOperationService(local);
  InternalCompletableFuture f=operationService.invokeOnPartition(null,operation,remotePartitionId);
  try {
    f.getSafely();
    fail();
  }
 catch (  IllegalThreadStateException e) {
  }
}

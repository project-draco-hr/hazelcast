{
  this.nodeService=nodeService;
  int partitionCount=nodeService.getPartitionCount();
  partitionContainers=new PartitionContainer[partitionCount];
  for (int i=0; i < partitionCount; i++) {
    partitionContainers[i]=new PartitionContainer(nodeService.getNode(),partitions[i]);
  }
  new Thread(){
    public void run(){
      while (true) {
        int k=0;
        for (        PartitionContainer partitionContainer : partitionContainers) {
          if (!partitionContainer.partitionInfo.isOwnerOrBackup(MapService.this.nodeService.getThisAddress(),1)) {
            partitionContainer.maps.clear();
            continue;
          }
          for (          Entry<String,MapPartition> entry : partitionContainer.maps.entrySet()) {
            k+=entry.getValue().records.size();
          }
        }
        System.err.println(nodeService.getThisAddress() + " Total: " + k);
        try {
          sleep(5000);
        }
 catch (        InterruptedException e) {
        }
      }
    }
  }
.start();
}

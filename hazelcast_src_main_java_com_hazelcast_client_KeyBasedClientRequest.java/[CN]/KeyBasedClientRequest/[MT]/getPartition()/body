{
  final Object key=getKey();
  if (key instanceof String) {
    return clientEngine.getPartitionService().getPartitionId(StringPartitioningStrategy.getPartitionKey((String)key));
  }
  return clientEngine.getPartitionService().getPartitionId(key);
}

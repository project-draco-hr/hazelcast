{
  URI managerURI=uri == null ? getDefaultURI() : uri;
  ClassLoader managerClassLoader=classLoader == null ? getDefaultClassLoader() : classLoader;
  Properties managerProperties=properties == null ? new Properties() : properties;
  ConcurrentMap<URI,CacheManager> cacheManagersByURI=cacheManagers.get(managerClassLoader);
  if (cacheManagersByURI == null) {
    cacheManagersByURI=new ConcurrentHashMap<URI,CacheManager>();
    cacheManagers.putIfAbsent(managerClassLoader,cacheManagersByURI);
  }
  CacheManager cacheManager=cacheManagersByURI.get(managerURI);
  if (cacheManager == null) {
    try {
      cacheManager=createHazelcastCacheManager(uri,classLoader,managerProperties);
      cacheManagersByURI.put(managerURI,cacheManager);
    }
 catch (    Exception e) {
      throw new CacheException("Error opening URI" + managerURI.toString(),e);
    }
  }
  return cacheManager;
}

{
  for (  Map.Entry<String,Map> entry : map.entrySet()) {
    String name=entry.getKey();
    MultiMapContainer container=getOrCreateCollectionContainer(partitionId,name);
    Map<Data,MultiMapWrapper> collections=entry.getValue();
    for (    Map.Entry<Data,MultiMapWrapper> wrapperEntry : collections.entrySet()) {
      final Data key=wrapperEntry.getKey();
      final MultiMapWrapper wrapper=wrapperEntry.getValue();
      Collection<MultiMapRecord> coll=wrapper.getCollection(false);
      if (container.config.getValueCollectionType().equals(MultiMapConfig.ValueCollectionType.SET)) {
        coll=new HashSet<MultiMapRecord>(coll);
      }
      container.multiMapWrappers.put(key,new MultiMapWrapper(coll));
    }
  }
}

{
  if (isStatusSet(ST_HEADER)) {
    return true;
  }
  if (source.remaining() < CLASS_DEF_HEADER_SIZE) {
    return false;
  }
  int factoryId=source.getInt();
  int classId=source.getInt();
  int version=source.getInt();
  classDefSize=source.getInt();
  boolean bigEndian=context.getByteOrder() == ByteOrder.BIG_ENDIAN;
  Bits.writeInt(metadata,classDefIndex * HEADER_ENTRY_LENGTH + HEADER_FACTORY_OFFSET,factoryId,bigEndian);
  Bits.writeInt(metadata,classDefIndex * HEADER_ENTRY_LENGTH + HEADER_CLASS_OFFSET,classId,bigEndian);
  Bits.writeInt(metadata,classDefIndex * HEADER_ENTRY_LENGTH + HEADER_VERSION_OFFSET,version,bigEndian);
  ClassDefinition cd=context.lookupClassDefinition(factoryId,classId,version);
  if (cd == null) {
    classDefProxy=new BinaryClassDefinitionProxy(factoryId,classId,version);
    clearStatus(ST_SKIP_DATA);
  }
 else {
    setStatus(ST_SKIP_DATA);
  }
  setStatus(ST_HEADER);
  return true;
}

{
  final Set<Data> keysData;
  if (keys != null) {
    keysData=new HashSet<Data>();
    for (    K key : keys) {
      keysData.add(toData(key));
    }
  }
 else {
    keysData=null;
  }
  final int partitionCount=clientContext.getPartitionService().getPartitionCount();
  final int completionId=nextCompletionId();
  registerCompletionLatch(completionId,partitionCount);
  ClientMessage request=CacheRemoveAllKeysCodec.encodeRequest(nameWithPrefix,keysData,completionId);
  try {
    invoke(request);
    waitCompletionLatch(completionId,null);
  }
 catch (  Throwable t) {
    deregisterCompletionLatch(completionId);
    throw ExceptionUtil.rethrowAllowedTypeFirst(t,CacheException.class);
  }
}

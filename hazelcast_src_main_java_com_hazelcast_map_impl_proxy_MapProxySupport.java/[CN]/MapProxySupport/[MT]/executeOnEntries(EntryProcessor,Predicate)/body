{
  Map result=new HashMap();
  try {
    OperationFactory operation=operationProvider.createPartitionWideEntryWithPredicateOperationFactory(name,entryProcessor,predicate);
    Map<Integer,Object> results=operationService.invokeOnAllPartitions(SERVICE_NAME,operation);
    for (    Object o : results.values()) {
      if (o != null) {
        MapEntries mapEntries=(MapEntries)o;
        for (        Entry<Data,Data> entry : mapEntries) {
          Data key=entry.getKey();
          result.put(toObject(key),toObject(entry.getValue()));
          invalidateNearCache(key);
        }
      }
    }
  }
 catch (  Throwable t) {
    throw ExceptionUtil.rethrow(t);
  }
  return result;
}

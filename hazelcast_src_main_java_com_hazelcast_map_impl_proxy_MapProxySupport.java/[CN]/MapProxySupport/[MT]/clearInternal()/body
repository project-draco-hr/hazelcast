{
  try {
    Operation clearOperation=operationProvider.createClearOperation(name);
    clearOperation.setServiceName(SERVICE_NAME);
    BinaryOperationFactory factory=new BinaryOperationFactory(clearOperation,getNodeEngine());
    Map<Integer,Object> resultMap=operationService.invokeOnAllPartitions(SERVICE_NAME,factory);
    int numberOfAffectedEntries=0;
    for (    Object object : resultMap.values()) {
      numberOfAffectedEntries+=(Integer)object;
    }
    MemberSelector selector=MemberSelectors.and(LITE_MEMBER_SELECTOR,NON_LOCAL_MEMBER_SELECTOR);
    for (    Member member : getNodeEngine().getClusterService().getMembers(selector)) {
      operationService.invokeOnTarget(SERVICE_NAME,new ClearOperation(name),member.getAddress());
    }
    if (numberOfAffectedEntries > 0) {
      publishMapEvent(numberOfAffectedEntries,EntryEventType.CLEAR_ALL);
    }
  }
 catch (  Throwable t) {
    throw rethrow(t);
  }
}

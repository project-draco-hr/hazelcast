{
  final Data data=serializationService.toData(value,partitionStrategy);
  if (optimizeQuery) {
    return statisticsEnabled ? new CachedDataRecordWithStats(key,data) : new CachedDataRecord(key,data);
  }
  return statisticsEnabled ? new DataRecordWithStats(key,data) : new DataRecord(key,data);
}

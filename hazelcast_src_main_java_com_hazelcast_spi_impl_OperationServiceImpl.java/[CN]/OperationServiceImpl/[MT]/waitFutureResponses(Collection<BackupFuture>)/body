{
  int size=futures != null ? futures.size() : 0;
  while (size > 0) {
    for (    BackupFuture f : futures) {
      if (!f.isDone()) {
        try {
          f.get(1,TimeUnit.SECONDS);
        }
 catch (        InterruptedException ignored) {
        }
catch (        TimeoutException ignored) {
        }
catch (        ExecutionException e) {
          if (nodeEngine.getClusterService().getSize() > f.replicaIndex) {
            throw e;
          }
        }
        if (f.isDone()) {
          size--;
        }
      }
    }
  }
}

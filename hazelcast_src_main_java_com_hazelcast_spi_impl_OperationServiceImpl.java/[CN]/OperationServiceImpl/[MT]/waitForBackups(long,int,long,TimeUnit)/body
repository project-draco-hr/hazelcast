{
  final Semaphore lock=backupCalls.get(callId);
  if (lock == null) {
    throw new IllegalStateException("No backup record found for call -> " + callId);
  }
  try {
    return lock.tryAcquire(backupCount,timeout,unit);
  }
  finally {
    backupCalls.remove(callId);
  }
}

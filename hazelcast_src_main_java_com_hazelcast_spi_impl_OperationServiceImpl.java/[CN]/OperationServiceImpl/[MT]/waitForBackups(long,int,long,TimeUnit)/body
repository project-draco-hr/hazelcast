{
  final Semaphore lock=backupCalls.get(callId);
  if (lock == null) {
    throw new IllegalStateException("No backup record found for call -> " + callId);
  }
  try {
    if (backupCount != 0) {
      return lock.tryAcquire(backupCount,timeout,unit);
    }
    return true;
  }
  finally {
    backupCalls.remove(callId);
  }
}

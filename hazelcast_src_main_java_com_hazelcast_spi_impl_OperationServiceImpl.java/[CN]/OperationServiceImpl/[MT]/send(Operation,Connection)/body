{
  Data data=nodeEngine.toData(op);
  final int partitionId=getPartitionIdForExecution(op);
  Packet packet=new Packet(data,partitionId,nodeEngine.getSerializationContext());
  packet.setHeader(Packet.HEADER_OP);
  if (op instanceof ResponseOperation) {
    packet.setHeader(Packet.HEADER_RESPONSE);
  }
  return nodeEngine.send(packet,connection);
}

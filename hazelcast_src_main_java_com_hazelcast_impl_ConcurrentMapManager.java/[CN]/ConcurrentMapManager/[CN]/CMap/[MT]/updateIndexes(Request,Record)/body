{
  int indexCount=request.indexCount;
  for (int i=0; i < indexCount; i++) {
    Index index=indexes[i];
    long newValue=request.indexes[i];
    long oldValue=record.getAndSetIndex(i,newValue);
    if (oldValue == Long.MIN_VALUE) {
      node.queryService.addNewIndex(index,newValue,record);
    }
 else {
      if (oldValue != newValue) {
        node.queryService.updateIndex(index,oldValue,newValue,record);
      }
    }
  }
}

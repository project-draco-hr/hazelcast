{
  ThreadContext threadContext=ThreadContext.get();
  TransactionImpl txn=threadContext.getCallContext().getTransaction();
  if (txn != null && txn.getStatus() == Transaction.TXN_STATUS_ACTIVE) {
    if (!txn.has(name,key)) {
      MLock mlock=new MLock();
      boolean locked=mlock.lock(name,key,DEFAULT_TXN_TIMEOUT);
      if (!locked) {
        throwTxTimeoutException(key);
      }
    }
    if (txn.has(name,key,value)) {
      return false;
    }
    txn.attachPutMultiOp(name,key,toData(value));
    return true;
  }
 else {
    boolean result=booleanCall(CONCURRENT_MAP_PUT_MULTI,name,key,value,-1,-1);
    if (result) {
      backup(CONCURRENT_MAP_BACKUP_PUT);
    }
    return result;
  }
}

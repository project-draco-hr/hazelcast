{
  MapPartition mapPartition=getOperationContext().getMapPartition();
  Record record=mapPartition.records.get(key);
  if (record == null) {
    record=new DefaultRecord(null,mapPartition.partitionInfo.getPartitionId(),key,value,-1,-1,getOperationContext().getMapService().nextId());
    mapPartition.records.put(key,record);
  }
 else {
    record.setValueData(value);
  }
  record.setActive();
  record.setDirty(true);
  super.run();
}

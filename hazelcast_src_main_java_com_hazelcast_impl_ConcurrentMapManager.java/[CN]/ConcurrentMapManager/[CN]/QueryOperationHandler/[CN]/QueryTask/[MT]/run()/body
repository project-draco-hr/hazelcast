{
  Predicate predicate=null;
  if (request.value != null) {
    predicate=(Predicate)toObject(request.value);
  }
  AtomicBoolean strongRef=new AtomicBoolean(false);
  Set<MapEntry> results=node.queryService.query(cmap.name,strongRef,predicate);
  if (predicate != null) {
    if (!strongRef.get()) {
      Iterator<MapEntry> it=results.iterator();
      while (it.hasNext()) {
        Record record=(Record)it.next();
        if (record.isActive()) {
          try {
            if (!predicate.apply(record.getRecordEntry())) {
              it.remove();
            }
          }
 catch (          Exception e) {
            e.printStackTrace();
            it.remove();
          }
        }
 else {
          it.remove();
        }
      }
    }
  }
  createEntries(request,results);
  enqueueAndReturn(new Processable(){
    public void process(){
      returnResponse(request);
    }
  }
);
}

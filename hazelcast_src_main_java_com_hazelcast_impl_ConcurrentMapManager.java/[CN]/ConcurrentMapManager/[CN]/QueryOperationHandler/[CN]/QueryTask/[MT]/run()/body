{
  try {
    Predicate predicate=null;
    if (request.value != null) {
      predicate=(Predicate)toObject(request.value);
    }
    final QueryContext queryContext=new QueryContext(cmap.getName(),predicate,cmap.getMapIndexService());
    Set<MapEntry> results=cmap.getMapIndexService().doQuery(queryContext);
    boolean evaluateValues=(predicate != null && !queryContext.isStrong());
    createResultPairs(request,results,evaluateValues,predicate);
  }
 catch (  Throwable e) {
    logger.log(Level.SEVERE,request.toString(),e);
    request.response=e;
  }
  enqueueAndReturn(new Processable(){
    public void process(){
      int callerPartitionHash=request.blockId;
      if (partitionManager.containsMigratingBlock() || callerPartitionHash != partitionManager.hashBlocks()) {
        request.response=OBJECT_REDO;
      }
      boolean sent=returnResponse(request);
      if (!sent) {
        Connection conn=node.connectionManager.getConnection(request.caller);
        logger.log(Level.WARNING,request + " !! response cannot be sent to " + request.caller+ " conn:"+ conn);
      }
    }
  }
);
}

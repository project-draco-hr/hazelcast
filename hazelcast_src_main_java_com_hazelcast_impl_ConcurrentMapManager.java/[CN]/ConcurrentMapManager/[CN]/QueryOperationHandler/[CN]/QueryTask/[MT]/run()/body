{
  Predicate predicate=null;
  if (request.value != null) {
    predicate=(Predicate)toObject(request.value);
  }
  QueryContext queryContext=new QueryContext(cmap.getName(),predicate);
  Set<MapEntry> results=cmap.getMapIndexService().doQuery(queryContext);
  if (predicate != null) {
    if (results != null && !queryContext.isStrong()) {
      Iterator<MapEntry> it=results.iterator();
      while (it.hasNext()) {
        Record record=(Record)it.next();
        if (record.isActive()) {
          try {
            if (!predicate.apply(record.getRecordEntry())) {
              it.remove();
            }
          }
 catch (          Exception e) {
            e.printStackTrace();
            it.remove();
          }
        }
 else {
          it.remove();
        }
      }
    }
  }
  createEntries(request,results);
  returnResponse(request,conn);
}

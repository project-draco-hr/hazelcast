{
  CMap cmap=getOrCreateMap(request.name);
  if (cmap.isNotLocked(request)) {
    if (shouldSchedule(request)) {
      if (request.hasEnoughTimeToSchedule()) {
        if (systemLogService.shouldLog(INFO)) {
          systemLogService.info(request,MapSystemLogFactory.newScheduleRequest(request,cmap.getRecord(request)));
        }
        schedule(request);
      }
 else {
        if (systemLogService.shouldLog(INFO)) {
          systemLogService.info(request,"NoTimeToSchedule",request.name,request.operation);
        }
        onNoTimeToSchedule(request);
      }
      return;
    }
    Record record=cmap.getRecord(request);
    if ((record == null || record.isLoadable()) && cmap.loader != null) {
      storeExecutor.execute(new RemoveLoader(cmap,request),request.key.hashCode());
    }
 else {
      storeProceed(cmap,request);
    }
  }
 else {
    returnRedoResponse(request,REDO_MAP_LOCKED);
  }
}

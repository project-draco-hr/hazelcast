{
  if (isSuperClient())   return;
  Collection<CMap> cmaps=maps.values();
  for (  final CMap cmap : cmaps) {
    final Object[] records=cmap.mapRecords.values().toArray();
    cmap.reset();
    for (    Object recObj : records) {
      final Record rec=(Record)recObj;
      if (rec.key == null || rec.key.size() == 0) {
        logger.log(Level.SEVERE,"Record.key is null or empty " + rec.key);
      }
      executeLocally(new Runnable(){
        public void run(){
          MMigrate mmigrate=new MMigrate();
          if (cmap.isMultiMap()) {
            List<Data> values=rec.lsValues;
            if (values == null || values.size() == 0) {
              mmigrate.migrateMulti(rec,null);
            }
 else {
              for (              Data value : values) {
                mmigrate.migrateMulti(rec,value);
              }
            }
          }
 else {
            boolean migrated=mmigrate.migrate(rec);
            if (!migrated) {
              logger.log(Level.FINEST,"Migration failed " + rec.key);
            }
          }
        }
      }
);
    }
  }
  executeLocally(new Runnable(){
    public void run(){
      Processable processCompletion=new Processable(){
        public void process(){
          MigrationCompleteOperationHandler h=(MigrationCompleteOperationHandler)getPacketProcessor(CONCURRENT_MAP_MIGRATION_COMPLETE);
          h.doMigrationComplete(thisAddress);
          h.sendMigrationCompleteToAll();
          if (DEBUG) {
            printBlocks();
            logger.log(Level.FINEST,"Migration ended!");
          }
        }
      }
;
      enqueueAndReturn(processCompletion);
    }
  }
);
}

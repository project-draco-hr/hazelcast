{
  InitialState initialState=new InitialState(node.factory.getName());
  Collection<CMap> cmaps=maps.values();
  for (  final CMap cmap : cmaps) {
    initialState.createAndAddMapState(cmap);
  }
  sendProcessableToAll(initialState,false);
  if (isSuperClient())   return;
  cmaps=maps.values();
  for (  final CMap cmap : cmaps) {
    final Object[] records=cmap.mapRecords.values().toArray();
    cmap.reset();
    for (    Object recObj : records) {
      final Record rec=(Record)recObj;
      if (rec.isActive()) {
        if (rec.getKey() == null || rec.getKey().size() == 0) {
          throw new RuntimeException("Record.key is null or empty " + rec.getKey());
        }
        executeLocally(new Runnable(){
          public void run(){
            MMigrate mmigrate=new MMigrate();
            if (cmap.isMultiMap()) {
              List<Data> values=rec.lsValues;
              if (values == null || values.size() == 0) {
                mmigrate.migrateMulti(rec,null);
              }
 else {
                for (                Data value : values) {
                  mmigrate.migrateMulti(rec,value);
                }
              }
            }
 else {
              boolean migrated=mmigrate.migrate(rec);
              if (!migrated) {
                logger.log(Level.FINEST,"Migration failed " + rec.getKey());
              }
            }
          }
        }
);
      }
    }
  }
  executeLocally(new Runnable(){
    public void run(){
      MultiMigrationComplete mmc=new MultiMigrationComplete();
      mmc.call();
      logger.log(Level.FINEST,"Migration ended!");
    }
  }
);
}

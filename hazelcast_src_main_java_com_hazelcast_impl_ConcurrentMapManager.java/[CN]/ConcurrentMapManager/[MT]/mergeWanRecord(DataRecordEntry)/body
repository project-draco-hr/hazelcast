{
  String name=mergingEntry.getName();
  DataRecordEntry existingEntry=new MGetDataRecordEntry().get(name,mergingEntry.getKeyData());
  final CMap cmap=node.concurrentMapManager.getMap(name);
  MProxy mproxy=(MProxy)node.factory.getOrCreateProxyByName(name);
  MergePolicy mergePolicy=cmap.wanMergePolicy;
  if (mergePolicy == null) {
    logger.log(Level.SEVERE,"Received wan merge but no merge policy defined!");
  }
 else {
    Object winner=mergePolicy.merge(cmap.getName(),mergingEntry,existingEntry);
    if (winner != null) {
      if (winner == MergePolicy.REMOVE_EXISTING) {
        mproxy.removeForSync(mergingEntry.getKey());
      }
 else {
        mproxy.putForSync(mergingEntry.getKeyData(),winner);
      }
    }
  }
}

{
  final Record record=ensureRecord(request);
  request.scheduled=true;
  ScheduledAction scheduledAction=new ScheduledAction(request){
    @Override public boolean consume(){
      handler.handle(request);
      return true;
    }
    @Override public void onExpire(){
      handler.onNoTimeToSchedule(request);
    }
    @Override public void onMigrate(){
      returnRedoResponse(request,REDO_PARTITION_MIGRATING);
    }
    @Override public String toString(){
      return getClass().getSimpleName() + "[" + id+ "]{ request= "+ request+ ", neverExpires="+ neverExpires()+ ", timeout= "+ timeout+ "}";
    }
  }
;
  record.addScheduledAction(scheduledAction);
  node.clusterManager.registerScheduledAction(scheduledAction);
}

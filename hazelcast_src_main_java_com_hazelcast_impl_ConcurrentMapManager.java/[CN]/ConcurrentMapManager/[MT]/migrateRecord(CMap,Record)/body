{
  if (!node.isActive() || node.factory.restarted)   return;
  MMigrate mmigrate=new MMigrate();
  if (cmap.isMultiMap()) {
    Collection<ValueHolder> values=rec.getMultiValues();
    if (values == null || values.size() == 0) {
      mmigrate.migrateMulti(rec,null);
    }
 else {
      for (      ValueHolder valueHolder : values) {
        mmigrate.migrateMulti(rec,valueHolder.getData());
      }
    }
  }
 else {
    boolean migrated=mmigrate.migrate(rec);
    if (!migrated) {
      logger.log(Level.FINEST,"Migration failed " + rec.getKeyData());
    }
  }
}

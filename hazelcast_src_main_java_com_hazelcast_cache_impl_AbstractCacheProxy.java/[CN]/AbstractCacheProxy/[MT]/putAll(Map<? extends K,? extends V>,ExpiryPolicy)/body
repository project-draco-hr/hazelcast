{
  ensureOpen();
  validateNotNull(map);
  int partitionCount=partitionService.getPartitionCount();
  try {
    List<Future> futures=new ArrayList<Future>(partitionCount);
    List<Map.Entry<Data,Data>>[] entriesPerPartition=groupDataToPartitions(map,partitionCount);
    putToAllPartitionsAndWaitForCompletion(entriesPerPartition,futures,expiryPolicy);
  }
 catch (  Exception e) {
    throw ExceptionUtil.rethrow(e);
  }
}

{
  final long now=System.currentTimeMillis();
  if ((now - lastCheck) > MAX_IDLE_MILLIS) {
    final StringBuilder sb=new StringBuilder("Hazelcast ServiceThread is blocked for ");
    sb.append((now - lastCheck));
    sb.append(" ms. Restarting Hazelcast!");
    sb.append("\n\tnow:" + now);
    sb.append("\n\tlastCheck:" + lastCheck);
    sb.append("\n\tmaxIdleMillis:" + MAX_IDLE_MILLIS);
    sb.append("\n\tRESTART_ON_MAX_IDLE:" + RESTART_ON_MAX_IDLE);
    sb.append("\n");
    if (RESTART_ON_MAX_IDLE) {
      logger.log(Level.INFO,sb.toString());
      new Thread(new Runnable(){
        public void run(){
          node.factory.restart();
        }
      }
,"hz.RestartThread").start();
    }
    lastCheck=now;
  }
  if ((now - lastPeriodicCheck) > PERIODIC_CHECK_INTERVAL_MILLIS) {
    publishUtilization();
    for (    Runnable runnable : periodicRunnables) {
      if (runnable != null) {
        runnable.run();
      }
    }
    lastPeriodicCheck=now;
  }
}

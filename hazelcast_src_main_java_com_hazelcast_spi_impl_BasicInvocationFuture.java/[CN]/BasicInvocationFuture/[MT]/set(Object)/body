{
  offeredResponse=resolveInternalResponse(offeredResponse);
  ExecutionCallbackNode<E> callbackChain;
synchronized (this) {
    if (response != null && !(response instanceof BasicInvocation.InternalResponse)) {
      ILogger logger=basicInvocation.logger;
      if (logger.isFinestEnabled()) {
        logger.info("Future response is already set! Current response: " + response + ", Offered response: "+ offeredResponse+ ", Invocation: "+ basicInvocation);
      }
      return;
    }
    response=offeredResponse;
    if (offeredResponse == BasicInvocation.WAIT_RESPONSE) {
      return;
    }
    callbackChain=callbackHead;
    callbackHead=null;
    notifyAll();
  }
  operationService.deregisterInvocation(basicInvocation);
  notifyCallbacks(callbackChain);
}

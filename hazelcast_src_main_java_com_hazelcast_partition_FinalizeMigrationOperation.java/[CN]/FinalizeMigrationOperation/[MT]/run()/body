{
  final Collection<MigrationAwareService> services=getServices();
  final MigrationEndpoint endpoint=source ? SOURCE : DESTINATION;
  final MigrationType type=move ? MOVE : COPY;
  final MigrationServiceEvent event=new MigrationServiceEvent(endpoint,getPartitionId(),getReplicaIndex(),type);
  for (  MigrationAwareService service : services) {
    try {
      if (success) {
        service.commitMigration(event);
      }
 else {
        service.rollbackMigration(event);
      }
    }
 catch (    Throwable e) {
      getNodeService().getLogger(FinalizeMigrationOperation.class.getName()).log(Level.WARNING,"Error while finalizing migration -> " + event,e);
    }
  }
  PartitionService partitionService=getService();
  partitionService.removeActiveMigration(getPartitionId());
}

{
  PartitionServiceImpl partitionService=getService();
  MigrationInfo migrationInfo=partitionService.getActiveMigration(getPartitionId());
  if (migrationInfo != null) {
    final Collection<MigrationAwareService> services=getServices();
    final PartitionMigrationEvent event=new PartitionMigrationEvent(endpoint,getPartitionId());
    for (    MigrationAwareService service : services) {
      try {
        if (success) {
          service.commitMigration(event);
        }
 else {
          service.rollbackMigration(event);
        }
      }
 catch (      Throwable e) {
        getLogger().log(Level.WARNING,"Error while finalizing migration -> " + event,e);
      }
    }
    partitionService.removeActiveMigration(getPartitionId());
    if (success) {
      NodeEngineImpl nodeEngine=(NodeEngineImpl)getNodeEngine();
      nodeEngine.onPartitionMigrate(migrationInfo);
    }
  }
}

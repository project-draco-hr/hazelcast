{
  if (response == null) {
    long waitMillis=unit.toMillis(timeout);
    if (waitMillis > 0) {
synchronized (this) {
        while (waitMillis > 0 && response == null) {
          long start=Clock.currentTimeMillis();
          this.wait(waitMillis);
          waitMillis-=(Clock.currentTimeMillis() - start);
        }
      }
    }
  }
  return resolveResponse();
}

{
  Set<Member> members=node.getClusterImpl().getMembers();
  Map<Member,ArrayList<Integer>> memberPartitions=new HashMap<Member,ArrayList<Integer>>(members.size());
  for (int i=0; i < partitionCount; i++) {
    Member owner=getOwner(i);
    ArrayList<Integer> ownedPartitions=memberPartitions.get(owner);
    if (ownedPartitions == null) {
      ownedPartitions=new ArrayList<Integer>();
      memberPartitions.put(owner,ownedPartitions);
    }
    ownedPartitions.add(i);
  }
  return memberPartitions;
}

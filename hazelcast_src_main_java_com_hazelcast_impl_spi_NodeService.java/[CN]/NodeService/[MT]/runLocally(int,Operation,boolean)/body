{
  final ExecutorService executor=getExecutor(partitionId,nonBlocking);
  executor.execute(new Runnable(){
    public void run(){
      final ResponseHandler responseHandler=op.getOperationContext().getResponseHandler();
      if (partitionId != -1 && !nonBlocking) {
        PartitionInfo partitionInfo=getPartitionInfo(partitionId);
        Address owner=partitionInfo.getOwner();
        if (!getThisAddress().equals(owner)) {
          responseHandler.sendResponse(new WrongTargetException(getThisAddress(),owner,partitionId,op.getClass().getName()));
          return;
        }
      }
      try {
        op.run();
      }
 catch (      Throwable e) {
        System.err.println("responseHandler = " + responseHandler);
        e.printStackTrace();
        responseHandler.sendResponse(e);
      }
    }
  }
);
}

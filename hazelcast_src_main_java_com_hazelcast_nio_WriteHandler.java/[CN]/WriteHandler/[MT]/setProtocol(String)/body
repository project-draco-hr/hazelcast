{
  if (socketWriter == null) {
    if ("HZC".equals(protocol)) {
      socketWriter=new SocketPacketWriter(connection);
      buffer.put("HZC".getBytes());
      inOutSelector.addTask(this);
    }
 else     if ("P01".equals(protocol)) {
      socketWriter=new SocketProtocolWriter();
    }
 else {
      socketWriter=new SocketTextWriter(connection);
    }
  }
}

{
  final CountDownLatch countDownLatch=new CountDownLatch(1000);
  final HazelcastInstance node=createHazelcastInstance();
  final IMap map=node.getMap(randomMapName());
  map.addLocalEntryListener(new EntryAdapter(){
    @Override public void mapEvicted(    MapEvent event){
      final int numberOfEntries=event.getNumberOfEntriesAffected();
      for (int i=0; i < numberOfEntries; i++) {
        countDownLatch.countDown();
      }
    }
  }
);
  for (int i=0; i < 1000; i++) {
    map.put(i,i);
  }
  map.evictAll();
  assertOpenEventually(countDownLatch);
}

{
  if (replicatedRecordStorage instanceof AbstractReplicatedRecordStore) {
    AbstractReplicatedRecordStore recordStore=(AbstractReplicatedRecordStore)replicatedRecordStorage;
    return executionService.scheduleWithFixedDelay(new Cleaner(recordStore),INITIAL_DELAY,PERIOD,TimeUnit.SECONDS);
  }
  String className=replicatedRecordStorage.getClass().getName();
  throw new IllegalArgumentException("Unknown ReplicatedRecordStore implementation: " + className);
}

{
  if (message instanceof ReplicationMessage) {
    ReplicationMessage replicationMessage=(ReplicationMessage)message;
    ReplicatedRecordStore replicatedRecordStorage=replicatedStorages.get(replicationMessage.getName());
    if (replicatedRecordStorage instanceof AbstractReplicatedRecordStore) {
      ((AbstractReplicatedRecordStore)replicatedRecordStorage).queueUpdateMessage(replicationMessage);
    }
  }
 else   if (message instanceof MultiReplicationMessage) {
    MultiReplicationMessage multiReplicationMessage=(MultiReplicationMessage)message;
    ReplicatedRecordStore replicatedRecordStorage=replicatedStorages.get(multiReplicationMessage.getName());
    for (    ReplicationMessage replicationMessage : multiReplicationMessage.getReplicationMessages()) {
      if (replicatedRecordStorage instanceof AbstractReplicatedRecordStore) {
        ((AbstractReplicatedRecordStore)replicatedRecordStorage).queueUpdateMessage(replicationMessage);
      }
    }
  }
}

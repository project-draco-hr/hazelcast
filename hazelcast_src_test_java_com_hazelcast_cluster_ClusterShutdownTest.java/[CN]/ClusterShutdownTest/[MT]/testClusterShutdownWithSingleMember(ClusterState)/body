{
  TestHazelcastInstanceFactory factory=createHazelcastInstanceFactory(4);
  final HazelcastInstance[] instances=factory.newInstances();
  warmUpPartitions(instances);
  changeClusterStateEventually(instances[0],clusterState);
  final Thread thread=new Thread(new Runnable(){
    @Override public void run(){
      instances[0].getCluster().shutdown();
    }
  }
);
  thread.start();
  assertNodesShutDownEventually(instances);
}

{
  final int requiredCapacity=limit + additionalCapacity;
  if (requiredCapacity < 0) {
    final String s=String.format("Insufficient capacity: limit=%d additional=%d",limit,additionalCapacity);
    throw new IllegalStateException(s);
  }
  if (requiredCapacity > capacity) {
    final int newCapacity=findSuitableCapacity(capacity,requiredCapacity);
    final byte[] newBuffer=Arrays.copyOf(buffer,newCapacity);
    capacity=newCapacity;
    buffer=newBuffer;
    mutableDirectBuffer.wrap(newBuffer);
  }
}

{
  this.properties=properties;
  final String groupName=properties.getProperty(ClientPropertyName.GROUP_NAME);
  final String groupPassword=properties.getProperty(ClientPropertyName.GROUP_PASSWORD);
  final ThreadFactory threadFactory=new ThreadFactory(){
    final AtomicInteger atomicInteger=new AtomicInteger();
    public Thread newThread(    Runnable r){
      Thread t=new Thread(r,"hz.client." + groupName + "_cached_thread_"+ atomicInteger.incrementAndGet());
      if (t.isDaemon()) {
        t.setDaemon(false);
      }
      if (t.getPriority() != Thread.NORM_PRIORITY) {
        t.setPriority(Thread.NORM_PRIORITY);
      }
      return t;
    }
  }
;
  executor=Executors.newCachedThreadPool(threadFactory);
  lifecycleService=new LifecycleServiceClientImpl(this);
  lifecycleService.fireLifecycleEvent(STARTING);
  parallelExecutorService=new ParallelExecutorService(executor);
  parallelExecutorDefault=parallelExecutorService.newParallelExecutor(10);
  if (automatic) {
    this.connectionManager=new ConnectionManager(this,lifecycleService,clusterMembers[0]);
  }
 else {
    this.connectionManager=new ConnectionManager(this,lifecycleService,clusterMembers,shuffle);
  }
  this.connectionManager.setBinder(new DefaultClientBinder(this));
  final Connection aliveConnection=connectionManager.getInitConnection();
  if (aliveConnection == null) {
    throw new IllegalStateException("Unable to connect to cluster");
  }
  out=new OutRunnable(this,calls,new PacketWriter());
  new Thread(out,"hz.client.OutThread").start();
  in=new InRunnable(this,out,calls,new PacketReader());
  new Thread(in,"hz.client.InThread").start();
  listenerManager=new ListenerManager(this);
  new Thread(listenerManager,"hz.client.Listener").start();
  mapLockProxy=getMap("__hz_Locks");
  clusterClientProxy=new ClusterClientProxy(this);
  partitionClientProxy=new PartitionClientProxy(this);
  Boolean authenticate=clusterClientProxy.authenticate(groupName,groupPassword);
  if (!authenticate) {
    this.shutdown();
    throw new AuthenticationException("Wrong group name and password.");
  }
  try {
    this.connectionManager.bindConnection(aliveConnection);
  }
 catch (  IOException e) {
    this.shutdown();
    throw new ClusterClientException(e.getMessage(),e);
  }
  if (automatic) {
    this.getCluster().addMembershipListener(connectionManager);
    connectionManager.updateMembers();
  }
  lifecycleService.fireLifecycleEvent(STARTED);
}

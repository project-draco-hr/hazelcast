{
  List<Integer> partitionsWithCachedEntries=new ArrayList<Integer>(partitionToKeyData.size());
  for (  Entry<Integer,List<Data>> partitionKeyEntry : partitionToKeyData.entrySet()) {
    List<Data> keyList=partitionKeyEntry.getValue();
    Iterator<Data> iterator=keyList.iterator();
    while (iterator.hasNext()) {
      Data key=iterator.next();
      Object cached=nearCache.get(key);
      if (cached != null && NULL_OBJECT != cached) {
        result.put((K)toObject(key),(V)cached);
        iterator.remove();
      }
    }
    if (keyList.isEmpty()) {
      partitionsWithCachedEntries.add(partitionKeyEntry.getKey());
    }
  }
  for (  Integer partitionId : partitionsWithCachedEntries) {
    partitionToKeyData.remove(partitionId);
  }
  List<MapEntries> responses=super.getAllInternal(partitionToKeyData,result);
  for (  MapEntries entries : responses) {
    for (    Entry<Data,Data> entry : entries.entries()) {
      nearCache.put(entry.getKey(),entry.getValue());
    }
  }
  return responses;
}

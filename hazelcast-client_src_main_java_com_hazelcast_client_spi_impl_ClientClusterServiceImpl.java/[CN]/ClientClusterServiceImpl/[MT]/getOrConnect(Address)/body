{
  int count=0;
  final ClientConnectionManager connectionManager=client.getConnectionManager();
  IOException lastError=null;
  while (count < RETRY_COUNT) {
    try {
      if (target == null || getMember(target) == null) {
        return connectionManager.getRandomConnection();
      }
 else {
        return connectionManager.getOrConnect(target);
      }
    }
 catch (    IOException e) {
      lastError=e;
    }
    target=null;
    count++;
  }
  throw lastError;
}

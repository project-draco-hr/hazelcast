{
  final Future<Connection> f=client.getClientExecutionService().submit(new InitialConnectionCall());
  try {
    int connectionAttemptPeriodMs=client.getClientConfig().getConnectionAttemptPeriod();
    int connectionAttempts=client.getClientConfig().getConnectionAttemptLimit();
    long timeoutMs=((long)connectionAttempts) * connectionAttemptPeriodMs + 1000;
    final Connection connection=f.get(timeoutMs,TimeUnit.MILLISECONDS);
    clusterThread.setInitialConn(connection);
  }
 catch (  Throwable e) {
    if (e instanceof ExecutionException && e.getCause() != null) {
      e=e.getCause();
      fixRemoteStackTrace(e,Thread.currentThread().getStackTrace());
    }
    if (e instanceof RuntimeException) {
      throw (RuntimeException)e;
    }
    throw new HazelcastException(e);
  }
  clusterThread.start();
  while (membersRef.get() == null) {
    try {
      Thread.sleep(100);
    }
 catch (    InterruptedException e) {
      throw new HazelcastException(e);
    }
  }
  initMembershipListener();
  active=true;
}

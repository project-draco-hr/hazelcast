{
  while (!Thread.currentThread().isInterrupted()) {
    try {
      if (conn == null) {
        try {
          conn=pickConnection();
        }
 catch (        Exception e) {
          logger.log(Level.SEVERE,"Error while connecting to cluster!",e);
          client.getLifecycleService().shutdown();
          return;
        }
      }
      loadInitialMemberList();
      listenMembershipEvents();
    }
 catch (    Exception e) {
      if (client.getLifecycleService().isRunning()) {
        logger.log(Level.WARNING,"Error while listening cluster events!",e);
      }
      IOUtil.closeResource(conn);
      conn=null;
    }
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException e) {
      break;
    }
  }
}

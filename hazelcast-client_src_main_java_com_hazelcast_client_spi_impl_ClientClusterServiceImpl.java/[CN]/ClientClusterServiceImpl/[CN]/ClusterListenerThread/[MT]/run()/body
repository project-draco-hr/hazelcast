{
  while (!Thread.currentThread().isInterrupted()) {
    try {
      if (conn == null) {
        try {
          conn=pickConnection();
        }
 catch (        Exception e) {
          logger.severe("Error while connecting to cluster!",e);
          client.getLifecycleService().shutdown();
          latch.countDown();
          return;
        }
      }
      loadInitialMemberList();
      listenMembershipEvents();
    }
 catch (    Exception e) {
      if (client.getLifecycleService().isRunning()) {
        if (logger.isFinestEnabled()) {
          logger.warning("Error while listening cluster events! -> " + conn,e);
        }
 else {
          logger.warning("Error while listening cluster events! -> " + conn + ", Error: "+ e.toString());
        }
      }
      IOUtil.closeResource(conn);
      conn=null;
      fireConnectionEvent(true);
    }
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException e) {
      break;
    }
  }
}

{
  this.client=client;
  clusterThread=new ClusterListenerThread(client.getThreadGroup(),client.getName() + ".cluster-listener");
  final ClientConfig clientConfig=getClientConfig();
  redoOperation=clientConfig.isRedoOperation();
  credentials=clientConfig.getCredentials();
  final Collection<EventListener> listeners=client.getClientConfig().getListeners();
  if (listeners != null && !listeners.isEmpty()) {
    for (    EventListener listener : listeners) {
      if (listener instanceof MembershipListener) {
        addMembershipListener((MembershipListener)listener);
      }
    }
  }
}

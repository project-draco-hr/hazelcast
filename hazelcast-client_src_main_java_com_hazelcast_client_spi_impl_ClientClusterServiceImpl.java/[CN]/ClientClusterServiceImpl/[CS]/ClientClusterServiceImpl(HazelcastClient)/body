{
  this.client=client;
  clusterThread=new ClusterListenerThread(client.getThreadGroup(),client.getName() + ".cluster-listener");
  final ClientConfig clientConfig=getClientConfig();
  redoOperation=clientConfig.isRedoOperation();
  credentials=clientConfig.getCredentials();
  final List<ListenerConfig> listenerConfigs=client.getClientConfig().getListenerConfigs();
  if (listenerConfigs != null && !listenerConfigs.isEmpty()) {
    for (    ListenerConfig listenerConfig : listenerConfigs) {
      EventListener listener=listenerConfig.getImplementation();
      if (listener == null) {
        try {
          listener=ClassLoaderUtil.newInstance(clientConfig.getClassLoader(),listenerConfig.getClassName());
        }
 catch (        Exception e) {
          logger.severe(e);
        }
      }
      if (listener instanceof MembershipListener) {
        addMembershipListener((MembershipListener)listener);
      }
    }
  }
}

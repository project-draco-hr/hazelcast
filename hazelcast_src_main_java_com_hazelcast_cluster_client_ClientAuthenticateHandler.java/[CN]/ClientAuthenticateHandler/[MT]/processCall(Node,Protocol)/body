{
  logger=node.loggingService.getLogger(this.getClass().getName());
  Credentials credentials;
  String[] args=protocol.args;
  if (node.securityContext == null) {
    if (args.length < 2) {
      throw new RuntimeException("Should provide both username and password");
    }
    credentials=new UsernamePasswordCredentials(args[0],args[1]);
  }
 else {
    final byte[] array=protocol.buffers[0].array();
    Data data=new Data(SerializationConstants.SERIALIZER_TYPE_BYTE_ARRAY,array);
    credentials=(Credentials)node.nodeEngine.toObject(data);
  }
  boolean authenticated=doAuthenticate(node,credentials,protocol.conn);
  return authenticated ? protocol.success() : protocol.error(null);
}

{
  final int k=3;
  final Config config=new Config();
  config.setProperty(GroupProperties.PROP_GRACEFUL_SHUTDOWN_MAX_WAIT,"1");
  final HazelcastInstance[] instances=StaticNodeFactory.newInstances(config,k);
  ICountDownLatch latch=instances[0].getCountDownLatch("test");
  latch.trySetCount(k - 1);
  try {
    long t=System.currentTimeMillis();
    Assert.assertFalse(latch.await(100,TimeUnit.MILLISECONDS));
    final long elapsed=System.currentTimeMillis() - t;
    Assert.assertTrue(elapsed >= 100);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
}

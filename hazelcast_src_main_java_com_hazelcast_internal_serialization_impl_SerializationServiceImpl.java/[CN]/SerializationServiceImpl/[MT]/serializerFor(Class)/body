{
  SerializerAdapter serializer;
  if (overrideCustomSerialization && constantTypesMap.get(type) == null) {
    serializer=lookupSerializer(type);
    if (serializer != null) {
      return serializer;
    }
  }
  if (DataSerializable.class.isAssignableFrom(type)) {
    return dataSerializerAdapter;
  }
 else   if (Portable.class.isAssignableFrom(type)) {
    return portableSerializerAdapter;
  }
 else {
    serializer=constantTypesMap.get(type);
    if (serializer != null) {
      return serializer;
    }
  }
  serializer=lookupSerializer(type);
  if (serializer == null) {
    if (active) {
      throw new HazelcastSerializationException("There is no suitable serializer for " + type);
    }
    throw new HazelcastInstanceNotActiveException();
  }
  return serializer;
}

{
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(bos);
  try {
    writeData(dos);
    dos.flush();
    packet.setData(bos.toByteArray());
    packet.setLength(bos.size());
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
}

{
  final NamedNodeMap atts=node.getAttributes();
  if (atts != null) {
    for (int a=0; a < atts.getLength(); a++) {
      final org.w3c.dom.Node att=atts.item(a);
      String methodName="set" + getMethodName(att.getNodeName());
      Method method=getMethod(target,methodName,true);
      final String value=att.getNodeValue();
      invoke(target,method,value);
    }
  }
  for (  org.w3c.dom.Node n : new IterableNodeList(node.getChildNodes())) {
    final String value=getTextContent(n).trim();
    String methodName="set" + getMethodName(cleanNodeName(n.getNodeName()));
    Method method=getMethod(target,methodName,true);
    invoke(target,method,value);
  }
  String mName="set" + target.getClass().getSimpleName();
  Method method=getMethod(parent,mName,false);
  if (method == null) {
    mName="add" + target.getClass().getSimpleName();
    method=getMethod(parent,mName,false);
  }
  method.invoke(parent,target);
}

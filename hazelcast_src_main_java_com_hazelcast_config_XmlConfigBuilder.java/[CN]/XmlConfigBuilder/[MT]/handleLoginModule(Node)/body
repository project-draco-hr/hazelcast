{
  final NamedNodeMap attrs=node.getAttributes();
  Node classNameNode=attrs.getNamedItem("class-name");
  String className=getTextContent(classNameNode);
  Node usageNode=attrs.getNamedItem("usage");
  LoginModuleUsage usage=usageNode != null ? LoginModuleUsage.get(getTextContent(usageNode)) : LoginModuleUsage.REQUIRED;
  final LoginModuleConfig moduleConfig=new LoginModuleConfig(className,usage);
  for (  Node child : new IterableNodeList(node.getChildNodes())) {
    final String nodeName=cleanNodeName(child.getNodeName());
    if ("properties".equals(nodeName)) {
      fillProperties(child,moduleConfig.getProperties());
      break;
    }
  }
  return moduleConfig;
}

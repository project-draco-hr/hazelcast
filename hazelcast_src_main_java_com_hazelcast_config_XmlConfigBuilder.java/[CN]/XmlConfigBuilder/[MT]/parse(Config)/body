{
  this.config=config;
  final DocumentBuilder builder=DocumentBuilderFactory.newInstance().newDocumentBuilder();
  Document doc;
  try {
    doc=builder.parse(in);
  }
 catch (  final Exception e) {
    if (configurationFile != null) {
      String msg="Failed to parse " + configurationFile + "\nException: "+ e.getMessage()+ "\nHazelcast startup interrupted.";
      LOGGER.severe(msg);
    }
 else     if (configurationUrl != null) {
      String msg="Failed to parse " + configurationUrl + "\nException: "+ e.getMessage()+ "\nHazelcast startup interrupted.";
      LOGGER.severe(msg);
    }
 else {
      String msg="Failed to parse the inputstream" + "\nException: " + e.getMessage() + "\nHazelcast startup interrupted.";
      LOGGER.severe(msg);
    }
    throw e;
  }
 finally {
    IOUtil.closeResource(in);
  }
  Element element=doc.getDocumentElement();
  try {
    element.getTextContent();
  }
 catch (  final Throwable e) {
    domLevel3=false;
  }
  preprocess(element);
  handleConfig(element);
}

{
  byte[] byteBuffer=new byte[1024];
  FutureClientMessage cmEncode=new FutureClientMessage();
  cmEncode.wrapForEncode(byteBuffer,0,byteBuffer.length);
  cmEncode.theNewField(999).setMessageType(7).setVersion((short)3).addFlag(ClientMessage.BEGIN_AND_END_FLAGS).setCorrelationId(66).setPartitionId(77);
  final int calculatedFrameSize=FutureClientMessage.THE_NEW_HEADER_SIZE + BYTE_DATA.length;
  cmEncode.putPayloadData(BYTE_DATA);
  ClientMessage cmDecode=ClientMessage.createForDecode(byteBuffer,0,byteBuffer.length);
  final byte[] cmDecodeVarData1=new byte[BYTE_DATA.length];
  cmDecode.getPayloadData(cmDecodeVarData1);
  assertEquals(7,cmDecode.getMessageType());
  assertEquals(3,cmDecode.getVersion());
  assertEquals(ClientMessage.BEGIN_AND_END_FLAGS,cmDecode.getFlags());
  assertEquals(66,cmDecode.getCorrelationId());
  assertEquals(77,cmDecode.getPartitionId());
  assertEquals(calculatedFrameSize,cmDecode.getFrameLength());
  assertArrayEquals(cmDecodeVarData1,BYTE_DATA);
}

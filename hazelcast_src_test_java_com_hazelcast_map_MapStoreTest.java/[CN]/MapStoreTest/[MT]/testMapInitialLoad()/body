{
  int size=100000;
  StaticNodeFactory nodeFactory=createNodeFactory(3);
  Config cfg=new Config();
  MapStoreConfig mapStoreConfig=new MapStoreConfig();
  mapStoreConfig.setEnabled(true);
  mapStoreConfig.setImplementation(new SimpleMapLoader(size));
  cfg.getMapConfig("default").setMapStoreConfig(mapStoreConfig);
  HazelcastInstance instance1=nodeFactory.newHazelcastInstance(cfg);
  HazelcastInstance instance2=nodeFactory.newHazelcastInstance(cfg);
  IMap map=instance1.getMap("testMapInitialLoad");
  for (int i=0; i < 100; i++) {
    System.out.println(map.size());
    Thread.sleep(1000);
  }
  assertEquals(size,map.size());
  for (int i=0; i < size; i++) {
    assertEquals(i,map.get(i));
  }
  HazelcastInstance instance3=nodeFactory.newHazelcastInstance(cfg);
  for (int i=0; i < size; i++) {
    assertEquals(i,map.get(i));
  }
}

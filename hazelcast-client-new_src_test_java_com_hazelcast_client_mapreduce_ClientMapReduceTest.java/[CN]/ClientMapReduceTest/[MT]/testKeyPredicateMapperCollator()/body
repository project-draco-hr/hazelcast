{
  prepareClusterNodes(3);
  HazelcastInstance client=HazelcastClient.newHazelcastClient(null);
  IMap<Integer,Integer> m1=getFilledIMap(client,10000);
  JobTracker tracker=client.getJobTracker(randomString());
  Job<Integer,Integer> job=tracker.newJob(KeyValueSource.fromMap(m1));
  ICompletableFuture<Integer> future=job.keyPredicate(new TestKeyPredicate()).mapper(new TestMapper()).submit(new GroupingTestCollator());
  int result=future.get();
  assertEquals(50,result);
}

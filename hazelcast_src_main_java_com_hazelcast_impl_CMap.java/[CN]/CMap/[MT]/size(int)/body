{
  PartitionManager partitionManager=concurrentMapManager.partitionManager;
  if (partitionManager.getVersion() != expectedPartitionVersion)   return -1;
  long now=System.currentTimeMillis();
  int size=0;
  Collection<Record> records=mapRecords.values();
  for (  Record record : records) {
    Address owner=concurrentMapManager.getPartitionOwner(record.getBlockId());
    if (owner != null && thisAddress.equals(owner)) {
      if (record.isActive() && record.isValid(now)) {
        size+=record.valueCount();
      }
    }
  }
  if (partitionManager.getVersion() != expectedPartitionVersion)   return -1;
  return size;
}

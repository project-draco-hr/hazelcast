{
  PartitionManager partitionManager=concurrentMapManager.partitionManager;
  if (partitionManager.getVersion() != expectedPartitionVersion)   return -1;
  long now=System.currentTimeMillis();
  int size=0;
  Collection<Record> records=mapRecords.values();
  for (  Record record : records) {
    PartitionInfo partition=partitionManager.getPartition(record.getBlockId());
    Address owner=partition.getOwner();
    if (owner != null && thisAddress.equals(owner)) {
      if (record.isActive() && record.isValid(now)) {
        size+=record.valueCount();
      }
    }
  }
  System.out.println(thisAddress + "  >>> " + size+ " >>>   "+ mapRecords.size());
  if (partitionManager.getVersion() != expectedPartitionVersion)   return -1;
  return size;
}

{
  Record record=getRecord(req);
  if (ClusterOperation.CONCURRENT_MAP_PUT_IF_ABSENT.equals(operation)) {
    return record == null || !record.isActive() || !record.isValid(now) || !record.hasValueData();
  }
 else   if (ClusterOperation.CONCURRENT_MAP_REPLACE_IF_NOT_NULL.equals(operation)) {
    return record != null && record.isActive() && record.isValid(now) && record.hasValueData();
  }
  return true;
}

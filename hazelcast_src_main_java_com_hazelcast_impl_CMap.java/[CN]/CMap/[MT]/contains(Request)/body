{
  Data key=req.key;
  Data value=req.value;
  if (key != null) {
    Record record=getRecord(req.key);
    if (record == null) {
      return false;
    }
 else {
      Block block=blocks[record.getBlockId()];
      if (thisAddress.equals(block.getOwner())) {
        if (record.isActive() && record.isValid()) {
          touch(record);
          if (value == null) {
            return record.valueCount() > 0;
          }
 else {
            return record.containsValue(value);
          }
        }
      }
    }
  }
 else {
    Collection<Record> records=mapRecords.values();
    for (    Record record : records) {
      long now=System.currentTimeMillis();
      if (record.isActive() && record.isValid(now)) {
        Block block=blocks[record.getBlockId()];
        if (thisAddress.equals(block.getOwner())) {
          if (record.containsValue(value)) {
            return true;
          }
        }
      }
    }
  }
  return false;
}

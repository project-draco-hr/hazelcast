{
  long now=System.currentTimeMillis();
  if (!force && ((now - lastEvictionTime) < evictionDelayMillis)) {
    return;
  }
  lastEvictionTime=now;
  List<Data> lsKeysToEvict=null;
  if (evictionPolicy == SortedHashMap.OrderingType.NONE) {
    if (ttl != 0 || maxIdle != 0 || ttlPerRecord) {
      Collection<Record> values=mapRecords.values();
      for (      Record record : values) {
        if (record.isActive() && !record.isValid(now)) {
          if (record.isEvictable()) {
            if (lsKeysToEvict == null) {
              lsKeysToEvict=new ArrayList<Data>(100);
            }
            markAsRemoved(record);
            lsKeysToEvict.add(record.getKey());
          }
        }
 else {
          break;
        }
      }
    }
  }
 else {
    Collection<Record> records=mapRecords.values();
    int numberOfRecordsToEvict=(int)(ownedRecords.size() * evictionRate);
    int evictedCount=0;
    loopRecords:     for (    Record record : records) {
      if (record.isActive() && record.isEvictable()) {
        if (lsKeysToEvict == null) {
          lsKeysToEvict=new ArrayList<Data>(numberOfRecordsToEvict);
        }
        markAsRemoved(record);
        lsKeysToEvict.add(record.getKey());
        if (++evictedCount >= numberOfRecordsToEvict) {
          break loopRecords;
        }
      }
    }
  }
  if (lsKeysToEvict != null && lsKeysToEvict.size() > 0) {
    for (    final Data key : lsKeysToEvict) {
      concurrentMapManager.evictAsync(getName(),key);
    }
  }
}

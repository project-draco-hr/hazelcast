{
  if (req.key == null || req.key.size() == 0) {
    throw new RuntimeException("Backup key size cannot be 0: " + req.key);
  }
  Record record=getRecord(req.key);
  if (record != null) {
    if (req.version > record.getVersion() + 1) {
      Request reqCopy=new Request();
      reqCopy.setFromRequest(req,true);
      req.key=null;
      req.value=null;
      record.addBackupOp(new VersionedBackupOp(this,reqCopy));
      return true;
    }
 else     if (req.version <= record.getVersion()) {
      return false;
    }
  }
  doBackup(req);
  if (record != null) {
    record.setVersion(req.version);
    record.runBackupOps();
  }
  return true;
}

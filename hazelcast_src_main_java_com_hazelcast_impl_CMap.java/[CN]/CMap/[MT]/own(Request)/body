{
  if (req.key == null || req.key.size() == 0) {
    throw new RuntimeException("Key cannot be null " + req.key);
  }
  if (req.value == null) {
    req.value=new Data();
  }
  Record record=toRecord(req);
  markAsActive(record);
  markAsOwned(record);
  updateIndexes(true,req,record);
  record.setVersion(req.version);
}

{
  long now=System.currentTimeMillis();
  if (setRemovedRecords.size() > 10) {
    Iterator<Record> itRemovedRecords=setRemovedRecords.iterator();
    while (itRemovedRecords.hasNext()) {
      Record record=itRemovedRecords.next();
      if (record.isActive()) {
        itRemovedRecords.remove();
      }
 else       if (shouldRemove(record,now)) {
        itRemovedRecords.remove();
        removeAndPurgeRecord(record);
      }
    }
  }
}

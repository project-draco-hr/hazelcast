{
  Data data=serializationService.toData(response);
  ClientResponse clientResponse=new ClientResponse(data,callId,isError);
  int partitionId=key == null ? -1 : getPartitionService().getPartitionId(key);
  Packet packet=new Packet(serializationService.toBytes(clientResponse),partitionId);
  if (isEvent) {
    packet.setHeader(Packet.HEADER_EVENT);
  }
  Connection conn=endpoint.getConnection();
  conn.write(packet);
}

{
  final Object response=resolveResponse(waitForResponse(timeout,unit));
  done=true;
  if (response instanceof ResponseObj) {
    if (op instanceof BackupAwareOperation) {
      final Object obj=waitForBackupsAndGetResponse((ResponseObj)response);
      if (obj == RETRY_RESPONSE) {
        final Future f=resetAndReInvoke();
        return f.get(timeout,unit);
      }
      return obj;
    }
 else {
      return ((ResponseObj)response).response;
    }
  }
  return response;
}

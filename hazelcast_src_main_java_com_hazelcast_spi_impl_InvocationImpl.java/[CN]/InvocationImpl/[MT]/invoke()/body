{
  if (invokeCount > 0) {
    throw new IllegalStateException("An invocation can not be invoked more than once!");
  }
  if (nodeEngine.operationService.isOperationThread() && (op instanceof PartitionAwareOperation) && !OperationAccessor.isMigrationOperation(op)) {
    throw new IllegalThreadStateException(Thread.currentThread() + " cannot make remote call: " + op);
  }
  try {
    OperationAccessor.setCallTimeout(op,callTimeout);
    OperationAccessor.setCallerAddress(op,nodeEngine.getThisAddress());
    op.setNodeEngine(nodeEngine).setServiceName(serviceName).setPartitionId(partitionId).setReplicaIndex(replicaIndex);
    if (op.getCallerUuid() == null) {
      final ThreadContext threadContext=ThreadContext.get();
      if (threadContext != null) {
        op.setCallerUuid(threadContext.getCallerUuid());
      }
    }
    if (op.getCallerUuid() == null) {
      op.setCallerUuid(nodeEngine.getLocalMember().getUuid());
    }
    doInvoke();
  }
 catch (  Exception e) {
    if (e instanceof RetryableException) {
      notify(e);
    }
 else {
      throw ExceptionUtil.rethrow(e);
    }
  }
  return new InvocationFuture();
}

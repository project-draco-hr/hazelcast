{
  HazelcastInstance hazelcastInstance=new StaticNodeFactory(1).newHazelcastInstance(new Config());
  ITopic<String> topic=hazelcastInstance.getTopic("testTopicStats");
  final CountDownLatch latch1=new CountDownLatch(1000);
  topic.addMessageListener(new MessageListener<String>(){
    public void onMessage(    Message msg){
      latch1.countDown();
    }
  }
);
  final CountDownLatch latch2=new CountDownLatch(2);
  topic.addMessageListener(new MessageListener<String>(){
    public void onMessage(    Message msg){
      latch2.countDown();
    }
  }
);
  for (int i=0; i < 1000; i++) {
    topic.publish("sancar");
  }
  latch1.await();
  latch2.await();
  LocalTopicStatsImpl stats=(LocalTopicStatsImpl)topic.getLocalTopicStats();
  Assert.assertEquals(1000,stats.getTotalPublishes());
  Assert.assertEquals(2000,stats.getTotalReceivedMessages());
}

{
  Config config=new Config();
  final String name="default";
  final CountDownLatch latch=new CountDownLatch(1);
  config.getTopicConfig(name).addMessageListenerConfig(new ListenerConfig().setImplementation(new MessageListener(){
    public void onMessage(    Message message){
      latch.countDown();
    }
  }
));
  final TestHazelcastInstanceFactory factory=createHazelcastInstanceFactory(1);
  final HazelcastInstance hz=factory.newHazelcastInstance(config);
  hz.getTopic(name).publish(1);
  assertTrue(latch.await(10,TimeUnit.SECONDS));
}

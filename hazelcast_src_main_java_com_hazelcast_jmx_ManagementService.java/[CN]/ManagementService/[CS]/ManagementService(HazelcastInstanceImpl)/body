{
  this.instance=instance;
  logger=instance.getLoggingService().getLogger(getClass());
  this.enabled=instance.node.groupProperties.ENABLE_JMX.getBoolean();
  if (enabled) {
    logger.log(Level.INFO,"Hazelcast JMX agent enabled.");
    MBeanServer mbs=ManagementFactory.getPlatformMBeanServer();
    try {
      InstanceMBean instanceMBean=new InstanceMBean(instance,this);
      mbs.registerMBean(instanceMBean,instanceMBean.objectName);
    }
 catch (    Exception e) {
      logger.log(Level.WARNING,"Unable to start JMX service",e);
    }
    registrationId=instance.addDistributedObjectListener(this);
    for (    final DistributedObject distributedObject : instance.getDistributedObjects()) {
      registerDistributedObject(distributedObject);
    }
  }
 else {
    registrationId=null;
  }
}

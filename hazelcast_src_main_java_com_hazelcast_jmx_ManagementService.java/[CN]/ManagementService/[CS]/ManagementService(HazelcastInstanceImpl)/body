{
  this.instance=instance;
  this.logger=instance.getLoggingService().getLogger(getClass());
  this.enabled=instance.node.groupProperties.ENABLE_JMX.getBoolean();
  if (!enabled) {
    this.registrationId=null;
    return;
  }
  logger.info("Hazelcast JMX agent enabled.");
  MBeanServer mbs=ManagementFactory.getPlatformMBeanServer();
  try {
    InstanceMBean instanceMBean=new InstanceMBean(instance,this);
    mbs.registerMBean(instanceMBean,instanceMBean.objectName);
  }
 catch (  Exception e) {
    logger.warning("Unable to start JMX service",e);
  }
  this.registrationId=null;
  instance.addDistributedObjectListener(this);
  for (  final DistributedObject distributedObject : instance.getDistributedObjects()) {
    registerDistributedObject(distributedObject);
  }
}

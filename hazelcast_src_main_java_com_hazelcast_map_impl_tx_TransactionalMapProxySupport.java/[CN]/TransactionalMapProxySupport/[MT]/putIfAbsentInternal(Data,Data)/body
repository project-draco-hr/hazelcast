{
  VersionedValue versionedValue=lockAndGet(key,tx.getTimeoutMillis());
  if (versionedValue.value != null) {
    addUnlockTransactionLog(key,versionedValue.version);
    return versionedValue.value;
  }
  final TxnSetOperation op=new TxnSetOperation(name,key,value,versionedValue.version);
  tx.addTransactionLog(new MapTransactionLog(name,key,op,versionedValue.version,tx.getOwnerUuid()));
  return versionedValue.value;
}

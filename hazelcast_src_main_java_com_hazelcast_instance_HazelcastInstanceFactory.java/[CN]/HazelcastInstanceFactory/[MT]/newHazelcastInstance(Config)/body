{
  if (config == null) {
    config=new XmlConfigBuilder().build();
  }
  String name=config.getInstanceName();
  if (name == null || name.trim().length() == 0) {
    name=createInstanceName(config);
    return newHazelcastInstance(config,name,new DefaultNodeContext());
  }
 else {
synchronized (INIT_LOCK) {
      if (INSTANCE_MAP.containsKey(name)) {
        throw new DuplicateInstanceNameException("HazelcastInstance with name '" + name + "' already exists!");
      }
      factoryIdGen.incrementAndGet();
      return newHazelcastInstance(config,name,new DefaultNodeContext());
    }
  }
}

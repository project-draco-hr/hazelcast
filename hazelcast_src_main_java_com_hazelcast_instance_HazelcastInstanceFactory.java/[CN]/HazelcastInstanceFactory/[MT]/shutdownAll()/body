{
  final List<HazelcastInstanceProxy> instances=new LinkedList<HazelcastInstanceProxy>();
  for (  InstanceFuture f : instanceMap.values()) {
    instances.add(f.get());
  }
  instanceMap.clear();
  OutOfMemoryErrorDispatcher.clear();
  ManagementService.shutdownAll();
  Collections.sort(instances,new Comparator<HazelcastInstanceProxy>(){
    public int compare(    HazelcastInstanceProxy o1,    HazelcastInstanceProxy o2){
      return o1.getName().compareTo(o2.getName());
    }
  }
);
  for (  HazelcastInstanceProxy proxy : instances) {
    proxy.getLifecycleService().shutdown();
    proxy.original=null;
  }
}

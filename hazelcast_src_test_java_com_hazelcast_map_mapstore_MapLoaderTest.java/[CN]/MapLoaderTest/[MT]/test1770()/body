{
  Config config=new Config();
  config.setProperty(GroupProperties.PROP_PARTITION_COUNT,"1");
  config.getManagementCenterConfig().setEnabled(true);
  config.getManagementCenterConfig().setUrl("http://manage.hazelcast.com/mancenter-3.2-SNAPSHOT");
  MapConfig mapConfig=new MapConfig("foo");
  final AtomicBoolean loadAllCalled=new AtomicBoolean();
  MapLoader mapLoader=new MapLoader(){
    @Override public Object load(    Object key){
      return null;
    }
    @Override public Map loadAll(    Collection keys){
      loadAllCalled.set(true);
      return new HashMap();
    }
    @Override public Set loadAllKeys(){
      return new HashSet(Arrays.asList(1));
    }
  }
;
  MapStoreConfig mapStoreConfig=new MapStoreConfig();
  mapStoreConfig.setEnabled(true);
  mapStoreConfig.setImplementation(mapLoader);
  mapConfig.setMapStoreConfig(mapStoreConfig);
  config.addMapConfig(mapConfig);
  HazelcastInstance hz=Hazelcast.newHazelcastInstance(config);
  Map map=hz.getMap(mapConfig.getName());
  assertTrueAllTheTime(new AssertTask(){
    @Override public void run(){
      assertFalse("LoadAll should not have been called",loadAllCalled.get());
    }
  }
,10);
}

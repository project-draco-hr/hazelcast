{
  ByteBuffer bbPass=ByteBuffer.allocate(32);
  MessageDigest md=MessageDigest.getInstance("MD5");
  bbPass.put(md.digest(stringToBytes(passPhrase)));
  md.reset();
  byte[] saltDigest=md.digest(salt);
  bbPass.put(saltDigest);
  if (keyBytes == null) {
    keyBytes=bbPass.array();
  }
  return saltDigest;
}

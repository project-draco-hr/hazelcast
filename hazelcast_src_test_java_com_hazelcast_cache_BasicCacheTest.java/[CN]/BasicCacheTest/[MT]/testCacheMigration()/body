{
  HazelcastServerCachingProvider hcp=new HazelcastServerCachingProvider();
  HazelcastServerCacheManager cacheManager=new HazelcastServerCacheManager(hcp,hz,hcp.getDefaultURI(),hcp.getDefaultClassLoader(),null);
  CacheConfig<Integer,String> config=new CacheConfig<Integer,String>();
  config.setName("SimpleCache");
  config.setInMemoryFormat(InMemoryFormat.OBJECT);
  Cache<Integer,String> simpleCache=cacheManager.createCache("simpleCache",config);
  Cache<Integer,String> cache=cacheManager.getCache("simpleCache");
  for (int i=0; i < 100; i++) {
    cache.put(i,"value" + i);
  }
  hz2.shutdown();
  for (int i=0; i < 100; i++) {
    String val=cache.get(i);
    assertEquals(val,"value" + i);
  }
}

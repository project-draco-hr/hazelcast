{
  if (reference instanceof TestServiceReference) {
synchronized (MUTEX) {
      boolean removed=false;
      for (      Map.Entry<String,List<ServiceReference>> entry : serviceReferenceMap.entrySet()) {
        List<ServiceReference> serviceReferences=entry.getValue();
        removed=removed || serviceReferences.remove(reference);
      }
      return removed;
    }
  }
 else {
    throw new IllegalArgumentException("Only `TestServiceReference` instances are supported!");
  }
}

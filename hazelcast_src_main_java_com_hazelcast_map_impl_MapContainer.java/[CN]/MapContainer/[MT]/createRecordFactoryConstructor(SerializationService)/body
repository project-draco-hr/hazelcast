{
  return new ConstructorFunction<Void,RecordFactory>(){
    @Override public RecordFactory createNew(    Void notUsedArg){
      RecordFactory recordFactory;
switch (mapConfig.getInMemoryFormat()) {
case BINARY:
        recordFactory=new DataRecordFactory(mapConfig,serializationService,partitioningStrategy);
      break;
case OBJECT:
    recordFactory=new ObjectRecordFactory(mapConfig,serializationService);
  break;
case NATIVE:
throw new IllegalArgumentException("Native storage format is supported in Hazelcast Enterprise only. " + "Make sure you have Hazelcast Enterprise JARs on your classpath!");
default :
throw new IllegalArgumentException("Invalid storage format: " + mapConfig.getInMemoryFormat());
}
return recordFactory;
}
}
;
}

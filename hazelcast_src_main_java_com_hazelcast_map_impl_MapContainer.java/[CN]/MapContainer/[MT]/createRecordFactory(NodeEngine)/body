{
  RecordFactory recordFactory;
switch (mapConfig.getInMemoryFormat()) {
case BINARY:
    recordFactory=new DataRecordFactory(mapConfig,nodeEngine.getSerializationService(),partitioningStrategy);
  break;
case OBJECT:
recordFactory=new ObjectRecordFactory(mapConfig,nodeEngine.getSerializationService());
break;
case NATIVE:
recordFactory=new NativeRecordFactory(mapConfig,nodeEngine.getOffHeapStorage(),nodeEngine.getSerializationService(),partitioningStrategy);
break;
default :
throw new IllegalArgumentException("Invalid storage format: " + mapConfig.getInMemoryFormat());
}
return recordFactory;
}

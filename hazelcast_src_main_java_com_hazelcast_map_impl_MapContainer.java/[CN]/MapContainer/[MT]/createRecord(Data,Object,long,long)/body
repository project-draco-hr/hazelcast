{
  Record record=getRecordFactory().newRecord(key,value);
  record.setLastAccessTime(now);
  record.setLastUpdateTime(now);
  record.setCreationTime(now);
  final long ttlMillisFromConfig=getTtlMillisFromConfig();
  final long ttl=pickTTL(ttlMillis,ttlMillisFromConfig);
  record.setTtl(ttl);
  final long maxIdleMillis=getMaxIdleMillis();
  setExpirationTime(record,maxIdleMillis);
  return record;
}

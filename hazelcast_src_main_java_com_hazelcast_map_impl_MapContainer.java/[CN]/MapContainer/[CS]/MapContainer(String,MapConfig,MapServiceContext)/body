{
  this.name=name;
  this.mapConfig=mapConfig;
  this.mapServiceContext=mapServiceContext;
  NodeEngine nodeEngine=mapServiceContext.getNodeEngine();
  this.partitioningStrategy=createPartitioningStrategy();
  this.quorumName=mapConfig.getQuorumName();
  this.serializationService=nodeEngine.getSerializationService();
  this.recordFactoryConstructor=createRecordFactoryConstructor(serializationService);
  this.queryEntryFactory=new QueryEntryFactory(mapConfig.isOptimizeQueries());
  initWanReplication(nodeEngine);
  this.interceptors=new CopyOnWriteArrayList<MapInterceptor>();
  this.interceptorMap=new ConcurrentHashMap<String,MapInterceptor>();
  this.nearCacheSizeEstimator=createNearCacheSizeEstimator(mapConfig.getNearCacheConfig());
  this.mapStoreContext=createMapStoreContext(this);
  this.mapStoreContext.start();
  this.extractors=new Extractors(mapConfig.getMapAttributeConfigs());
  this.indexes=new Indexes(serializationService,extractors);
  this.evictor=createEvictor(mapServiceContext);
  this.serverNearCacheInvalidationEnabled=isNearCacheEnabled() && mapConfig.getNearCacheConfig().isInvalidateOnChange();
}

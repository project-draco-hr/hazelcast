{
  this.name=name;
  this.mapConfig=mapConfig;
  this.mapServiceContext=mapServiceContext;
  this.partitioningStrategy=createPartitioningStrategy();
  this.quorumName=mapConfig.getQuorumName();
  this.queryEntryFactory=new QueryEntryFactory(mapConfig.isOptimizeQueries());
  final NodeEngine nodeEngine=mapServiceContext.getNodeEngine();
  this.serializationService=nodeEngine.getSerializationService();
  recordFactory=createRecordFactory(nodeEngine);
  initWanReplication(nodeEngine);
  interceptors=new CopyOnWriteArrayList<MapInterceptor>();
  interceptorMap=new ConcurrentHashMap<String,MapInterceptor>();
  nearCacheSizeEstimator=new NearCacheSizeEstimator();
  mapStoreContext=createMapStoreContext(this);
  mapStoreContext.start();
  indexes=new Indexes(serializationService);
  this.evictor=createEvictor(mapServiceContext);
}

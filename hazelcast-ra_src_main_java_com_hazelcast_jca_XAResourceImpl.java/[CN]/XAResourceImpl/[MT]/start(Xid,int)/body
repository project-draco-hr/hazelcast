{
  managedConnection.log(Level.FINEST,"XA start: " + xid);
  validateXID(xid);
switch (flags) {
case TMNOFLAGS:
    if (getTransaction(xid) != null) {
      throw new XAException(XAException.XAER_DUPID);
    }
  final TransactionContext transactionContext=HazelcastTransactionImpl.createTransaction(this.getTransactionTimeout(),managedConnection.getHazelcastInstance());
this.managedConnection.getTx().setTxContext(transactionContext);
final Transaction tx=TransactionAccessor.getTransaction(transactionContext);
try {
tx.begin();
putTransaction(xid,tx);
}
 catch (IllegalStateException e) {
throw new XAException(XAException.XAER_INVAL);
}
break;
case TMRESUME:
case TMJOIN:
validateXID(xid);
break;
default :
throw new XAException(XAException.XAER_INVAL);
}
}

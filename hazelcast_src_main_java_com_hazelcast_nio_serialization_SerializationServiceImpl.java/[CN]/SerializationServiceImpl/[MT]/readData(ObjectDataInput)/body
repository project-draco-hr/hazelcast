{
  try {
    boolean isNull=in.readBoolean();
    if (isNull) {
      return null;
    }
    int typeId=in.readInt();
    int partitionHash=in.readInt();
    byte[] header=readPortableHeader(in);
    int dataSize=in.readInt();
    byte[] data=null;
    if (dataSize > 0) {
      data=new byte[dataSize];
      in.readFully(data);
    }
    return new HeapData(typeId,data,partitionHash,header);
  }
 catch (  Throwable e) {
    throw handleException(e);
  }
}

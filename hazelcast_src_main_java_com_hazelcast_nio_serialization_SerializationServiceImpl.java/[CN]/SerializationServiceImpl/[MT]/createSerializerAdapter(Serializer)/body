{
  final SerializerAdapter s;
  if (serializer instanceof StreamSerializer) {
    s=new StreamSerializerAdapter(this,(StreamSerializer)serializer);
  }
 else   if (serializer instanceof PlainSerializer) {
    s=new PlainSerializerAdapter((PlainSerializer)serializer);
  }
 else {
    throw new IllegalArgumentException("Serializer must be instance of either StreamSerializer or PlainSerializer!");
  }
  return s;
}

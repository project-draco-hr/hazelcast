{
  this.inputOutputFactory=inputOutputFactory;
  this.classLoader=classLoader;
  this.managedContext=managedContext;
  this.globalPartitioningStrategy=partitionStrategy;
  this.outputBufferSize=initialOutputBufferSize;
  dataOutputQueue=new ThreadLocalOutputCache(this);
  PortableHookLoader loader=new PortableHookLoader(portableFactories,classLoader);
  portableContext=new PortableContextImpl(this,version);
  for (  ClassDefinition cd : loader.getDefinitions()) {
    portableContext.registerClassDefinition(cd);
  }
  dataSerializerAdapter=new StreamSerializerAdapter(this,new DataSerializer(dataSerializableFactories,classLoader));
  portableSerializer=new PortableSerializer(portableContext,loader.getFactories());
  portableSerializerAdapter=new StreamSerializerAdapter(this,portableSerializer);
  registerConstantSerializers();
  registerJvmTypeSerializers(enableCompression,enableSharedObject);
  registerClassDefinitions(classDefinitions,checkClassDefErrors);
}

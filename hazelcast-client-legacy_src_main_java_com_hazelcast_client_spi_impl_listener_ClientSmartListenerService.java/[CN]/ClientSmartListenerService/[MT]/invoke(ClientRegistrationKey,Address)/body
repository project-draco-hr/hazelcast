{
  BaseClientAddListenerRequest addRequest=registrationKey.getAddRequest();
  BaseClientRemoveListenerRequest removeRequest=registrationKey.getRemoveRequest();
  EventHandler handler=registrationKey.getHandler();
  handler.beforeListenerRegister();
  ClientInvocation invocation=new ClientInvocation(client,handler,addRequest,address);
  ClientInvocationFuture future=invocation.invoke();
  String serverRegistrationId=serializationService.toObject(future.get());
  handler.onListenerRegister();
  long callId=invocation.getRequest().getCallId();
  ClientEventRegistration registration=new ClientEventRegistration(serverRegistrationId,callId,address,removeRequest);
  Map<Address,ClientEventRegistration> registrationMap=registrations.get(registrationKey);
  registrationMap.put(address,registration);
}

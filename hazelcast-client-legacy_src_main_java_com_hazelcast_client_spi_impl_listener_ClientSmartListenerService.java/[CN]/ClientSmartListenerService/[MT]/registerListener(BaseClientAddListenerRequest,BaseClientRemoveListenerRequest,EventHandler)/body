{
  addRequest.setLocalOnly();
  String userRegistrationId=UuidUtil.newUnsecureUuidString();
synchronized (listenerRegLock) {
    ClientRegistrationKey registrationKey=new ClientRegistrationKey(userRegistrationId,addRequest,removeRequest,handler);
    registrations.put(registrationKey,new ConcurrentHashMap<Address,ClientEventRegistration>());
    try {
      for (      Member member : this.members) {
        invoke(registrationKey,member.getAddress());
      }
    }
 catch (    Exception e) {
      deregisterListener(userRegistrationId);
      throw new HazelcastException("Listener can not be added",e);
    }
    return userRegistrationId;
  }
}

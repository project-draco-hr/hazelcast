{
  ioBalancer.stop();
  if (logger.isFinestEnabled()) {
    logger.finest("Shutting down IO selectors... Total: " + (inputThreads.length + outputThreads.length));
  }
  for (int i=0; i < inputThreads.length; i++) {
    NonBlockingIOThread ioThread=inputThreads[i];
    if (ioThread != null) {
      ioThread.shutdown();
    }
    inputThreads[i]=null;
  }
  for (int i=0; i < outputThreads.length; i++) {
    NonBlockingIOThread ioThread=outputThreads[i];
    if (ioThread != null) {
      ioThread.shutdown();
    }
    outputThreads[i]=null;
  }
}

{
  NodeEngine nodeEngine=getNodeEngine();
  XAService xaService=getService();
  OperationService operationService=nodeEngine.getOperationService();
  ClusterService clusterService=nodeEngine.getClusterService();
  Collection<MemberImpl> memberList=clusterService.getMemberList();
  List<InternalCompletableFuture<SerializableList>> futureList=new ArrayList<InternalCompletableFuture<SerializableList>>();
  for (  MemberImpl member : memberList) {
    if (member.localMember()) {
      continue;
    }
    CollectRemoteTransactionsOperation op=new CollectRemoteTransactionsOperation();
    Address address=member.getAddress();
    InternalCompletableFuture<SerializableList> future=operationService.invokeOnTarget(SERVICE_NAME,op,address);
    futureList.add(future);
  }
  HashSet<SerializableXID> xids=new HashSet<SerializableXID>();
  xids.addAll(xaService.getPreparedXids());
  for (  InternalCompletableFuture<SerializableList> future : futureList) {
    SerializableList xidSet=future.getSafely();
    for (    Data xidData : xidSet) {
      SerializableXID xid=nodeEngine.toObject(xidData);
      xids.add(xid);
    }
  }
  return xids.toArray(new SerializableXID[xids.size()]);
}

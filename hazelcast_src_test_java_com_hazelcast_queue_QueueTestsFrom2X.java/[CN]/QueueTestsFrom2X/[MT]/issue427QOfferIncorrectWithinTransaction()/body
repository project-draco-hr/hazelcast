{
  Config config=new Config();
  config.getQueueConfig("default").setMaxSize(100);
  HazelcastInstance h=createHazelcastInstance(config);
  final TransactionContext transactionContext=h.newTransactionContext();
  transactionContext.beginTransaction();
  final TransactionalQueue q=transactionContext.getQueue("default");
  for (int i=0; i < 100; i++) {
    q.offer(i);
  }
  boolean result=q.offer(100);
  assertEquals(100,q.size());
  transactionContext.commitTransaction();
  assertEquals(100,h.getQueue("default").size());
  assertFalse(result);
  h.shutdown();
}

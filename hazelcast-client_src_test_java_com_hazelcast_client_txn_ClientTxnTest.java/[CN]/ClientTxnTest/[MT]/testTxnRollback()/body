{
  final String queueName="testTxnRollback";
  final TransactionContext context=hz.newTransactionContext();
  CountDownLatch latch=new CountDownLatch(1);
  try {
    context.beginTransaction();
    assertNotNull(context.getTxnId());
    final TransactionalQueue queue=context.getQueue(queueName);
    queue.offer("item");
    server.shutdown();
    context.commitTransaction();
    fail("commit should throw exception!!!");
  }
 catch (  TransactionException e) {
    context.rollbackTransaction();
    latch.countDown();
  }
  assertTrue(latch.await(10,TimeUnit.SECONDS));
  final IQueue<Object> q=hz.getQueue(queueName);
  assertNull(q.poll());
  assertEquals(0,q.size());
}

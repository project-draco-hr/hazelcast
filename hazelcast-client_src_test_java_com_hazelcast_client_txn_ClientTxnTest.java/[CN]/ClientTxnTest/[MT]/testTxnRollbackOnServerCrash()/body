{
  final String queueName="testTxnRollbackOnServerCrash";
  final TransactionContext context=hz.newTransactionContext();
  CountDownLatch latch=new CountDownLatch(1);
  context.beginTransaction();
  final TransactionalQueue queue=context.getQueue(queueName);
  String key=HazelcastTestSupport.generateKeyOwnedBy(server);
  queue.offer(key);
  server.getLifecycleService().terminate();
  try {
    context.commitTransaction();
    fail("commit should throw exception !");
  }
 catch (  TransactionException e) {
    context.rollbackTransaction();
    latch.countDown();
  }
  assertTrue(latch.await(10,TimeUnit.SECONDS));
  final IQueue<Object> q=hz.getQueue(queueName);
  assertNull(q.poll());
  assertEquals(0,q.size());
}

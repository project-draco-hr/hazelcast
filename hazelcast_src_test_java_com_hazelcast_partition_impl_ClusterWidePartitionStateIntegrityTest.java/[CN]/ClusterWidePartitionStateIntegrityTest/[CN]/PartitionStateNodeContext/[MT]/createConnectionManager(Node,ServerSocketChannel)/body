{
  final ConnectionManager connectionManager=super.createConnectionManager(node,serverSocketChannel);
  return new DelegatingConnectionManager(connectionManager){
    final PacketFilter filter=new PartitionStatePacketFilter(node.getSerializationService(),blockedAddresses);
    @Override public boolean transmit(    Packet packet,    Connection connection){
      return connection != null && filter.allow(packet,connection.getEndPoint()) && super.transmit(packet,connection);
    }
    @Override public boolean transmit(    Packet packet,    Address target){
      return filter.allow(packet,target) && super.transmit(packet,target);
    }
  }
;
}

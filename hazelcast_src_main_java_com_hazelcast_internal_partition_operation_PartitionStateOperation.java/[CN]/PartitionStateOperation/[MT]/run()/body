{
  Address callerAddress=getCallerAddress();
  partitionState.setEndpoint(callerAddress);
  InternalPartitionServiceImpl partitionService=getService();
  returnValue=partitionService.processPartitionRuntimeState(partitionState);
  ILogger logger=getLogger();
  if (logger.isFineEnabled()) {
    logger.fine("Applied new partition state: " + returnValue + ". Version: "+ partitionState.getVersion()+ ", caller: "+ callerAddress);
  }
  if (returnValue) {
    NodeEngineImpl nodeEngine=(NodeEngineImpl)getNodeEngine();
    if (!nodeEngine.isRunning()) {
      if (logger.isFinestEnabled()) {
        logger.finest("Sending shutdown request to master: " + callerAddress + " again");
      }
      nodeEngine.getOperationService().send(new ShutdownRequestOperation(),callerAddress);
    }
  }
}

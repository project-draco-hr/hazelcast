{
  Config config=new Config();
  final HazelcastInstance h1=Hazelcast.newHazelcastInstance(config);
  final HazelcastInstance h2=Hazelcast.newHazelcastInstance(config);
  CallBuilder calls=new QueueCallBuilder(h2);
  final Node node2=getNode(h2);
  BeforeAfterBehavior behavior=new BeforeAfterBehavior(){
    public void before() throws Exception {
      node2.clusterManager.enqueueAndWait(new Processable(){
        public void process(){
          node2.clusterManager.removeMember((MemberImpl)h1.getCluster().getLocalMember());
          assertEquals(1,node2.clusterManager.lsMembers.size());
        }
      }
,5);
    }
    public void after(){
      node2.clusterManager.enqueueAndWait(new Processable(){
        public void process(){
          MemberImpl secondMember=new MemberImpl(((MemberImpl)h1.getCluster().getLocalMember()).getAddress(),false);
          node2.clusterManager.addMember(secondMember);
          assertEquals(2,node2.clusterManager.lsMembers.size());
        }
      }
,5);
    }
    public void destroy(){
    }
  }
;
  BeforeAfterTester t=new BeforeAfterTester(behavior,calls);
  t.run();
}

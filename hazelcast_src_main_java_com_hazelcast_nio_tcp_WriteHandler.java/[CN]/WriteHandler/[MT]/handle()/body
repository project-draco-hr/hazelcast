{
  eventCount++;
  lastWriteTime=Clock.currentTimeMillis();
  if (shutdown) {
    return;
  }
  if (socketWriter == null) {
    logger.log(Level.WARNING,"SocketWriter is not set, creating SocketWriter with CLUSTER protocol!");
    createWriter(Protocols.CLUSTER);
  }
  try {
    fillOutputBuffer();
    if (dirtyOutputBuffer()) {
      writeOutputBufferToSocket();
    }
  }
 catch (  Throwable t) {
    exceptionCount.inc();
    logger.severe("Fatal Error at WriteHandler for endPoint: " + connection.getEndPoint(),t);
  }
  if (newOwner == null) {
    unschedule();
  }
 else {
    IOSelector newOwner=this.newOwner;
    this.newOwner=null;
    startMigration(newOwner);
  }
}

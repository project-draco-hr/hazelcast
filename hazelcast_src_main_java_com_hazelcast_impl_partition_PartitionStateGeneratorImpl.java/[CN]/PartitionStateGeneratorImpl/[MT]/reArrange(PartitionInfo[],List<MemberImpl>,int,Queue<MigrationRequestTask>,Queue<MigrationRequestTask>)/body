{
  final LinkedList<NodeGroup> groups=createNodeGroups(memberGroupFactory.createMemberGroups(members));
  if (groups.size() == 0)   return currentState;
  PartitionInfo[] newState=arrange(groups,partitionCount,new CopyStateInitializer(currentState));
  finalizeArrangement(currentState,newState,Math.min(groups.size(),PartitionInfo.MAX_REPLICA_COUNT),scheduledQueue,immediateQueue);
  return newState;
}

{
  final PartitionInfo[] state=new PartitionInfo[partitionCount];
  stateInitializer.initialize(state);
  TestResult result=null;
  int tryCount=0;
  while (tryCount < MAX_RETRY_COUNT && result != TestResult.PASS) {
    boolean aggressive=tryCount >= AGGRESSIVE_RETRY_THRESHOLD;
    tryArrange(state,groups,partitionCount,aggressive);
    result=testArrangement(state,groups,partitionCount);
    if (result == TestResult.FAIL) {
      logger.log(Level.WARNING,"Error detected on partition arrangement! Try-count: " + tryCount);
      stateInitializer.initialize(state);
    }
 else     if (result == TestResult.RETRY) {
      tryCount++;
      logger.log(Level.WARNING,"Re-trying partition arrangement.. Count: " + tryCount);
    }
  }
  if (result == TestResult.FAIL) {
    logger.log(Level.SEVERE,"Failed to arrange partitions !!!");
  }
  return state;
}

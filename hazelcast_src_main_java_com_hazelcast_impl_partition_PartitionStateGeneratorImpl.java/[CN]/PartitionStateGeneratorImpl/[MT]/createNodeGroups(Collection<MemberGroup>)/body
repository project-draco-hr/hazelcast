{
  LinkedList<NodeGroup> nodeGroups=new LinkedList<NodeGroup>();
  for (  MemberGroup memberGroup : memberGroups) {
    final NodeGroup nodeGroup;
    if (memberGroup.size() == 0) {
      continue;
    }
    if (memberGroup instanceof SingleMemberGroup || memberGroup.size() == 1) {
      nodeGroup=new SingleNodeGroup();
      nodeGroup.addNode(memberGroup.iterator().next().getAddress());
    }
 else {
      nodeGroup=new DefaultNodeGroup();
      Iterator<MemberImpl> iter=memberGroup.iterator();
      while (iter.hasNext()) {
        nodeGroup.addNode(iter.next().getAddress());
      }
    }
    nodeGroups.add(nodeGroup);
  }
  return nodeGroups;
}

{
  if (partitionId >= 0) {
    return partitionExecutors[partitionId % partitionThreadCount];
  }
 else   if (partitionId == NodeService.EXECUTOR_THREAD_ID) {
    return cachedExecutorService;
  }
 else   if (partitionId == NodeService.EVENT_THREAD_ID) {
    return eventExecutorService;
  }
 else {
    throw new IllegalArgumentException("Illegal partition/thread id: " + partitionId);
  }
}

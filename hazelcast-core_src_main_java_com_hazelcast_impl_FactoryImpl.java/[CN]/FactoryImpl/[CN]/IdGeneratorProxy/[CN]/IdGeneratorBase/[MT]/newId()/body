{
  long millionNow=million.get();
  long idAddition=currentId.incrementAndGet();
  if (idAddition >= MILLION) {
synchronized (this) {
      try {
        millionNow=million.get();
        idAddition=currentId.incrementAndGet();
        if (idAddition >= MILLION) {
          Long idMillion=getNewMillion();
          long newMillion=idMillion.longValue() * MILLION;
          million.set(newMillion);
          currentId.set(0);
        }
        millionNow=million.get();
        idAddition=currentId.incrementAndGet();
      }
 catch (      Throwable t) {
        t.printStackTrace();
      }
    }
  }
  long result=millionNow + idAddition;
  return result;
}

{
  if (partitionService.getPartitionStateManager().isInitialized()) {
    long delayMillis=0L;
    if (replicaIndex > 1) {
      delayMillis=(long)(InternalPartitionService.REPLICA_SYNC_RETRY_DELAY + (Math.random() * InternalPartitionService.DEFAULT_REPLICA_SYNC_DELAY));
    }
    resetReplicaVersion(partitionId,replicaIndex,reason,initialAssignment);
    partitionService.getReplicaManager().triggerPartitionReplicaSync(partitionId,replicaIndex,delayMillis);
  }
}

{
  HazelcastInstance hz=createHazelcastInstance();
  ReliableTopicProxy topic=(ReliableTopicProxy)hz.getReliableTopic("topic");
  final MessageListenerMock listener=new MessageListenerMock();
  String id=topic.addMessageListener(listener);
  ReliableMessageListenerRunner runner=(ReliableMessageListenerRunner)topic.runnersMap.get(id);
  assertNotNull(runner);
  ReliableMessageListenerAdapter adapter=assertInstanceOf(ReliableMessageListenerAdapter.class,runner.listener);
  assertSame(listener,adapter.messageListener);
}

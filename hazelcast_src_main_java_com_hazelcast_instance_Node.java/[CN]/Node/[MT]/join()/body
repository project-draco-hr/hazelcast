{
  if (joiner == null) {
    logger.warning("No join method is enabled! Starting standalone.");
    setAsMaster();
    return;
  }
  final long maxJoinMillis=getGroupProperties().MAX_JOIN_SECONDS.getInteger() * 1000;
  int rejoinCount=0;
  for (; ; ) {
    final long joinStartTime=joiner.getStartTime();
    try {
      joiner.join(joined);
      return;
    }
 catch (    Exception e) {
      rejoinCount++;
      if (Clock.currentTimeMillis() - joinStartTime < maxJoinMillis) {
        logger.warning("Trying to rejoin for the " + rejoinCount + " time: "+ e.getMessage());
        prepareForRejoin();
      }
 else {
        logger.severe("Could not join cluster after " + rejoinCount + " attempts, shutting down!",e);
        shutdown(true);
        return;
      }
    }
  }
}

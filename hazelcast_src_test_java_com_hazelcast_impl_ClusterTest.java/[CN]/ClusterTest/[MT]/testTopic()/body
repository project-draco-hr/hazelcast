{
  HazelcastInstance h1=Hazelcast.newHazelcastInstance(new Config());
  HazelcastInstance h2=Hazelcast.newHazelcastInstance(new Config());
  String topicName="TestMessages";
  ITopic<String> topic1=h1.getTopic(topicName);
  final CountDownLatch latch1=new CountDownLatch(1);
  topic1.addMessageListener(new MessageListener<String>(){
    public void onMessage(    Message msg){
      assertEquals("Test1",msg.getMessageObject());
      latch1.countDown();
    }
  }
);
  ITopic<String> topic2=h2.getTopic(topicName);
  final CountDownLatch latch2=new CountDownLatch(2);
  topic2.addMessageListener(new MessageListener<String>(){
    public void onMessage(    Message msg){
      assertEquals("Test1",msg.getMessageObject());
      latch2.countDown();
    }
  }
);
  topic1.publish("Test1");
  h1.shutdown();
  topic2.publish("Test1");
  try {
    assertTrue(latch1.await(5,TimeUnit.SECONDS));
    assertTrue(latch2.await(5,TimeUnit.SECONDS));
  }
 catch (  InterruptedException ignored) {
  }
}

{
  final HazelcastInstance h1=Hazelcast.newHazelcastInstance(new Config());
  final IMap map=h1.getMap("default");
  Config c1=new Config();
  c1.getGroupConfig().setName("differentGroup");
  final HazelcastInstance h2=Hazelcast.newHazelcastInstance(c1);
  final IQueue q=h2.getQueue("abc");
  q.offer("item1");
  q.offer("item2");
  Transaction t=h2.getTransaction();
  t.begin();
  Object o=q.take();
  junit.framework.Assert.assertEquals("item1",o);
  map.put("1","value");
  t.commit();
  final CountDownLatch l=new CountDownLatch(1);
  new Thread(new Runnable(){
    public void run(){
      Transaction t=h2.getTransaction();
      t.begin();
      try {
        Object o=q.take();
        junit.framework.Assert.assertEquals("item2",o);
        map.put("1","value2");
        t.commit();
      }
 catch (      Exception e) {
        e.printStackTrace();
        Assert.fail(e.getMessage());
      }
      l.countDown();
    }
  }
).start();
  assertTrue(l.await(5,TimeUnit.SECONDS));
  junit.framework.Assert.assertEquals(1,map.size());
  junit.framework.Assert.assertEquals("value2",map.get("1"));
}

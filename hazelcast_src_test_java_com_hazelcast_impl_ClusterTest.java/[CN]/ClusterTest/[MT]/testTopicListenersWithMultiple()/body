{
  final CountDownLatch latch=new CountDownLatch(3);
  final MessageListener<Object> ml=new MessageListener<Object>(){
    public void onMessage(    Message msg){
      assertEquals("message1",msg.getMessageObject());
      latch.countDown();
    }
  }
;
  HazelcastInstance h1=Hazelcast.newHazelcastInstance(null);
  h1.getTopic("default").addMessageListener(ml);
  HazelcastInstance h2=Hazelcast.newHazelcastInstance(null);
  h2.getTopic("default").addMessageListener(ml);
  HazelcastInstance h3=Hazelcast.newHazelcastInstance(null);
  h3.getTopic("default").addMessageListener(ml);
  HazelcastInstance h4=Hazelcast.newHazelcastInstance(null);
  h4.getTopic("default").publish("message1");
  assertTrue(latch.await(5,TimeUnit.SECONDS));
}

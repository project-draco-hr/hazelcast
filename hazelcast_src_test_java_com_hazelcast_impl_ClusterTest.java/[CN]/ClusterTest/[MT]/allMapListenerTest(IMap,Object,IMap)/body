{
  final CountDownLatch latchAdded=new CountDownLatch(2);
  final CountDownLatch latchUpdated=new CountDownLatch(1);
  final CountDownLatch latchRemoved=new CountDownLatch(1);
  final CountDownLatch latchEvicted=new CountDownLatch(1);
  EntryListener listener=new EntryListener(){
    public void entryAdded(    EntryEvent entryEvent){
      latchAdded.countDown();
    }
    public void entryRemoved(    EntryEvent entryEvent){
      latchRemoved.countDown();
    }
    public void entryUpdated(    EntryEvent entryEvent){
      latchUpdated.countDown();
    }
    public void entryEvicted(    EntryEvent entryEvent){
      latchEvicted.countDown();
    }
  }
;
  map.addEntryListener(listener,true);
  assertNull(mapSource.put(keyToUpdate,"value5"));
  assertEquals("value5",mapSource.put(keyToUpdate,"value55"));
  assertTrue(mapSource.evict(keyToUpdate));
  assertNull(mapSource.put(keyToUpdate,"value5"));
  assertEquals("value5",mapSource.remove(keyToUpdate));
  int waitSeconds=20;
  assertTrue(latchAdded.await(waitSeconds,TimeUnit.SECONDS));
  assertTrue(latchUpdated.await(waitSeconds,TimeUnit.SECONDS));
  assertTrue(latchRemoved.await(waitSeconds,TimeUnit.SECONDS));
  assertTrue(latchEvicted.await(waitSeconds,TimeUnit.SECONDS));
  map.removeEntryListener(listener);
}

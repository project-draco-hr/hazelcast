{
  HazelcastInstance h1=Hazelcast.newHazelcastInstance(null);
  HazelcastInstance h2=Hazelcast.newHazelcastInstance(null);
  Queue<String> q1=h1.getQueue("q");
  Queue<String> q2=h2.getQueue("q");
  for (int i=0; i < 5; i++) {
    q1.offer("item" + i);
  }
  assertEquals(5,q1.size());
  assertEquals(5,q2.size());
  assertEquals("item0",q1.poll());
  assertEquals("item1",q1.poll());
  assertEquals("item2",q1.poll());
  Thread.sleep(10000);
  assertEquals(2,q1.size());
  assertEquals(2,q2.size());
  h1.shutdown();
  Thread.sleep(5000);
  assertEquals(2,q2.size());
}

{
  final CountDownLatch latch=new CountDownLatch(4);
  final MessageListener<Object> ml=new MessageListener<Object>(){
    public void onMessage(    Object msg){
      assertEquals("message2",msg);
      latch.countDown();
    }
  }
;
  HazelcastInstance h1=Hazelcast.newHazelcastInstance(null);
  h1.getTopic("default").addMessageListener(ml);
  HazelcastInstance h2=Hazelcast.newHazelcastInstance(null);
  h2.getTopic("default").addMessageListener(ml);
  HazelcastInstance h3=Hazelcast.newHazelcastInstance(null);
  h3.getTopic("default").addMessageListener(ml);
  HazelcastInstance h4=Hazelcast.newHazelcastInstance(null);
  h4.getTopic("default").addMessageListener(ml);
  h1.getTopic("default").publish("message2");
  assertTrue(latch.await(10,TimeUnit.SECONDS));
}

{
  StaticNodeFactory factory=new StaticNodeFactory(2);
  final Config config=new Config();
  config.setProperty(GroupProperties.PROP_GRACEFUL_SHUTDOWN_MAX_WAIT,"1");
  HazelcastInstance hz1=factory.newInstance(config);
  HazelcastInstance hz2=factory.newInstance(config);
  final ICountDownLatch latch=hz1.getCountDownLatch("test");
  latch.trySetCount(2);
  new Thread(){
    public void run(){
      try {
        sleep(100);
      }
 catch (      InterruptedException e) {
        return;
      }
      latch.destroy();
    }
  }
.start();
  try {
    hz2.getCountDownLatch("test").await(200,TimeUnit.MILLISECONDS);
  }
 catch (  MemberLeftException e) {
    e.printStackTrace();
    Assert.fail();
  }
catch (  InterruptedException e) {
    e.printStackTrace();
    Assert.fail();
  }
}

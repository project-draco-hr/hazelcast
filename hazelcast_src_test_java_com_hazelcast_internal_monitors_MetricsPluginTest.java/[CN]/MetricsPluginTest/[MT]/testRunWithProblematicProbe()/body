{
  metricsRegistry.register(this,"broken",MANDATORY,new LongProbeFunction(){
    @Override public long get(    Object source) throws Exception {
      throw new RuntimeException("error");
    }
  }
);
  plugin.run(logWriter);
  try {
    assertContains("broken=java.lang.RuntimeException:error");
  }
 catch (  Throwable t) {
    throw new Exception("existing probes:" + metricsRegistry.getNames(),t);
  }
}

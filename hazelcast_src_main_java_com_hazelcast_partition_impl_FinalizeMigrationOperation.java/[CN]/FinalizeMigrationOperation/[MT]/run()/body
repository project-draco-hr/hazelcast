{
  InternalPartitionServiceImpl partitionService=getService();
  int partitionId=getPartitionId();
  MigrationInfo migrationInfo=partitionService.getActiveMigration(partitionId);
  if (migrationInfo == null) {
    return;
  }
  NodeEngineImpl nodeEngine=(NodeEngineImpl)getNodeEngine();
  PartitionMigrationEvent event=new PartitionMigrationEvent(endpoint,partitionId);
  for (  MigrationAwareService service : nodeEngine.getServices(MigrationAwareService.class)) {
    finishMigration(event,service);
  }
  if (endpoint == MigrationEndpoint.SOURCE && success) {
    partitionService.clearPartitionReplicaVersionsExceptSyncWaitingReplicas(partitionId);
  }
 else   if (endpoint == MigrationEndpoint.DESTINATION && !success) {
    partitionService.clearPartitionReplicaVersionsExceptSyncWaitingReplicas(partitionId);
  }
  partitionService.removeActiveMigration(partitionId);
  if (success) {
    nodeEngine.onPartitionMigrate(migrationInfo);
  }
}

{
  instance.shutdown();
  instance2.shutdown();
  assertClusterSizeEventually(2,lite);
  assertClusterSizeEventually(2,lite2);
  ICompletableFuture<Map<String,List<Integer>>> future=com.hazelcast.mapreduce.MapReduceLiteMemberTest.testMapReduceJobSubmissionWithNoDataNode(client);
  try {
    future.get(30,TimeUnit.SECONDS);
    fail("Map-reduce job should not be submitted when there is no data member");
  }
 catch (  ExecutionException e) {
    System.out.println(e.getCause());
    assertTrue(e.getCause() instanceof IllegalStateException);
  }
}

{
  try {
    while (!thread.isInterrupted()) {
      Runnable r;
      while (migrationActive.get() && (r=migrationQueue.poll(1,TimeUnit.SECONDS)) != null) {
        safeRun(r);
        if (partitionMigrationInterval > 0) {
          Thread.sleep(partitionMigrationInterval);
        }
      }
      final boolean hasNoTasks=migrationQueue.isEmpty();
      if (!migrationActive.get() || hasNoTasks) {
        if (hasNoTasks && migrating) {
          migrating=false;
          logger.log(Level.INFO,"All migration tasks has been completed, queues are empty.");
        }
        evictCompletedMigrations();
      }
    }
  }
 catch (  InterruptedException e) {
    logger.log(Level.WARNING,"MigrationManagerThread is interrupted: " + e.getMessage());
  }
 finally {
    clearMigrationQueue();
  }
}

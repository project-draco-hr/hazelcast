{
  if (initialized) {
    MemberGroupFactory mgf=memberGroupFactory;
    final Collection<MemberGroup> memberGroups=mgf.createMemberGroups(node.getClusterService().getMembers());
    if (memberGroups.size() < 2)     return false;
    int groups=0;
    for (    MemberGroup memberGroup : memberGroups) {
      if (memberGroup.size() > 0) {
        groups++;
      }
    }
    if (groups < 2)     return false;
    final int activeSize=activeMigrations.size();
    if (activeSize != 0) {
      if (logger.isLoggable(level)) {
        logger.log(level,"Waiting for active migration tasks: " + activeSize);
      }
      return true;
    }
    final int queueSize=migrationQueue.size();
    if (queueSize == 0) {
      for (      PartitionImpl partition : partitions) {
        if (partition.getReplicaAddress(1) == null) {
          if (logger.isLoggable(level)) {
            logger.log(level,"Should take backup of partition: " + partition.getPartitionId());
          }
          return true;
        }
 else {
          final int replicaSyncProcesses=replicaSyncProcessCount.get();
          if (replicaSyncProcesses > 0) {
            if (logger.isLoggable(level)) {
              logger.log(level,"Processing replica sync requests: " + replicaSyncProcesses);
            }
            return true;
          }
        }
      }
    }
 else {
      if (logger.isLoggable(level)) {
        logger.log(level,"Waiting for cluster migration tasks: " + queueSize);
      }
      return true;
    }
  }
  return false;
}

{
  lock.lock();
  try {
    if (!initialized && !node.isMaster() && node.getMasterAddress() != null && node.joined()) {
      Future f=nodeEngine.getOperationService().createInvocationBuilder(SERVICE_NAME,new AssignPartitions(),node.getMasterAddress()).setTryCount(1).build().invoke();
      f.get(1,TimeUnit.SECONDS);
    }
  }
 catch (  Exception e) {
    logger.log(Level.FINEST,e.getMessage(),e);
  }
 finally {
    lock.unlock();
  }
}

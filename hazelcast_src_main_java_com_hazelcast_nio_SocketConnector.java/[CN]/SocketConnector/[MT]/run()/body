{
  if (!connectionManager.isLive()) {
    if (logger.isFinestEnabled()) {
      String message="ConnectionManager is not live, connection attempt to " + address + " is cancelled!";
      log(Level.FINEST,message);
    }
    return;
  }
  try {
    if (logger.isFinestEnabled()) {
      log(Level.FINEST,"Starting to connect to " + address);
    }
    final Address thisAddress=connectionManager.ioService.getThisAddress();
    if (address.isIPv4()) {
      tryToConnect(address.getInetSocketAddress(),0);
    }
 else     if (thisAddress.isIPv6() && thisAddress.getScopeId() != null) {
      final Inet6Address inetAddress=AddressUtil.getInetAddressFor((Inet6Address)address.getInetAddress(),thisAddress.getScopeId());
      tryToConnect(new InetSocketAddress(inetAddress,address.getPort()),0);
    }
 else {
      final Collection<Inet6Address> possibleInetAddresses=AddressUtil.getPossibleInetAddressesFor((Inet6Address)address.getInetAddress());
      final Level level=silent ? Level.FINEST : Level.INFO;
      if (logger.isLoggable(level)) {
        log(level,"Trying to connect possible IPv6 addresses: " + possibleInetAddresses);
      }
      boolean connected=false;
      Exception error=null;
      for (      Inet6Address inetAddress : possibleInetAddresses) {
        try {
          tryToConnect(new InetSocketAddress(inetAddress,address.getPort()),3000);
          connected=true;
          break;
        }
 catch (        Exception e) {
          error=e;
        }
      }
      if (!connected && error != null) {
        throw error;
      }
    }
  }
 catch (  Throwable e) {
    logger.finest(e);
    connectionManager.failedConnection(address,e,silent);
  }
}

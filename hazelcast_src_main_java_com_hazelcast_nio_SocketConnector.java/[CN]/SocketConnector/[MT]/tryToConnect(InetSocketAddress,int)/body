{
  final SocketChannel socketChannel=SocketChannel.open();
  connectionManager.initSocket(socketChannel.socket());
  bindSocket(socketChannel);
  final String message="Connecting to " + socketAddress + ", timeout: "+ timeout+ ", bind-any: "+ connectionManager.ioService.isSocketBindAny();
  final Level level=silent ? Level.FINEST : Level.INFO;
  log(level,message);
  try {
    socketChannel.configureBlocking(true);
    try {
      if (timeout > 0) {
        socketChannel.socket().connect(socketAddress,timeout);
      }
 else {
        socketChannel.connect(socketAddress);
      }
    }
 catch (    SocketException ex) {
      SocketException newEx=new SocketException(ex.getMessage() + " to address " + socketAddress);
      newEx.setStackTrace(ex.getStackTrace());
      throw newEx;
    }
    log(Level.FINEST,"Successfully connected to: " + address + " using socket "+ socketChannel.socket());
    final SocketChannelWrapper socketChannelWrapper=connectionManager.wrapSocketChannel(socketChannel,true);
    MemberSocketInterceptor memberSocketInterceptor=connectionManager.getMemberSocketInterceptor();
    if (memberSocketInterceptor != null) {
      log(Level.FINEST,"Calling member socket interceptor: " + memberSocketInterceptor + " for "+ socketChannel);
      memberSocketInterceptor.onConnect(socketChannel.socket());
    }
    socketChannelWrapper.configureBlocking(false);
    TcpIpConnection connection=connectionManager.assignSocketChannel(socketChannelWrapper);
    connection.getWriteHandler().setProtocol(Protocols.CLUSTER);
    connectionManager.sendBindRequest(connection,address,true);
  }
 catch (  Exception e) {
    closeSocket(socketChannel);
    log(level,"Could not connect to: " + socketAddress + ". Reason: "+ e.getClass().getSimpleName()+ "["+ e.getMessage()+ "]");
    throw e;
  }
}

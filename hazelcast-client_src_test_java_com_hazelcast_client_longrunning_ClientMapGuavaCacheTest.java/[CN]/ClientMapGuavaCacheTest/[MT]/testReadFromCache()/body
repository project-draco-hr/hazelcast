{
  System.setProperty("hazelcast.client.near.cache.enabled","true");
  Config config=new Config();
  NearCacheConfig nearCacheConfig=new NearCacheConfig();
  nearCacheConfig.setMaxSize(1000);
  nearCacheConfig.setMaxIdleSeconds(10);
  nearCacheConfig.setTimeToLiveSeconds(20);
  config.getMapConfig("default").setNearCacheConfig(nearCacheConfig);
  HazelcastInstance h=Hazelcast.newHazelcastInstance(config);
  String mapName="testReadFromCache";
  IMap<String,String> mapH=h.getMap(mapName);
  mapH.put("a","a");
  HazelcastClient client=HazelcastClient.newHazelcastClient(new ClientConfig());
  Map<Object,Object> mapC=client.getMap(mapName);
  assertEquals("a",mapC.get("a"));
  int hit=mapH.getMapEntry("a").getHits();
  mapC.get("a");
  assertEquals(mapH.getMapEntry("a").getHits(),hit);
  for (int i=0; i < 100; i++) {
    mapC.get("a");
  }
  assertEquals(mapH.getMapEntry("a").getHits(),hit);
}

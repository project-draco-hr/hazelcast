{
  if (ownerConnection) {
    final String uuid=getUuid();
    principal=new ClientPrincipal(uuid,clientEngine.getLocalMember().getUuid());
    reAuthLocal();
    Collection<Member> members=clientEngine.getClusterService().getMembers();
    for (    Member member : members) {
      if (!member.localMember()) {
        ClientReAuthOperation op=new ClientReAuthOperation(uuid);
        op.setCallerUuid(clientEngine.getLocalMember().getUuid());
        operationService.send(op,member.getAddress());
      }
    }
  }
  if (clientEngine.getClusterService().getMember(principal.getOwnerUuid()) == null) {
    return new AuthenticationException("Invalid owner-uuid: " + principal.getOwnerUuid() + ", it's not member of this cluster!");
  }
  Connection connection=endpoint.getConnection();
  ILogger logger=clientEngine.getLogger(getClass());
  logger.log(Level.INFO,"Received auth from " + connection + ", successfully authenticated"+ ", principal : "+ principal+ ", owner connection : "+ ownerConnection);
  endpoint.authenticated(principal,credentials,ownerConnection);
  clientEngine.getEndpointManager().registerEndpoint(endpoint);
  clientEngine.bind(endpoint);
  List<Data> list=new ArrayList<Data>();
  list.add(serializationService.toData(clientEngine.getThisAddress()));
  list.add(serializationService.toData(principal));
  return new SerializableList(list);
}

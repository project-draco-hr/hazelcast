{
  final Data dataBeforeTxn=putInternal(getService().toData(key),getService().toData(value));
  if (value != null) {
    TxnValueWrapper wrapper=dataBeforeTxn == null ? new TxnValueWrapper(value,TxnValueWrapper.Type.NEW) : new TxnValueWrapper(value,TxnValueWrapper.Type.UPDATED);
    txMap.put(key,wrapper);
  }
}

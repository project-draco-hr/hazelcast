{
  final Object valueBeforeTxn=getService().toObject(removeInternal(getService().toData(key)));
  TxnValueWrapper wrapper=null;
  if (valueBeforeTxn != null || txMap.containsKey(key)) {
    wrapper=txMap.put(key,new TxnValueWrapper(valueBeforeTxn,TxnValueWrapper.Type.REMOVED));
  }
  return wrapper == null ? valueBeforeTxn : checkIfRemoved(wrapper);
}

{
  Object current=tempMap.get(key);
  boolean haveTxnPast=current != null;
  if (haveTxnPast) {
    if (!current.equals(NULL)) {
      return current;
    }
    setInternal(getService().toData(key),getService().toData(value));
    tempMap.put(key,value);
    return null;
  }
 else {
    Data oldValue=putIfAbsentInternal(getService().toData(key),getService().toData(value));
    if (oldValue == null)     tempMap.put(key,value);
    return getService().toObject(oldValue);
  }
}

{
  final List<MapPartitionLostEvent> events=listener.getEvents();
  assertFalse(survivingPartitions.isEmpty());
  for (  MapPartitionLostEvent event : events) {
    final int failedPartitionId=event.getPartitionId();
    final Integer survivingReplicaIndex=survivingPartitions.get(failedPartitionId);
    if (survivingReplicaIndex != null) {
      final String message=log + ", PartitionId: " + failedPartitionId+ " SurvivingReplicaIndex: "+ survivingReplicaIndex+ " Map Name: "+ event.getName();
      assertTrue(message,survivingReplicaIndex > listener.getBackupCount());
    }
  }
}

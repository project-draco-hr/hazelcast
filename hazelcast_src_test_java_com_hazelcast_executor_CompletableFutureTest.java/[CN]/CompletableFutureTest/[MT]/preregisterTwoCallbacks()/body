{
  doneLatch=new CountDownLatch(2);
  final ICompletableFuture<String> f=submit(awaitStartLatch());
  f.andThen(setRefAndBumpDoneLatch(ref1));
  f.andThen(setRefAndBumpDoneLatch(ref2));
  startLatch.countDown();
  assertOpenEventually(doneLatch);
  assertEquals("success",ref1.get());
  assertEquals("success",ref2.get());
}

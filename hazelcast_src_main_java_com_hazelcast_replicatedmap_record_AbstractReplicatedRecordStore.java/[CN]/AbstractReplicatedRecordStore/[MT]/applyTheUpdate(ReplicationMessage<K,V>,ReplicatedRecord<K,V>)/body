{
  Vector localVector=localEntry.getVector();
  Vector remoteVector=update.getVector();
  K marshalledKey=(K)marshallKey(update.getKey());
  V marshalledValue=(V)marshallValue(update.getValue());
  long ttlMillis=update.getTtlMillis();
  Object oldValue=localEntry.setValue(marshalledValue,update.getUpdateHash(),ttlMillis);
  applyVector(remoteVector,localVector);
  if (ttlMillis > 0) {
    scheduleTtlEntry(ttlMillis,marshalledKey,null);
  }
 else {
    cancelTtlEntry(marshalledKey);
  }
  fireEntryListenerEvent(update.getKey(),unmarshallValue(oldValue),update.getValue());
}

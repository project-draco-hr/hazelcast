{
  addActiveMigration(partitionId,replicaIndex,from,node.getThisAddress());
  boolean error=false;
  for (  ServiceMigrationOperation op : operations) {
    try {
      nodeService.setOperationContext(op,op.getServiceName(),from,-1,partitionId,replicaIndex);
      ResponseHandlerFactory.setNoReplyResponseHandler(nodeService,op);
      op.run();
    }
 catch (    Throwable e) {
      error=true;
      logger.log(Level.SEVERE,e.getMessage(),e);
      break;
    }
  }
  for (  ServiceMigrationOperation op : operations) {
    if (!error) {
      op.onSuccess();
    }
 else {
      op.onError();
    }
  }
  return !error;
}

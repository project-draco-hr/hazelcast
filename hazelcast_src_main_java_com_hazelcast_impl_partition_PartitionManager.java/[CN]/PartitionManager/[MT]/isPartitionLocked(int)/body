{
  if (partitionId < 0 || partitionId > partitionCount) {
    throw new IllegalArgumentException();
  }
  return partitionLocks[partitionId].get() > (Clock.currentTimeMillis() + partitionMigrationTimeout);
}

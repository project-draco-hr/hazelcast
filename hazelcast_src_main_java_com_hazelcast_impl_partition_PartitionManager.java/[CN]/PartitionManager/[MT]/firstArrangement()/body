{
  if (!node.isMaster() || !node.isActive())   return;
  if (!hasStorageMember())   return;
  if (!initialized) {
    lock.lock();
    try {
      if (initialized)       return;
      PartitionStateGenerator psg=getPartitionStateGenerator();
      logger.log(Level.INFO,"Initializing cluster partition table first arrangement...");
      PartitionInfo[] newState=psg.initialize(node.getClusterImpl().getMembers(),partitionCount);
      if (newState != null) {
        for (        PartitionInfo partitionInfo : newState) {
          partitions[partitionInfo.getPartitionId()].setPartitionInfo(partitionInfo);
          for (int index=0; index < PartitionInfo.MAX_REPLICA_COUNT; index++) {
            Address to=partitionInfo.getReplicaAddress(index);
            if (to != null) {
              MigratingPartition mp=new MigratingPartition(partitionInfo.getPartitionId(),index,null,to);
              sendMigrationEvent(MigrationStatus.STARTED,mp);
              sendMigrationEvent(MigrationStatus.COMPLETED,mp);
            }
          }
        }
      }
      initialized=true;
      sendPartitionRuntimeState();
    }
  finally {
      lock.unlock();
    }
  }
}

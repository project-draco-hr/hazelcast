{
  R record=records.remove(key);
  if (record == null) {
    return null;
  }
  updateSizeEstimator(-calculateHeapCost(record));
  updateSizeEstimator(-calculateHeapCost(key));
  Object oldValue=record.getValue();
  record.invalidate();
  return oldValue;
}

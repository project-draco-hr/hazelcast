{
  MultiFieldAndMethod multiFieldAndMethod=new MultiFieldAndMethod();
  multiFieldAndMethod.field1=1;
  multiFieldAndMethod.field2=2;
  metricsRegistry.scanAndRegister(multiFieldAndMethod,"foo");
  Gauge field1=metricsRegistry.getGauge("foo.field1");
  Gauge field2=metricsRegistry.getGauge("foo.field2");
  Gauge method1=metricsRegistry.getGauge("foo.method1");
  Gauge method2=metricsRegistry.getGauge("foo.method2");
  metricsRegistry.deregister(multiFieldAndMethod);
  Set<String> names=metricsRegistry.getNames();
  assertFalse(names.contains("foo.field1"));
  assertFalse(names.contains("foo.field2"));
  assertFalse(names.contains("foo.method1"));
  assertFalse(names.contains("foo.method2"));
  assertEquals(0,field1.readLong());
  assertEquals(0,field2.readLong());
  assertEquals(0,method1.readLong());
  assertEquals(0,method2.readLong());
}

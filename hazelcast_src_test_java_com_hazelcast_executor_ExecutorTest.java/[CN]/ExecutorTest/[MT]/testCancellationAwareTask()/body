{
  CancellationAwareTask task=new CancellationAwareTask(5000);
  ExecutorService executor=createSingleNodeExecutorService("testCancellationAwareTask");
  Future future=executor.submit(task);
  try {
    future.get(2,TimeUnit.SECONDS);
    fail("Should throw TimeoutException!");
  }
 catch (  TimeoutException expected) {
  }
catch (  Exception e) {
    fail("No other Exception!!");
  }
  assertFalse(future.isDone());
  assertFalse(future.cancel(true));
  assertFalse(future.isCancelled());
  assertTrue(future.isDone());
  try {
    future.get();
  }
 catch (  InterruptedException e) {
    fail();
  }
catch (  ExecutionException e) {
    fail();
  }
}

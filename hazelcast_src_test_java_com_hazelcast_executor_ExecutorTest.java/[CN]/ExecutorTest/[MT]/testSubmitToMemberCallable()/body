{
  final int k=simpleTestNodeCount;
  StaticNodeFactory factory=createNodeFactory(k);
  final HazelcastInstance[] instances=factory.newInstances(new Config());
  final AtomicInteger count=new AtomicInteger(0);
  final CountDownLatch latch=new CountDownLatch(k / 2);
  final ExecutionCallback callback=new ExecutionCallback(){
    public void onResponse(    Object response){
      if ((Boolean)response)       count.incrementAndGet();
      latch.countDown();
    }
    public void onFailure(    Throwable t){
    }
  }
;
  for (int i=0; i < k; i++) {
    final HazelcastInstance instance=instances[i];
    final IExecutorService service=instance.getExecutorService("testSubmitToMemberCallable");
    final String script="hazelcast.getCluster().getLocalMember().equals(member); ";
    final HashMap map=new HashMap();
    map.put("member",instance.getCluster().getLocalMember());
    if (i % 2 == 0) {
      final Future f=service.submitToMember(new ScriptCallable(script,map),instance.getCluster().getLocalMember());
      Assert.assertTrue((Boolean)f.get(5,TimeUnit.SECONDS));
    }
 else {
      service.submitToMember(new ScriptCallable(script,map),instance.getCluster().getLocalMember(),callback);
    }
  }
  assertTrue(latch.await(30,TimeUnit.SECONDS));
  Assert.assertEquals(k / 2,count.get());
}

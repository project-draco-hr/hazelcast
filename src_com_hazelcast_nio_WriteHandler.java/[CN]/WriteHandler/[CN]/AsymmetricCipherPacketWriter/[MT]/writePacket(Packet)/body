{
  if (!aliasWritten) {
    String localAlias=CipherHelper.getKeyAlias();
    byte[] localAliasBytes=localAlias.getBytes();
    socketBB.putInt(localAliasBytes.length);
    socketBB.put(localAliasBytes);
    socketBB.put(new byte[996 - localAliasBytes.length]);
    aliasWritten=true;
  }
  return encryptAndWrite(packet);
}

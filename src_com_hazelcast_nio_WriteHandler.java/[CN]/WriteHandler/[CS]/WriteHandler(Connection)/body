{
  super(connection,true);
  boolean symmetricEncryptionEnabled=CipherHelper.isSymmetricEncryptionEnabled();
  boolean asymmetricEncryptionEnabled=CipherHelper.isAsymmetricEncryptionEnabled();
  if (asymmetricEncryptionEnabled || symmetricEncryptionEnabled) {
    if (asymmetricEncryptionEnabled && symmetricEncryptionEnabled) {
      packetWriter=new ComplexCipherPacketWriter();
    }
 else     if (symmetricEncryptionEnabled) {
      packetWriter=new SymmetricCipherPacketWriter();
    }
 else {
      packetWriter=new AsymmetricCipherPacketWriter();
    }
  }
 else {
    packetWriter=new DefaultPacketWriter();
  }
}

{
  final Data data=serializationService.toData(value,partitionStrategy);
  if (optimizeQuery) {
    return statisticsEnabled ? new CachedDataRecordWithStats(data) : new CachedDataRecord(data);
  }
  return statisticsEnabled ? new DataRecordWithStats(data) : new DataRecord(data);
}

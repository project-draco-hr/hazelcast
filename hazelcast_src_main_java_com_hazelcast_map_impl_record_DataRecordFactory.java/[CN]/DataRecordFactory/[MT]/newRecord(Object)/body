{
  final Data data=serializationService.toData(value,partitionStrategy);
switch (cacheDeserializedValues) {
case NEVER:
    return statisticsEnabled ? new DataRecordWithStats(data) : new DataRecord(data);
default :
  return statisticsEnabled ? new CachedDataRecordWithStats(data) : new CachedDataRecord(data);
}
}

{
  checkNotNull(task,"task should not be null");
  String uuid=getUUID();
  int partitionId=randomPartitionId();
  ClientMessage request=ExecutorServiceSubmitToPartitionParameters.encode(name,uuid,toData(task),partitionId);
  ClientInvocationFuture f=invokeOnPartitionOwner(request,partitionId);
  SerializationService serializationService=getContext().getSerializationService();
  ClientDelegatingFuture<T> delegatingFuture=new ClientDelegatingFuture<T>(f,serializationService);
  delegatingFuture.andThen(callback);
}

{
  out.writeBoolean(binary);
  out.writeByte(iterationType.getId());
  out.writeInt(rows.size());
  for (  QueryResultRow entry : rows) {
switch (iterationType) {
case KEY:
      out.writeData(entry.getKey());
    break;
case VALUE:
  out.writeData(entry.getValue());
break;
case ENTRY:
out.writeData(entry.getKey());
out.writeData(entry.getValue());
break;
default :
throw new IllegalStateException("Unrecognized iterationType:" + iterationType);
}
out.writeObject(entry);
}
}

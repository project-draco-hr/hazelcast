{
  int clusterSize=factory.getAllHazelcastInstances().size();
  assertClusterSizeEventually(clusterSize,client);
  final AtomicInteger eventCount=new AtomicInteger();
  final String registrationId=addListener(eventCount);
  terminateRandomNode();
  factory.newHazelcastInstance();
  assertClusterSizeEventually(clusterSize,client);
  assertTrueEventually(new AssertTask(){
    @Override public void run() throws Exception {
      assertNotEquals(0,getClientEventRegistrations(client,registrationId).size());
    }
  }
);
  for (int i=0; i < EVENT_COUNT; i++) {
    produceEvent();
  }
  assertTrueEventually(new AssertTask(){
    @Override public void run() throws Exception {
      int current=eventCount.get();
      String msg="[testListenersInternal] Current event count is " + current + " and expected event count is "+ EVENT_COUNT;
      assertEquals(msg,EVENT_COUNT,current);
    }
  }
);
  assertTrue(removeListener(registrationId));
}

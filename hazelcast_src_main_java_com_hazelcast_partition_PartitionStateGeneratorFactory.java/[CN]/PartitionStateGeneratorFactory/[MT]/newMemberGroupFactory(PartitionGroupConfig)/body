{
  if (partitionGroupConfig == null || !partitionGroupConfig.isEnabled()) {
    return new SingleMemberGroupFactory();
  }
switch (partitionGroupConfig.getGroupType()) {
case HOST_AWARE:
    return new HostAwareMemberGroupFactory();
case CUSTOM:
  return new ConfigMemberGroupFactory(partitionGroupConfig.getMemberGroupConfigs());
default :
return new SingleMemberGroupFactory();
}
}

{
  if (converter == null) {
    AttributeType attributeType=e.getAttributeType(attribute);
    converter=attributeType == null ? TypeConverters.IDENTITY_CONVERTER : attributeType.getConverter();
  }
  Data key=e.getIndexKey();
  Comparable newValue=e.getAttribute(attribute);
  newValue=sanitizeValue(newValue);
  Comparable oldValue=recordValues.put(key,newValue);
  if (oldValue == null) {
    indexStore.newIndex(newValue,e);
  }
 else {
    indexStore.updateIndex(oldValue,newValue,e);
  }
}

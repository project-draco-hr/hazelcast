{
  if (converter == null) {
    AttributeType attributeType=e.getAttributeType(attribute);
    converter=attributeType == null ? TypeConverters.IDENTITY_CONVERTER : attributeType.getConverter();
  }
  Data key=e.getIndexKey();
  Comparable oldValue=recordValues.remove(key);
  Comparable newValue=e.getAttribute(attribute);
  if (newValue == null) {
    newValue=NULL;
  }
 else   if (newValue.getClass().isEnum()) {
    newValue=TypeConverters.ENUM_CONVERTER.convert(newValue);
  }
  recordValues.put(key,newValue);
  if (oldValue == null) {
    indexStore.newIndex(newValue,e);
  }
 else {
    indexStore.updateIndex(oldValue,newValue,e);
  }
}

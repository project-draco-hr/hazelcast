{
  if (!("TRUE".equalsIgnoreCase(System.getProperty(ENABLE_JMX)) || System.getProperties().containsKey("com.sun.management.jmxremote"))) {
    return;
  }
  logger.log(Level.INFO,"JMX agent enabled");
  if (showDetails()) {
    if (statCollectors == null) {
      statCollectors=new ScheduledThreadPoolExecutor(4);
    }
  }
  MBeanServer mbs=ManagementFactory.getPlatformMBeanServer();
  try {
    ClusterMBean clusterMBean=new ClusterMBean(cluster);
    mbs.registerMBean(clusterMBean,clusterMBean.getObjectName());
  }
 catch (  Exception e) {
    logger.log(Level.WARNING,"Unable to start JMX service",e);
    return;
  }
  try {
    if (dataMonitor == null) {
      dataMonitor=new DataMBean();
    }
    mbs.registerMBean(dataMonitor,null);
  }
 catch (  Exception e) {
    logger.log(Level.WARNING,"Unable to start JMX data instance service",e);
  }
}

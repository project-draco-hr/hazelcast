{
  super(node);
  BLOCK_SIZE=node.groupProperties.BLOCKING_QUEUE_BLOCK_SIZE.getInteger();
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_QUEUE_POLL,new QueuePacketProcessor(){
    public void processPacket(    Packet packet){
      try {
        handlePoll(packet);
      }
 catch (      Throwable t) {
        Request req=Request.copy(packet);
        printState(req,false,packet.conn.getEndPoint(),1);
        t.printStackTrace();
      }
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_QUEUE_OFFER,new QueuePacketProcessor(){
    public void processPacket(    Packet packet){
      handleOffer(packet);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_ITERATE,new InitializationAwareOperationHandler(){
    @Override void doOperation(    BQ queue,    Request request){
      queue.iterate(request);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_SIZE,new InitializationAwareOperationHandler(){
    void doOperation(    BQ queue,    Request request){
      queue.size(request);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_TAKE_KEY,new ResponsiveOperationHandler(){
    public void handle(    Request request){
      handleTakeKey(request);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_PEEK_KEY,new ResponsiveOperationHandler(){
    public void handle(    Request request){
      handlePeekKey(request);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_ADD_KEY,new ResponsiveOperationHandler(){
    public void handle(    Request request){
      handleAddKey(request);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_REMOVE_KEY,new InitializationAwareOperationHandler(){
    void doOperation(    BQ queue,    Request request){
      queue.removeKey(request);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_GENERATE_KEY,new ResponsiveOperationHandler(){
    public void handle(    Request request){
      handleGenerateKey(request);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_OFFER_KEY,new PacketProcessor(){
    public void process(    Packet packet){
      handleOfferKey(packet);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_QUEUE_OFFER_FIRST,new QueuePacketProcessor(){
    public void processPacket(    Packet packet){
      handleOfferFirst(packet);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_QUEUE_BACKUP_ADD,new QueuePacketProcessor(){
    public void processPacket(    Packet packet){
      handleBackup(packet);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_QUEUE_BACKUP_REMOVE,new QueuePacketProcessor(){
    public void processPacket(    Packet packet){
      handleBackup(packet);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_QUEUE_SIZE,new QueuePacketProcessor(){
    public void processPacket(    Packet packet){
      handleSize(packet);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_QUEUE_PEEK,new QueuePacketProcessor(){
    public void processPacket(    Packet packet){
      handlePoll(packet);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_QUEUE_READ,new QueuePacketProcessor(){
    public void processPacket(    Packet packet){
      handleRead(packet);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_QUEUE_REMOVE,new QueuePacketProcessor(){
    public void processPacket(    Packet packet){
      handleRemove(packet);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_QUEUE_TXN_BACKUP_POLL,new QueuePacketProcessor(){
    public void processPacket(    Packet packet){
      handleTxnBackupPoll(packet);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_QUEUE_TXN_COMMIT,new QueuePacketProcessor(){
    public void processPacket(    Packet packet){
      handleTxnCommit(packet);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_QUEUE_ADD_BLOCK,new QueuePacketProcessor(){
    public void processPacket(    Packet packet){
      handleAddBlock(packet);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_QUEUE_REMOVE_BLOCK,new QueuePacketProcessor(){
    public void processPacket(    Packet packet){
      handleRemoveBlock(packet);
    }
  }
);
  node.clusterService.registerPacketProcessor(ClusterOperation.BLOCKING_QUEUE_FULL_BLOCK,new QueuePacketProcessor(){
    public void processPacket(    Packet packet){
      handleFullBlock(packet);
    }
  }
);
}

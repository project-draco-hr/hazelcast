{
  final boolean master=isMaster();
  if (master && ready(req)) {
    BQ bq=getOrCreateBQ(req.name);
    bq.doAddKey(req.key,(int)req.longValue);
    req.key=null;
    req.response=Boolean.TRUE;
    returnResponse(req);
  }
 else {
    returnRedoResponse(req,!master ? REDO_QUEUE_NOT_MASTER : REDO_QUEUE_NOT_READY);
  }
}

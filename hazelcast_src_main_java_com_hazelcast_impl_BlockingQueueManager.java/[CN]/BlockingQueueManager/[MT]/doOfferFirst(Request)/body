{
  if (req.value == null) {
    throw new RuntimeException("OfferFirst request value cannot be null. Local:" + req.local);
  }
  if (req.value.size() == 0) {
    throw new RuntimeException("OfferFirst request value size cannot be zero. Local:" + req.local);
  }
  Q q=getQ(req.name);
  if (q.blCurrentTake == null) {
    q.setCurrentTake();
  }
  if (q.quickSize() >= q.maxSizePerJVM || q.blCurrentTake.hasNoSpace()) {
    if (req.hasEnoughTimeToSchedule()) {
      req.scheduled=true;
      final Request reqScheduled=(req.local) ? req : req.hardCopy();
      if (reqScheduled.local) {
        if (reqScheduled.attachment == null) {
          throw new RuntimeException("Scheduled local but attachment is null");
        }
      }
      q.scheduleOfferFirst(reqScheduled);
    }
 else {
      req.response=Boolean.FALSE;
    }
    return;
  }
  q.offer(req,true);
  req.response=Boolean.TRUE;
}

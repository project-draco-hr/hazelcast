{
  if (isMaster()) {
    Collection<Q> queues=mapQueues.values();
    for (    Q q : queues) {
      List<Block> lsBlocks=q.lsBlocks;
      for (      Block block : lsBlocks) {
        int fullBlockId=-1;
        if (block.isFull()) {
          fullBlockId=block.blockId;
        }
        sendAddBlockMessageToOthers(block,fullBlockId,null,true);
      }
    }
  }
  Collection<Q> queues=mapQueues.values();
  for (  Q q : queues) {
    List<Block> lsBlocks=q.lsBlocks;
    for (    Block block : lsBlocks) {
      if (block.address.equals(thisAddress)) {
        if (lsMembers.size() > 1) {
          MemberImpl memberBackupWas=getNextMemberBeforeSync(thisAddress,true,1);
          MemberImpl memberBackupIs=getNextMemberAfter(thisAddress,true,1);
          if (memberBackupWas == null || !memberBackupWas.equals(memberBackupIs)) {
            int size=block.size();
            if (size > 0) {
              executeLocally(new BlockBackupSyncRunner(new BlockBackupSync(q,block)));
            }
          }
        }
      }
    }
  }
  doResetBlockSizes();
}

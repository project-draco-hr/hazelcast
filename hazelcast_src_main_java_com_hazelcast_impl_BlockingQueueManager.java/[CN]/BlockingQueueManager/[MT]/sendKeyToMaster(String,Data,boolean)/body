{
  enqueueAndReturn(new Processable(){
    public void process(){
      if (isMaster()) {
        doAddKey(queueName,key,last);
      }
 else {
        Packet packet=obtainPacket();
        packet.name=queueName;
        packet.setKey(key);
        packet.operation=ClusterOperation.BLOCKING_OFFER_KEY;
        packet.longValue=(last) ? 0 : 1;
        boolean sent=send(packet,getMasterAddress());
      }
    }
  }
);
}

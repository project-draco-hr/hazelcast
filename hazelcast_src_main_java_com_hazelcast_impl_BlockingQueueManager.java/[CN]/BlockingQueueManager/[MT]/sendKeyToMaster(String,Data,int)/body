{
  enqueueAndReturn(new Processable(){
    public void process(){
      if (isMaster()) {
        doAddKey(queueName,key,index);
      }
 else {
        Packet packet=obtainPacket();
        packet.name=queueName;
        packet.setKey(key);
        packet.operation=ClusterOperation.BLOCKING_OFFER_KEY;
        packet.longValue=index;
        sendOrReleasePacket(packet,getMasterAddress());
      }
    }
  }
);
}

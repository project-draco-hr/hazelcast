{
  if (deadAddress.equals(thisAddress))   return;
  MemberImpl member=getNextMemberBeforeSync(deadAddress,true,1);
  Address addressNewOwner=(member == null) ? thisAddress : member.getAddress();
  Collection<Q> queues=mapQueues.values();
  for (  Q q : queues) {
    List<Block> lsBlocks=q.lsBlocks;
    for (    Block block : lsBlocks) {
      if (block.address.equals(deadAddress)) {
        block.address=addressNewOwner;
        block.resetAddIndex();
        if (lsMembers.size() > 1) {
          if (addressNewOwner.equals(thisAddress)) {
            int size=block.size();
            if (size > 0) {
              executeLocally(new BlockBackupSyncRunner(new BlockBackupSync(q,block)));
            }
          }
        }
      }
 else       if (block.address.equals(thisAddress)) {
        if (lsMembers.size() > 1) {
          MemberImpl memberBackupWas=getNextMemberBeforeSync(thisAddress,true,1);
          if (memberBackupWas == null || memberBackupWas.getAddress().equals(deadAddress)) {
            int size=block.size();
            if (size > 0) {
              executeLocally(new BlockBackupSyncRunner(new BlockBackupSync(q,block)));
            }
          }
        }
      }
    }
    List<ScheduledPollAction> scheduledPollActions=q.lsScheduledPollActions;
    for (    ScheduledPollAction scheduledAction : scheduledPollActions) {
      if (deadAddress.equals(scheduledAction.getRequest().caller)) {
        scheduledAction.setValid(false);
        node.clusterManager.deregisterScheduledAction(scheduledAction);
      }
    }
    List<ScheduledOfferAction> scheduledOfferActions=q.lsScheduledOfferActions;
    for (    ScheduledOfferAction scheduledAction : scheduledOfferActions) {
      if (deadAddress.equals(scheduledAction.getRequest().caller)) {
        scheduledAction.setValid(false);
        node.clusterManager.deregisterScheduledAction(scheduledAction);
      }
    }
  }
  doResetBlockSizes();
}

{
  QData qdata=null;
  if (req.longValue > 0) {
    qdata=removeItemByIndex((int)req.longValue);
  }
 else {
    qdata=pollValidItem();
  }
  if (qdata != null) {
    keys.remove(qdata.data);
    req.response=qdata.data;
    returnResponse(req);
    offerOne();
  }
 else {
    if (req.hasEnoughTimeToSchedule()) {
      addPollAction(new PollAction(req));
    }
 else {
      req.response=null;
      returnResponse(req);
    }
  }
}

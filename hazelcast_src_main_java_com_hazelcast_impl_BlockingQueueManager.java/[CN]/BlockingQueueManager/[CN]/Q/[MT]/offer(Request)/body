{
  if (req.value == null) {
    throw new RuntimeException("Offer request value cannot be null. Local:" + req.local);
  }
  if (req.value.size() == 0) {
    throw new RuntimeException("Offer request value size cannot be zero. Local:" + req.local);
  }
  try {
    int addIndex=blCurrentPut.add(req.value);
    long recordId=getRecordId(blCurrentPut.blockId,addIndex);
    req.recordId=recordId;
    doFireEntryEvent(true,req.value);
    sendBackup(true,req.caller,req.value,blCurrentPut.blockId,addIndex);
    req.longValue=addIndex;
    if (blCurrentPut.isFull()) {
      fireBlockFullEvent(blCurrentPut);
      blCurrentPut=null;
      setCurrentPut();
    }
    return addIndex;
  }
  finally {
    boolean consumed=false;
    while (!consumed && lsScheduledPollActions.size() > 0) {
      ScheduledAction pollAction=lsScheduledPollActions.remove(0);
      node.clusterManager.deregisterScheduledAction(pollAction);
      if (!pollAction.expired()) {
        consumed=pollAction.consume();
      }
    }
  }
}

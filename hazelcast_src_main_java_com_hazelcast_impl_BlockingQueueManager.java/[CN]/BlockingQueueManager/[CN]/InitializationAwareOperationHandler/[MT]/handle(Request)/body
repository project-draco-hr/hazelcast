{
  final boolean master=isMaster();
  if (master && ready(request)) {
    BQ bq=getOrCreateBQ(request.name);
    doOperation(bq,request);
  }
 else {
    returnRedoResponse(request,!master ? REDO_QUEUE_NOT_MASTER : REDO_QUEUE_NOT_READY);
  }
}

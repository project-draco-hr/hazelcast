{
  this.nodeEngine=nodeEngine;
  this.mapEvictionManager=new MapEvictionManager(this);
  this.replicaWaitSecondsForScheduledTasks=getNodeEngine().getGroupProperties().MAP_REPLICA_WAIT_SECONDS_FOR_SCHEDULED_TASKS.getInteger() * 1000;
  logger=nodeEngine.getLogger(MapService.class.getName());
  partitionContainers=new PartitionContainer[nodeEngine.getPartitionService().getPartitionCount()];
  ownedPartitions=new AtomicReference<List<Integer>>();
  mergePolicyMap=new ConcurrentHashMap<String,MapMergePolicy>();
  mergePolicyMap.put(PutIfAbsentMapMergePolicy.class.getName(),new PutIfAbsentMapMergePolicy());
  mergePolicyMap.put(HigherHitsMapMergePolicy.class.getName(),new HigherHitsMapMergePolicy());
  mergePolicyMap.put(PassThroughMergePolicy.class.getName(),new PassThroughMergePolicy());
  mergePolicyMap.put(LatestUpdateMapMergePolicy.class.getName(),new LatestUpdateMapMergePolicy());
}

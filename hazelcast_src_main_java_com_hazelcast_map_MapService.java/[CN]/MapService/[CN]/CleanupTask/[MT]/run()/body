{
  final List<Integer> ownedPartitions=new ArrayList<Integer>();
  for (int i=0; i < partitionContainers.length; i++) {
    final PartitionInfo partitionInfo=nodeEngine.getPartitionInfo(i);
    if (partitionInfo != null && nodeEngine.getThisAddress().equals(partitionInfo.getOwner())) {
      ownedPartitions.add(i);
    }
  }
  final CountDownLatch latch=new CountDownLatch(ownedPartitions.size());
  for (  Integer partitionId : ownedPartitions) {
    Operation op=new CleanupOperation(latch);
    op.setPartitionId(partitionId).setService(MapService.this).setValidateTarget(false);
    try {
      nodeEngine.getOperationService().runOperation(op);
    }
 catch (    Exception e) {
      logger.log(Level.WARNING,e.getMessage(),e);
    }
  }
  try {
    latch.await(5,TimeUnit.SECONDS);
  }
 catch (  InterruptedException ignored) {
  }
}

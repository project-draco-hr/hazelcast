{
  logger.log(Level.FINEST,"Committing " + event);
  if (event.getMigrationEndpoint() == MigrationEndpoint.SOURCE) {
    migrateIndex(event);
    if (event.getMigrationType() == MigrationType.MOVE) {
      clearPartitionData(event.getPartitionId());
    }
 else     if (event.getMigrationType() == MigrationType.MOVE_COPY_BACK) {
      final PartitionContainer container=partitionContainers[event.getPartitionId()];
      for (      DefaultRecordStore mapPartition : container.maps.values()) {
        final MapContainer mapContainer=getMapContainer(mapPartition.name);
        final MapConfig mapConfig=mapContainer.getMapConfig();
        if (mapConfig.getTotalBackupCount() < event.getCopyBackReplicaIndex()) {
          mapPartition.destroy();
        }
      }
    }
  }
 else {
    migrateIndex(event);
  }
  ownedPartitions.set(nodeEngine.getPartitionService().getMemberPartitions(nodeEngine.getThisAddress()));
}

{
  final MapServiceContext mapServiceContext=new DefaultMapServiceContext(nodeEngine);
  final ManagedService managedService=new MapManagedService(mapServiceContext);
  final MigrationAwareService migrationAwareService=new MapMigrationAwareService(mapServiceContext,nodeEngine);
  final TransactionalService transactionalService=new MapTransactionalService(mapServiceContext,nodeEngine);
  final RemoteService remoteService=new MapRemoteService(mapServiceContext,nodeEngine);
  final EventPublishingService eventPublisher=new MapEventPublishingService(mapServiceContext,nodeEngine);
  final PostJoinAwareService postJoinAwareService=new MapPostJoinAwareService(mapServiceContext);
  final SplitBrainHandlerService splitBrainHandler=new MapSplitBrainHandler(mapServiceContext,nodeEngine);
  final ReplicationSupportingService replicationSupportingService=new MapReplicationSupportingService(mapServiceContext,nodeEngine);
  final MapService mapService=new MapService();
  mapService.setManagedService(managedService);
  mapService.setMigrationAwareService(migrationAwareService);
  mapService.setTransactionalService(transactionalService);
  mapService.setRemoteService(remoteService);
  mapService.setEventPublishingService(eventPublisher);
  mapService.setPostJoinAwareService(postJoinAwareService);
  mapService.setSplitBrainHandlerService(splitBrainHandler);
  mapService.setReplicationSupportingService(replicationSupportingService);
  mapService.setMapServiceContext(mapServiceContext);
  mapServiceContext.setService(mapService);
  return mapService;
}

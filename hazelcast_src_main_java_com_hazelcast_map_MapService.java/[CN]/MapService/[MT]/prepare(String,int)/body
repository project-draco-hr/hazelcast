{
  System.out.println(nodeService.getThisAddress() + " MapService prepare " + txnId);
  PartitionContainer pc=partitionContainers[partitionId];
  TransactionLog txnLog=pc.getTransactionLog(txnId);
  int maxBackupCount=1;
  try {
    nodeService.takeBackups(MAP_SERVICE_NAME,new MapTxnBackupPrepareOperation(txnLog),partitionId,maxBackupCount,60);
  }
 catch (  Exception e) {
    throw new TransactionException(e);
  }
}

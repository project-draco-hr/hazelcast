{
  MapContainer mapContainer=getMapContainer(name);
  Record record=mapContainer.getRecordFactory().newRecord(dataKey,value);
  if (shouldSchedule) {
    if (ttl < 0 && mapContainer.getMapConfig().getTimeToLiveSeconds() > 0) {
      final long delay=TimeUnit.SECONDS.toMillis(mapContainer.getMapConfig().getTimeToLiveSeconds());
      scheduleTtlEviction(name,record,delay);
    }
 else     if (ttl > 0) {
      scheduleTtlEviction(name,record,ttl);
    }
    if (mapContainer.getMapConfig().getMaxIdleSeconds() > 0) {
      final long delay=TimeUnit.SECONDS.toMillis(mapContainer.getMapConfig().getMaxIdleSeconds());
      scheduleIdleEviction(name,dataKey,delay);
    }
  }
  return record;
}

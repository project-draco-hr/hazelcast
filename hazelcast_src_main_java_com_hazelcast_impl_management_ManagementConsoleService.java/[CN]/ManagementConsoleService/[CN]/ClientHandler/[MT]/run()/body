{
  try {
    socketIn.setInputStream(socket.getInputStream());
    socketOut.setOutputStream(socket.getOutputStream());
    while (running) {
      int requestType=socketIn.read();
      if (requestType < 0 || requestType >= consoleRequests.length) {
        continue;
      }
      ConsoleRequest consoleRequest=consoleRequests[requestType];
      consoleRequest.readData(socketIn);
      buffer.clear();
      boolean isOutOfMemory=factory.node.isOutOfMemory();
      if (isOutOfMemory) {
        dos.writeByte(ConsoleRequestConstants.STATE_OUT_OF_MEMORY);
      }
 else {
        dos.writeByte(ConsoleRequestConstants.STATE_ACTIVE);
        consoleRequest.writeResponse(ManagementConsoleService.this,dos);
      }
      socketOut.write(buffer.array(),0,buffer.position());
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}

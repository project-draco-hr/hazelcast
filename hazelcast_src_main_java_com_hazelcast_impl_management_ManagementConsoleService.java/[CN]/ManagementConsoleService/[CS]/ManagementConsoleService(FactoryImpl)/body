{
  this.factory=factoryImpl;
  thisAddress=((MemberImpl)factory.getCluster().getLocalMember()).getAddress();
  updateMemberOrder();
  logger=factory.node.getLogger(ManagementConsoleService.class.getName());
  for (int i=0; i < 100; i++) {
    qClientHandlers.offer(new ClientHandler());
  }
  factory.getCluster().addMembershipListener(this);
  MemberImpl memberLocal=(MemberImpl)factory.getCluster().getLocalMember();
  int port=memberLocal.getInetSocketAddress().getPort() + 100;
  datagramSocket=new DatagramSocket(port);
  serverSocket=new SocketReadyServerSocket(port);
  udpListener=new UDPListener(datagramSocket);
  udpListener.start();
  udpSender=new UDPSender(datagramSocket);
  udpSender.start();
  tcpListener=new TCPListener(serverSocket);
  tcpListener.start();
  logger.log(Level.INFO,"Hazelcast Management Console started at port " + port + ".");
}

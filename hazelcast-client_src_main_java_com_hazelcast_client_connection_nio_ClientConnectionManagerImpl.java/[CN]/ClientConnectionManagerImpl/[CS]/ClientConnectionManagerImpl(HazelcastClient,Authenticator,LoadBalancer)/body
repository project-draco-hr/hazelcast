{
  this.client=client;
  this.authenticator=authenticator;
  ClientConfig config=client.getClientConfig();
  router=new Router(loadBalancer);
  inSelector=new ClientInSelectorImpl(client.getThreadGroup());
  outSelector=new ClientOutSelectorImpl(client.getThreadGroup());
  SocketInterceptorConfig sic=config.getSocketInterceptorConfig();
  SocketInterceptor implementation=null;
  if (sic != null && sic.isEnabled()) {
    implementation=(SocketInterceptor)sic.getImplementation();
    if (implementation == null && sic.getClassName() != null) {
      try {
        implementation=(SocketInterceptor)Class.forName(sic.getClassName()).newInstance();
      }
 catch (      Throwable e) {
        logger.severe("SocketInterceptor class cannot be instantiated!" + sic.getClassName(),e);
      }
    }
  }
  socketInterceptor=implementation;
  if (socketInterceptor != null) {
    logger.info("SocketInterceptor is enabled");
    socketInterceptor.init(sic.getProperties());
  }
  socketOptions=config.getSocketOptions();
}

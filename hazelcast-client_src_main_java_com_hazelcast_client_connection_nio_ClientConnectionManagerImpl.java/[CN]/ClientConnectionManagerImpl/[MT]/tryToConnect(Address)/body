{
  final Authenticator authenticator=new ClusterAuthenticator();
  int count=0;
  IOException lastError=null;
  while (count < RETRY_COUNT) {
    try {
      if (target == null || !isMember(target)) {
        final Address address=router.next();
        return getOrConnect(address,authenticator);
      }
 else {
        return getOrConnect(target,authenticator);
      }
    }
 catch (    IOException e) {
      lastError=e;
    }
    target=null;
    count++;
  }
  throw lastError;
}

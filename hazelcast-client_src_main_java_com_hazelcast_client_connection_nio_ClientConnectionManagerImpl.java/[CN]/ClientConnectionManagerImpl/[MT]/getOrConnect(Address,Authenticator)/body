{
  Address address=addressTranslator.translate(target);
  if (address == null) {
    throw new IOException("Address is required!");
  }
  ClientConnection connection=connections.get(target);
  if (connection == null) {
    final Object lock=getLock(target);
synchronized (lock) {
      connection=connections.get(target);
      if (connection == null) {
        connection=createSocketConnection(address);
        authenticator.authenticate(connection);
        ClientConnection current=connections.putIfAbsent(connection.getRemoteEndpoint(),connection);
        if (current != null) {
          connection.close();
          connection=current;
        }
 else {
          for (          ConnectionListener connectionListener : connectionListeners) {
            connectionListener.connectionAdded(connection);
          }
        }
      }
    }
  }
  return connection;
}

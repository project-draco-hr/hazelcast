{
  Address endpoint=connection.getEndPoint();
  if (endpoint != null) {
    final ClientConnection conn=connections.remove(endpoint);
    if (conn == null) {
      return;
    }
    conn.close();
    for (    ConnectionListener connectionListener : connectionListeners) {
      connectionListener.connectionRemoved(conn);
    }
  }
 else {
    ClientInvocationService invocationService=client.getInvocationService();
    invocationService.cleanConnectionResources((ClientConnection)connection);
  }
}

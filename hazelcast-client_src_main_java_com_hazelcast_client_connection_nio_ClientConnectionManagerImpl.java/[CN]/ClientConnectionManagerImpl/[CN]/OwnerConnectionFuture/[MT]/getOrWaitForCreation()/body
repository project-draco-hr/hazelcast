{
  ClientNetworkConfig networkConfig=client.getClientConfig().getNetworkConfig();
  long connectionAttemptLimit=networkConfig.getConnectionAttemptLimit();
  long connectionAttemptPeriod=networkConfig.getConnectionAttemptPeriod();
  long waitTime=connectionAttemptLimit * connectionAttemptPeriod * 2;
  if (waitTime < 0) {
    waitTime=Long.MAX_VALUE;
  }
  final ClientConnection currentOwnerConnection=ownerConnection;
  if (currentOwnerConnection != null) {
    return currentOwnerConnection;
  }
  long remainingWait=waitTime;
synchronized (ownerConnectionLock) {
    long waitStart=System.currentTimeMillis();
    while (ownerConnection == null && remainingWait > 0) {
      try {
        ownerConnectionLock.wait(remainingWait);
        remainingWait=waitTime - (System.currentTimeMillis() - waitStart);
      }
 catch (      InterruptedException e) {
        throw new IOException(e);
      }
    }
    if (ownerConnection == null) {
      LOGGER.warning("Wait for owner connection is timed out");
      throw new IOException("Wait for owner connection is timed out");
    }
    return ownerConnection;
  }
}

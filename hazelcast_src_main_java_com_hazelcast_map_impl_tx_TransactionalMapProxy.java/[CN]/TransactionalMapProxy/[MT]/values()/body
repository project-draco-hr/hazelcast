{
  checkTransactionState();
  final Collection<Data> dataSet=valuesInternal();
  final Collection<Object> values=new ArrayList<Object>(dataSet.size());
  final MapService service=getService();
  final MapServiceContext mapServiceContext=service.getMapServiceContext();
  for (  final Data data : dataSet) {
    values.add(mapServiceContext.toObject(data));
  }
  for (  TxnValueWrapper wrapper : txMap.values()) {
    if (TxnValueWrapper.Type.NEW.equals(wrapper.type)) {
      values.add(wrapper.value);
    }
 else     if (TxnValueWrapper.Type.REMOVED.equals(wrapper.type)) {
      values.remove(wrapper.value);
    }
  }
  return values;
}

{
  final int MAX_SIZE=DEFAULT_RECORD_COUNT / 2;
  NearCacheConfig nearCacheConfig=createNearCacheConfig(DEFAULT_NEAR_CACHE_NAME,inMemoryFormat);
  if (evictionPolicy == null) {
    evictionPolicy=EvictionConfig.DEFAULT_EVICTION_POLICY;
  }
  EvictionConfig evictionConfig=new EvictionConfig();
  evictionConfig.setMaximumSizePolicy(EvictionConfig.MaxSizePolicy.ENTRY_COUNT);
  evictionConfig.setSize(MAX_SIZE);
  evictionConfig.setEvictionPolicy(evictionPolicy);
  nearCacheConfig.setEvictionConfig(evictionConfig);
  NearCacheRecordStore<Integer,String> nearCacheRecordStore=createNearCacheRecordStore(nearCacheConfig,createNearCacheContext(),inMemoryFormat);
  for (int i=0; i < DEFAULT_RECORD_COUNT; i++) {
    nearCacheRecordStore.put(i,"Record-" + i);
    nearCacheRecordStore.doEvictionIfRequired();
    assertTrue(MAX_SIZE >= nearCacheRecordStore.size());
  }
}

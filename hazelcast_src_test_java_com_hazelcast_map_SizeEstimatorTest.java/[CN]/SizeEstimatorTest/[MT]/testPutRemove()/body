{
  final String MAP_NAME="default";
  final Config config=new Config();
  config.getMapConfig(MAP_NAME).setBackupCount(1).setInMemoryFormat(MapConfig.InMemoryFormat.BINARY);
  final TestHazelcastInstanceFactory factory=createHazelcastInstanceFactory(2);
  final HazelcastInstance h[]=factory.newInstances(config);
  warmUpPartitions(h);
  final IMap<Long,Long> map=h[0].getMap(MAP_NAME);
  final IMap<Long,Long> backupMap=h[1].getMap(MAP_NAME);
  map.put(10L,10L);
  Thread.sleep(3000);
  long h1MapCost=map.getLocalMapStats().getHeapCost();
  long h2MapCost=backupMap.getLocalMapStats().getHeapCost();
  Assert.assertEquals(h1MapCost,h2MapCost);
  Thread.sleep(1000);
  map.remove(10L);
  Thread.sleep(1000);
  h1MapCost=map.getLocalMapStats().getHeapCost();
  h2MapCost=backupMap.getLocalMapStats().getHeapCost();
  Assert.assertEquals(0,h1MapCost);
  Assert.assertEquals(0,h2MapCost);
}

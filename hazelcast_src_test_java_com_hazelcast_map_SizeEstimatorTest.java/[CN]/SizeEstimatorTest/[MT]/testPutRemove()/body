{
  final String MAP_NAME="default";
  final Config config=new Config();
  config.getMapConfig(MAP_NAME).setBackupCount(1).setInMemoryFormat(InMemoryFormat.BINARY);
  final TestHazelcastInstanceFactory factory=createHazelcastInstanceFactory(2);
  final HazelcastInstance h[]=factory.newInstances(config);
  final IMap<String,String> map1=h[0].getMap(MAP_NAME);
  final IMap<String,String> map2=h[1].getMap(MAP_NAME);
  warmUpPartitions(h);
  Assert.assertEquals(0,map1.size());
  Assert.assertEquals(0,map2.size());
  map1.put("key","value");
  final long costOfMapOnNode1=map1.getLocalMapStats().getHeapCost();
  final long costOfMapOnNode2=map2.getLocalMapStats().getHeapCost();
  Assert.assertEquals(costOfMapOnNode1,costOfMapOnNode2);
  map1.remove("key");
  final long costOfMapOnNode1AfterRemove=map1.getLocalMapStats().getHeapCost();
  final long costOfMapOnNode2AfterRemove=map2.getLocalMapStats().getHeapCost();
  Assert.assertEquals(costOfMapOnNode1AfterRemove,costOfMapOnNode2AfterRemove);
}

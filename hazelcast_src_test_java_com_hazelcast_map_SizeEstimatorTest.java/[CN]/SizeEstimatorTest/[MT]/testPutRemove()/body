{
  final String MAP_NAME="default";
  final Config config=new Config();
  config.getMapConfig(MAP_NAME).setBackupCount(1).setInMemoryFormat(InMemoryFormat.BINARY);
  final TestHazelcastInstanceFactory factory=createHazelcastInstanceFactory(2);
  final HazelcastInstance h[]=factory.newInstances(config);
  final IMap<String,String> map1=h[0].getMap(MAP_NAME);
  final IMap<String,String> map2=h[1].getMap(MAP_NAME);
  warmUpPartitions(h);
  Assert.assertTrue(map1.size() == 0 && (map1.size() == map2.size()));
  map1.put("key","value");
  final long costOfMapOnNode1AfterPut=map1.getLocalMapStats().getHeapCost();
  final long costOfMapOnNode2AfterPut=map2.getLocalMapStats().getHeapCost();
  Assert.assertTrue(costOfMapOnNode1AfterPut > 0 && (costOfMapOnNode1AfterPut == costOfMapOnNode2AfterPut));
  map1.remove("key");
  final long costOfMapOnNode1AfterRemove=map1.getLocalMapStats().getHeapCost();
  final long costOfMapOnNode2AfterRemove=map2.getLocalMapStats().getHeapCost();
  Assert.assertTrue(costOfMapOnNode1AfterRemove == 0 && (costOfMapOnNode1AfterRemove == costOfMapOnNode2AfterRemove));
}

{
  Config config=new Config();
  HazelcastInstance h1=Hazelcast.newHazelcastInstance(config);
  ClientConfig clientConfig=new ClientConfig();
  clientConfig.setGroupConfig(new GroupConfig(h1.getConfig().getGroupConfig().getName(),h1.getConfig().getGroupConfig().getPassword()));
  clientConfig.setConnectionAttemptLimit(Integer.MAX_VALUE);
  clientConfig.setConnectionTimeout(30000);
  final HazelcastInstance client1=HazelcastClient.newHazelcastClient(clientConfig);
  for (int i=0; i < 35; i++) {
    final IMap<String,String> m=client1.getMap("default" + i);
    m.addEntryListener(new EntryAdapter<String,String>(),true);
  }
  h1.getLifecycleService().shutdown();
  Thread.sleep(50000);
  Thread thread=new Thread(new Runnable(){
    public void run(){
      IMap<String,String> m=client1.getMap("default");
      m.put("test","test");
    }
  }
);
  thread.start();
  System.out.println("Creating server");
  final HazelcastInstance h2=Hazelcast.newHazelcastInstance(config);
  thread.join();
}

{
  Set<Data> keySet=new HashSet<Data>();
  ClusterServiceImpl clusterService=(ClusterServiceImpl)nodeEngine.getClusterService();
  Address thisAddress=clusterService.getThisAddress();
  for (int i=0; i < nodeEngine.getPartitionService().getPartitionCount(); i++) {
    PartitionInfo partitionInfo=nodeEngine.getPartitionService().getPartitionInfo(i);
    CollectionPartitionContainer partitionContainer=getPartitionContainer(i);
    CollectionContainer collectionContainer=partitionContainer.getCollectionContainer(proxyId);
    if (collectionContainer == null) {
      continue;
    }
    if (partitionInfo.getOwner().equals(thisAddress)) {
      keySet.addAll(collectionContainer.keySet());
    }
  }
  getLocalMapStatsImpl(proxyId).incrementOtherOperations();
  return keySet;
}

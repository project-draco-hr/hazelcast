{
  ListenerKey listenerKey=new ListenerKey(name,key,listener);
  String id=eventRegistrations.putIfAbsent(listenerKey,"tempId");
  if (id != null) {
    return;
  }
  EventService eventService=nodeEngine.getEventService();
  EventRegistration registration=null;
  if (local) {
    registration=eventService.registerLocalListener(COLLECTION_SERVICE_NAME,name,new CollectionEventFilter(includeValue,key),listener);
  }
 else {
    registration=eventService.registerListener(COLLECTION_SERVICE_NAME,name,new CollectionEventFilter(includeValue,key),listener);
  }
  eventRegistrations.put(listenerKey,registration.getId());
}

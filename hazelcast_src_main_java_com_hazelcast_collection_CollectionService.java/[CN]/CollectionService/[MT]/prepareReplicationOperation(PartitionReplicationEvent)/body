{
  int replicaIndex=event.getReplicaIndex();
  final CollectionPartitionContainer partitionContainer=partitionContainers[event.getPartitionId()];
  if (partitionContainer == null) {
    return null;
  }
  Map<String,Map> map=new HashMap<String,Map>(partitionContainer.containerMap.size());
  for (  Map.Entry<String,CollectionContainer> entry : partitionContainer.containerMap.entrySet()) {
    String name=entry.getKey();
    CollectionContainer container=entry.getValue();
    if (container.config.getTotalBackupCount() < replicaIndex) {
      continue;
    }
    map.put(name,container.collections);
  }
  if (map.isEmpty()) {
    return null;
  }
  return new CollectionMigrationOperation(map);
}

{
  CollectionContainer container=getOrCreateContainer();
  if (!container.txnLock(dataKey,getCallerUuid(),threadId,ttl)) {
    throw new TransactionException("Lock failed.");
  }
  CollectionWrapper wrapper=getCollectionWrapper();
  Collection<CollectionRecord> coll=wrapper != null ? wrapper.getCollection() : null;
  response=new CollectionResponse(coll).setNextRecordId(container.nextId()).setTxVersion(wrapper.incrementAndGetVersion());
}

{
  CollectionContainer container=getOrCreateContainer();
  if (!container.txnLock(dataKey,getCallerUuid(),threadId,ttl)) {
    throw new TransactionException("Lock failed.");
  }
  CollectionWrapper wrapper=getOrCreateCollectionWrapper();
  response=new CollectionResponse(wrapper.getCollection()).setNextRecordId(container.nextId()).setTxVersion(wrapper.incrementAndGetVersion());
}

{
  final NodeEngine nodeEngine=mapServiceContext.getNodeEngine();
  try {
    Map values=mapDataStore.loadAll(keys.values());
    if (values == null || values.isEmpty()) {
      decrementCounterAndMarkAsLoaded();
      return;
    }
    MapEntrySet entrySet=new MapEntrySet();
    for (    Data dataKey : keys.keySet()) {
      Object key=keys.get(dataKey);
      Object value=values.get(key);
      if (value != null) {
        Data dataValue=mapServiceContext.toData(value);
        entrySet.add(dataKey,dataValue);
      }
    }
    PutAllOperation operation=new PutAllOperation(name,entrySet,true);
    operation.setNodeEngine(nodeEngine);
    operation.setResponseHandler(new ResponseHandler(){
      @Override public void sendResponse(      Object obj){
        decrementCounterAndMarkAsLoaded();
      }
      public boolean isLocal(){
        return true;
      }
    }
);
    operation.setPartitionId(partitionId);
    OperationAccessor.setCallerAddress(operation,nodeEngine.getThisAddress());
    operation.setCallerUuid(nodeEngine.getLocalMember().getUuid());
    operation.setServiceName(MapService.SERVICE_NAME);
    nodeEngine.getOperationService().executeOperation(operation);
  }
 catch (  Throwable t) {
    decrementCounterAndMarkAsLoaded();
    logger.warning("Exception while load all task:" + t.toString());
    callback.notify(t);
  }
}

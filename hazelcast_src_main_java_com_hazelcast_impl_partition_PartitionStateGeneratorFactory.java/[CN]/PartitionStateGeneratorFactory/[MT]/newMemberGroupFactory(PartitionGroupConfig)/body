{
  if (partitionGroupConfig == null || !partitionGroupConfig.isEnabled()) {
    return new SingleMemberGroupFactory();
  }
switch (partitionGroupConfig.getGroupType()) {
case HOST_AWARE:
    return new HostAwareMemberGroupFactory();
case CUSTOM:
  if (partitionGroupConfig.getMemberGroupFactoryClassname() != null) {
    try {
      final MemberGroupFactory f;
      f=(MemberGroupFactory)Serializer.newInstance(partitionGroupConfig.getMemberGroupFactoryClassname());
      return f;
    }
 catch (    Exception e) {
      Util.throwUncheckedException(e);
    }
  }
return new ConfigMemberGroupFactory(partitionGroupConfig.getMemberGroupConfigs());
default :
return new SingleMemberGroupFactory();
}
}

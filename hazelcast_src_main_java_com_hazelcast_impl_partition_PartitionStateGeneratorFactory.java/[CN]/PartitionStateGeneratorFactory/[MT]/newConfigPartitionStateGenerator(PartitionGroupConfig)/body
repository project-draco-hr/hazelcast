{
  if (partitionGroupConfig == null || !partitionGroupConfig.isEnabled()) {
    return newRandomPartitionStateGenerator();
  }
switch (partitionGroupConfig.getGroupType()) {
case HOST_AWARE:
    return newHostAwarePartitionStateGenerator();
case CUSTOM:
  return newCustomPartitionStateGenerator(new ConfigMemberGroupFactory(partitionGroupConfig.getMemberGroupConfigs()));
default :
return newRandomPartitionStateGenerator();
}
}

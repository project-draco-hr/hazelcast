{
  if (obj instanceof Data) {
    return doHardCopy((Data)obj);
  }
  Data data=createNewData();
  bufferProvider.setData(data);
  bbos.reset();
  byte typeId=SERIALIZER_TYPE_OBJECT;
  if (obj instanceof DataSerializable) {
    typeId=SERIALIZER_TYPE_DATA;
  }
 else   if (obj instanceof byte[]) {
    typeId=SERIALIZER_TYPE_BYTE_ARRAY;
  }
 else   if (obj instanceof Long) {
    typeId=SERIALIZER_TYPE_LONG;
  }
 else   if (obj instanceof Integer) {
    typeId=SERIALIZER_TYPE_INTEGER;
  }
 else   if (obj instanceof String) {
    typeId=SERIALIZER_TYPE_STRING;
  }
 else   if (obj instanceof Class) {
    typeId=SERIALIZER_TYPE_CLASS;
  }
  bbos.writeByte(typeId);
  typeSerizalizers[typeId].write(bbos,obj);
  bbos.flush();
  data.postRead();
  return data;
}

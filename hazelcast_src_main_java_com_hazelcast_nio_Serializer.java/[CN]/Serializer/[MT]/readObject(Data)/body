{
  if (data == null || data.size() == 0)   return null;
  try {
    bbis.set(data.buffer.array(),data.size());
    byte typeId=bbis.readByte();
    Object obj=typeSerializer[typeId].read(bbis);
    if (obj instanceof HazelcastInstanceAware) {
      ((HazelcastInstanceAware)obj).setHazelcastInstance(ThreadContext.get().getCurrentFactory());
    }
    return obj;
  }
 catch (  Exception e) {
    e.printStackTrace();
    throw new RuntimeException(e);
  }
}

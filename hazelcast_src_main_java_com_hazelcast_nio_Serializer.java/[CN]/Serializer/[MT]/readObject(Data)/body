{
  try {
    if (data == null || data.size() == 0)     return null;
    bbis.set(data.buffer,data.size());
    byte typeId=bbis.readByte();
    Object obj=typeSerializer[typeId].read(bbis);
    if (obj instanceof HazelcastInstanceAware) {
      ((HazelcastInstanceAware)obj).setHazelcastInstance(ThreadContext.get().getCurrentFactory());
    }
    return obj;
  }
 catch (  Throwable e) {
    logger.log(Level.SEVERE,e.getMessage(),e);
    throw new RuntimeException(e);
  }
}

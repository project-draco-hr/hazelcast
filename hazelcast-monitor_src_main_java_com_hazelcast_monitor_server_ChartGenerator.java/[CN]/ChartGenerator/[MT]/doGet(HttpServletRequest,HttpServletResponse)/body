{
  String name=req.getParameter("name");
  SessionObject sessionObject=getSessionObject(req.getSession());
  List<MapStatistics> list=null;
  for (  ChangeEventGenerator eventGenerator : sessionObject.eventGenerators) {
    if (eventGenerator.getChangeEventType().equals(ChangeEventType.MAP_STATISTICS)) {
      MapStatisticsGenerator msg=(MapStatisticsGenerator)eventGenerator;
      if (!msg.getName().equals(name)) {
        continue;
      }
      list=msg.getPastMapStatistics();
    }
  }
  if (list == null) {
    return;
  }
  TimeSeries ts=new TimeSeries("Map.size()",Second.class);
  int maxSize=Integer.MIN_VALUE;
  int minSize=Integer.MAX_VALUE;
  for (int i=0; i < list.size(); i++) {
    int size=list.get(i).getSize();
    maxSize=Math.max(size,maxSize);
    minSize=Math.min(size,minSize);
    ts.addOrUpdate(new Second(list.get(i).getCreatedDate()),new Integer(size));
  }
  maxSize=(int)(maxSize * 1.1);
  minSize=(int)(minSize * 0.8);
  TimeSeriesCollection timeDataset=new TimeSeriesCollection();
  timeDataset.addSeries(ts);
  JFreeChart chart=ChartFactory.createTimeSeriesChart("Map: " + name,"Time","Size",timeDataset,false,true,true);
  chart.setBackgroundPaint(Color.WHITE);
  try {
    OutputStream out=response.getOutputStream();
    response.setContentType("image/png");
    ChartUtilities.writeChartAsPNG(out,chart,1000,300);
  }
 catch (  IOException ignore) {
  }
}

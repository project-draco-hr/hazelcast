{
  Exception lastError=null;
  int count=0;
  while (count < RETRY_COUNT) {
    try {
      final Address randomAddress=getRandomAddress();
      return (ClientConnection)client.getConnectionManager().getOrConnect(randomAddress,authenticator);
    }
 catch (    IOException e) {
      lastError=e;
    }
catch (    HazelcastInstanceNotActiveException e) {
      lastError=e;
    }
    count++;
  }
  throw lastError;
}

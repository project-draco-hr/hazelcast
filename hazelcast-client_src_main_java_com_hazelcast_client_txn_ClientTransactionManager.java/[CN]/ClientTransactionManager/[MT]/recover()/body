{
  final SerializationService serializationService=client.getSerializationService();
  final ClientClusterServiceImpl clusterService=(ClientClusterServiceImpl)client.getClientClusterService();
  final Xid[] empty=new Xid[0];
  try {
    final Connection connection=connect();
    if (connection == null) {
      return empty;
    }
    final RecoverAllTransactionsRequest request=new RecoverAllTransactionsRequest();
    final SerializableCollection collectionWrapper=clusterService.sendAndReceiveFixedConnection(connection,request);
    final ConnectionWrapper connectionWrapper=new ConnectionWrapper(connection,collectionWrapper.size());
    for (    Data data : collectionWrapper) {
      final SerializableXid xid=(SerializableXid)serializationService.toObject(data);
      recoveredTransactions.put(xid,connectionWrapper);
    }
    final Set<SerializableXid> xidSet=recoveredTransactions.keySet();
    return xidSet.toArray(new Xid[xidSet.size()]);
  }
 catch (  Exception e) {
    ExceptionUtil.rethrow(e);
  }
  return empty;
}

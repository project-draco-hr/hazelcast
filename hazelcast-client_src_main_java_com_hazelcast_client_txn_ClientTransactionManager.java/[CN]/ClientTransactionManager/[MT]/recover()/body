{
  final SerializationService serializationService=client.getSerializationService();
  final ClientInvocationServiceImpl invocationService=(ClientInvocationServiceImpl)client.getInvocationService();
  final Xid[] empty=new Xid[0];
  try {
    final ClientConnection connection=connect();
    if (connection == null) {
      return empty;
    }
    final RecoverAllTransactionsRequest request=new RecoverAllTransactionsRequest();
    final ICompletableFuture<SerializableCollection> future=invocationService.send(request,connection);
    final SerializableCollection collectionWrapper=future.get();
    for (    Data data : collectionWrapper) {
      final SerializableXid xid=serializationService.toObject(data);
      recoveredTransactions.put(xid,connection);
    }
    final Set<SerializableXid> xidSet=recoveredTransactions.keySet();
    return xidSet.toArray(new Xid[xidSet.size()]);
  }
 catch (  Exception e) {
    ExceptionUtil.rethrow(e);
  }
  return empty;
}

{
  if (timeout < 0)   throw new IllegalArgumentException();
  long remaining=unit.toMillis(timeout);
  lock.lock();
  try {
    while (response == null && remaining > 0) {
      long start=Clock.currentTimeMillis();
      noValue.await(remaining,TimeUnit.MILLISECONDS);
      remaining-=(Clock.currentTimeMillis() - start);
    }
    return getAndRemoveResponse();
  }
  finally {
    lock.unlock();
  }
}

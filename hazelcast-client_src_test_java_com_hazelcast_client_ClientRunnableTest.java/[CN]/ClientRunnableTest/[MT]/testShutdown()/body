{
  final ClientRunnable clientRunnable=new ClientRunnable(){
    @Override protected void customRun() throws InterruptedException {
    }
  }
;
  final CountDownLatch latch1=new CountDownLatch(1);
  final CountDownLatch latch2=new CountDownLatch(1);
  final CountDownLatch latchShutDown=new CountDownLatch(1);
  new Thread(new Runnable(){
    public void run(){
      try {
        latch1.await();
        latch2.countDown();
        clientRunnable.shutdown();
        latchShutDown.countDown();
      }
 catch (      InterruptedException e) {
      }
    }
  }
).start();
  latch1.countDown();
  latch2.await();
  Thread.sleep(10);
  clientRunnable.notifyMonitor();
  assertTrue(latchShutDown.await(5,TimeUnit.SECONDS));
  assertFalse(clientRunnable.running);
}

{
  Executor executor=getExecutor(partitionId);
  ConcurrentLinkedQueue<Runnable> priorityQueue=getPriorityQueue(partitionId);
  if (priority) {
    priorityQueue.offer(task);
    executor.execute(new ProcessPriorityQueueTask(priorityQueue,null));
  }
 else {
    executor.execute(new ProcessPriorityQueueTask(priorityQueue,task));
  }
}

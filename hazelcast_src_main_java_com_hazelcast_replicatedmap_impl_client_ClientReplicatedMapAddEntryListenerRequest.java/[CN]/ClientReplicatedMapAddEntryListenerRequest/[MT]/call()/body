{
  if (getClientEngine().getConfig().isLiteMember()) {
    throw new ReplicatedMapCantBeCreatedOnLiteMemberException("Listener cannot be registered on lite members!");
  }
  final ClientEndpoint endpoint=getEndpoint();
  ReplicatedMapService service=getService();
  ReplicatedMapEventPublishingService eventPublishingService=service.getEventPublishingService();
  final EntryListener listener=new ClientReplicatedMapEntryListener();
  String registrationId;
  if (predicate == null) {
    registrationId=eventPublishingService.addEventListener(listener,new ReplicatedEntryEventFilter(key),mapName);
  }
 else {
    registrationId=eventPublishingService.addEventListener(listener,new ReplicatedQueryEventFilter(key,predicate),mapName);
  }
  endpoint.addListenerDestroyAction(ReplicatedMapService.SERVICE_NAME,mapName,registrationId);
  return registrationId;
}

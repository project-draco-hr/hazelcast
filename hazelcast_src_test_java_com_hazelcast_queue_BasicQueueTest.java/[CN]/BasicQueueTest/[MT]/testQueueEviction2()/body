{
  TestHazelcastInstanceFactory factory=createHazelcastInstanceFactory(1);
  final Config config=new Config();
  config.getQueueConfig("q2").setEmptyQueueTtl(0);
  final HazelcastInstance hz=factory.newHazelcastInstance(config);
  final CountDownLatch latch=new CountDownLatch(2);
  hz.addDistributedObjectListener(new DistributedObjectListener(){
    public void distributedObjectCreated(    DistributedObjectEvent event){
      latch.countDown();
    }
    public void distributedObjectDestroyed(    DistributedObjectEvent event){
      latch.countDown();
    }
  }
);
  final IQueue<Object> q=hz.getQueue("q2");
  q.offer("item");
  q.poll();
  assertTrue(latch.await(10,TimeUnit.SECONDS));
}

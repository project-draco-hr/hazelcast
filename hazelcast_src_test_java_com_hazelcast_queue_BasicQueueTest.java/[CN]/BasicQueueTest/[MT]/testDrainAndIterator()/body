{
  final String name="defQueue";
  Config config=new Config();
  final int count=100;
  config.getQueueConfig(name).setMaxSize(count);
  final int insCount=4;
  TestHazelcastInstanceFactory factory=createHazelcastInstanceFactory(insCount);
  final HazelcastInstance[] instances=factory.newInstances(config);
  for (int i=0; i < 10; i++) {
    getQueue(instances,name).offer("item" + i);
  }
  Iterator iter=getQueue(instances,name).iterator();
  int i=0;
  while (iter.hasNext()) {
    Object o=iter.next();
    assertEquals(o,"item" + i++);
  }
  Object[] array=getQueue(instances,name).toArray();
  for (i=0; i < array.length; i++) {
    Object o=array[i];
    assertEquals(o,"item" + i++);
  }
  String[] arr=new String[5];
  IQueue<String> q=getQueue(instances,name);
  arr=q.toArray(arr);
  assertEquals(arr.length,10);
  for (i=0; i < arr.length; i++) {
    Object o=arr[i];
    assertEquals(o,"item" + i++);
  }
  List list=new ArrayList(4);
  getQueue(instances,name).drainTo(list,4);
  assertEquals(list.remove(0),"item0");
  assertEquals(list.remove(0),"item1");
  assertEquals(list.remove(0),"item2");
  assertEquals(list.remove(0),"item3");
  assertEquals(list.size(),0);
  getQueue(instances,name).drainTo(list);
  assertEquals(list.size(),6);
  assertEquals(list.remove(0),"item4");
}

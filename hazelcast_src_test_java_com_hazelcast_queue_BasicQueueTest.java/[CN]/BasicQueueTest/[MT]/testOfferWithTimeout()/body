{
  final String name="testOfferWithTimeout";
  Config config=new Config();
  final int count=100;
  config.getQueueConfig(name).setMaxSize(count);
  HazelcastInstance instance=createHazelcastInstance(config);
  final IQueue<String> queue=instance.getQueue(name);
  OfferThread offerThread=new OfferThread(queue);
  for (int i=0; i < 100; i++) {
    queue.offer("item" + i);
  }
  assertSizeEventually(100,queue);
  assertFalse(queue.offer("rejected"));
  offerThread.start();
  queue.poll();
  assertTrue(queue.contains("waiting"));
  assertSizeEventually(100,queue);
}

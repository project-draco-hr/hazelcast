{
  int value=RESIDUE_UPDATER.getAndIncrement(this);
  if (value >= BLOCK_SIZE) {
synchronized (this) {
      value=residue;
      if (value >= BLOCK_SIZE) {
        LOCAL_UPDATER.set(this,blockGenerator.getAndIncrement());
        RESIDUE_UPDATER.set(this,0);
      }
      return newId();
    }
  }
  return local * BLOCK_SIZE + value;
}

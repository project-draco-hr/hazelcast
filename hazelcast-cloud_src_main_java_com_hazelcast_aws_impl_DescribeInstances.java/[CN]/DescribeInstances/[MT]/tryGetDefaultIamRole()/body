{
  InputStreamReader is=null;
  BufferedReader reader=null;
  if (!awsConfig.getIamRole().equals("DEFAULT")) {
    return;
  }
  try {
    String query="latest/meta-data/iam/security-credentials/";
    URL url;
    url=new URL("http",IAM_ROLE_ENDPOINT,query);
    is=new InputStreamReader(url.openStream(),"UTF-8");
    reader=new BufferedReader(is);
    awsConfig.setIamRole(reader.readLine());
  }
 catch (  IOException e) {
    throw new InvalidConfigurationException("Invalid Aws Configuration");
  }
 finally {
    if (is != null) {
      is.close();
    }
    if (reader != null) {
      reader.close();
    }
  }
}

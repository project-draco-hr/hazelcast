{
  try {
    String query="latest/meta-data/iam/security-credentials/" + awsConfig.getIamRole();
    URL url=new URL("http",IAM_ROLE_ENDPOINT,query);
    InputStreamReader is=new InputStreamReader(url.openStream(),"UTF-8");
    BufferedReader reader=new BufferedReader(is);
    Map<String,String> map=parseIamRole(reader);
    awsConfig.setAccessKey(map.get("AccessKeyId"));
    awsConfig.setSecretKey(map.get("SecretAccessKey"));
    attributes.put("X-Amz-Security-Token",map.get("Token"));
  }
 catch (  IOException io) {
    throw new InvalidConfigurationException("Invalid Aws Configuration");
  }
}

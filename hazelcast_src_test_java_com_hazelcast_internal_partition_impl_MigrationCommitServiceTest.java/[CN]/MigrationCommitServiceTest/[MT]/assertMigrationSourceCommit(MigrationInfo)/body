{
  final MigrationEventCollectingService service=getService(migration.getSource());
  final String msg=getAssertMessage(migration,service);
  final PartitionMigrationEvent beforeEvent=service.getBeforeEvents().get(0);
  final PartitionMigrationEvent sourceCommitEvent=service.getCommitEvents().get(0);
  assertSourcePartitionMigrationEvent(msg,beforeEvent,migration);
  assertSourcePartitionMigrationEvent(msg,sourceCommitEvent,migration);
  assertReplicaVersionsAndServiceData(msg,migration.getSource(),migration.getPartitionId(),migration.getSourceNewReplicaIndex());
}

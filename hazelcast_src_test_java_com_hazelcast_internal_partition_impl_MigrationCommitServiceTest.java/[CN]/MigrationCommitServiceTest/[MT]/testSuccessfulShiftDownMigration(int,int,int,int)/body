{
  final Address destination=clearReplicaIndex(partitionId,replicaIndexToClear);
  final MigrationInfo migration=createMoveCopyBackMigration(partitionId,oldReplicaIndex,newReplicaIndex,destination);
  migrateWithSuccess(migration);
  assertMigrationSourceCommit(migration);
  assertMigrationDestinationCommit(migration);
  final Address oldReplicaOwner=migration.getOldBackupReplicaOwner();
  if (oldReplicaOwner != null) {
    assertTrueEventually(new AssertTask(){
      @Override public void run() throws Exception {
        final MigrationEventCollectingService service=getService(oldReplicaOwner);
        final List<Integer> clearPartitionIds=service.getClearPartitionIds();
        assertTrue(clearPartitionIds.size() == 1);
        assertEquals(partitionId,(int)clearPartitionIds.get(0));
      }
    }
);
  }
  assertPartitionDataAfterMigrations();
}

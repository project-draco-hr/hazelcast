{
  FutureImpl future=new FutureImpl(nodeEngine,logger);
  final Object result="result";
  future.setResult(result);
  final ExecutionCallback callback=mock(ExecutionCallback.class);
  future.andThen(callback,executor);
  assertSame(result,future.state);
  assertTrueEventually(new AssertTask(){
    @Override public void run() throws Exception {
      verify(callback).onResponse(result);
    }
  }
);
}

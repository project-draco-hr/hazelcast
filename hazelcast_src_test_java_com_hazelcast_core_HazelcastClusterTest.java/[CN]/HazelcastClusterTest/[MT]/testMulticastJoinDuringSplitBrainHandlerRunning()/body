{
  Properties props=new Properties();
  props.setProperty(GroupProperties.PROP_WAIT_SECONDS_BEFORE_JOIN,"5");
  props.setProperty(GroupProperties.PROP_MERGE_FIRST_RUN_DELAY_SECONDS,"0");
  props.setProperty(GroupProperties.PROP_MERGE_NEXT_RUN_DELAY_SECONDS,"0");
  final CountDownLatch latch=new CountDownLatch(1);
  Config config1=new Config();
  config1.setPort(5901);
  config1.setProperties(props);
  config1.addListenerConfig(new ListenerConfig(new LifecycleListener(){
    public void stateChanged(    final LifecycleEvent event){
      System.out.println(event);
      if (event.getState() == LifecycleState.RESTARTING || event.getState() == LifecycleState.RESTARTED) {
        latch.countDown();
      }
    }
  }
));
  Hazelcast.newHazelcastInstance(config1);
  Thread.sleep(5000);
  Config config2=new Config();
  config2.setPort(5701);
  config2.setProperties(props);
  Hazelcast.newHazelcastInstance(config2);
  assertFalse("Latch should not be countdown!",latch.await(3,TimeUnit.SECONDS));
}

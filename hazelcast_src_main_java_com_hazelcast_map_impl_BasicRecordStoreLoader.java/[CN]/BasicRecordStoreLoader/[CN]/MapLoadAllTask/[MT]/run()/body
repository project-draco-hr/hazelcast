{
  final NodeEngine nodeEngine=mapServiceContext.getNodeEngine();
  try {
    Map values=mapDataStore.loadAll(keys.values());
    if (values == null || values.isEmpty()) {
      decrementCounterAndMarkAsLoaded();
      return;
    }
    final MapEntrySet entrySet=new MapEntrySet();
    for (    Data dataKey : keys.keySet()) {
      Object key=keys.get(dataKey);
      Object value=values.get(key);
      if (value != null) {
        Data dataValue=mapServiceContext.toData(value);
        entrySet.add(dataKey,dataValue);
      }
    }
    PutAllOperation operation=new PutAllOperation(name,entrySet,true);
    final OperationService operationService=nodeEngine.getOperationService();
    operationService.createInvocationBuilder(MapService.SERVICE_NAME,operation,partitionId).setCallback(new Callback<Object>(){
      @Override public void notify(      Object obj){
        if (obj instanceof Throwable) {
          return;
        }
        decrementCounterAndMarkAsLoaded();
      }
    }
).invoke();
  }
 catch (  Throwable t) {
    decrementCounterAndMarkAsLoaded();
    logger.warning("Exception while load all task:" + t.toString());
    callback.notify(t);
  }
}

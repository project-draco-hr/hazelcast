{
  OutOfMemoryHandler handler=mock(OutOfMemoryHandler.class);
  OutOfMemoryError oome=new OutOfMemoryError();
  HazelcastInstance hz1=mock(HazelcastInstance.class);
  OutOfMemoryErrorDispatcher.register(hz1);
  OutOfMemoryErrorDispatcher.addHandler(handler);
  HazelcastInstance[] registeredInstances=OutOfMemoryErrorDispatcher.current();
  OutOfMemoryErrorDispatcher.onOutOfMemory(oome);
  verify(handler).onOutOfMemory(oome,registeredInstances);
  assertArrayEquals(new HazelcastInstance[]{},OutOfMemoryErrorDispatcher.current());
}

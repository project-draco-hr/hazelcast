{
  if (record instanceof KeyAwareTransactionLogRecord) {
    KeyAwareTransactionLogRecord keyAwareRecord=(KeyAwareTransactionLogRecord)record;
    TransactionLogRecord removed=recordMap.remove(keyAwareRecord.getKey());
    if (removed != null) {
      recordList.remove(removed);
    }
  }
  recordList.add(record);
  if (record instanceof KeyAwareTransactionLogRecord) {
    KeyAwareTransactionLogRecord keyAwareRecord=(KeyAwareTransactionLogRecord)record;
    recordMap.put(keyAwareRecord.getKey(),keyAwareRecord);
  }
}

{
  SerializationService serializationService=nodeEngine.getSerializationService();
  PagingPredicate pagingPredicate=predicate instanceof PagingPredicate ? (PagingPredicate)predicate : null;
  List<QueryableEntry> resultList=new LinkedList<QueryableEntry>();
  PartitionContainer container=mapServiceContext.getPartitionContainer(partitionId);
  Iterator<Record> iterator=container.getRecordStore(mapName).loadAwareIterator(getNow(),false);
  while (iterator.hasNext()) {
    Record record=iterator.next();
    Data key=record.getKey();
    Object value=getValueOrCachedValue(record);
    if (value == null) {
      continue;
    }
    QueryEntry queryEntry=new QueryEntry(serializationService,key,key,value);
    if (predicate.apply(queryEntry)) {
      resultList.add(queryEntry);
    }
  }
  return SortingUtil.getSortedSubList(resultList,pagingPredicate);
}

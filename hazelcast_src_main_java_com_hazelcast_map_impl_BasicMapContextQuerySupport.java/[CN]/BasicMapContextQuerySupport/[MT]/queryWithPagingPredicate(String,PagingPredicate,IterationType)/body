{
  pagingPredicate.setIterationType(iterationType);
  ArrayList<Map.Entry> resultList=new ArrayList<Map.Entry>();
  Set<Integer> partitionIds=getAllPartitionIds();
  try {
    List<Future<QueryResult>> futures=queryOnMembers(mapName,pagingPredicate);
    addResultsOfPagingPredicate(futures,resultList,partitionIds);
    if (partitionIds.isEmpty()) {
      return getSortedQueryResultSet(resultList,pagingPredicate,iterationType);
    }
  }
 catch (  Throwable t) {
    if (t.getCause() instanceof QueryResultSizeExceededException) {
      throw ExceptionUtil.rethrow(t);
    }
    logger.warning("Could not get results",t);
  }
  try {
    List<Future<QueryResult>> futures=queryOnPartitions(mapName,pagingPredicate,partitionIds);
    addResultsOfPagingPredicate(futures,resultList,partitionIds);
  }
 catch (  Throwable t) {
    throw ExceptionUtil.rethrow(t);
  }
  return getSortedQueryResultSet(resultList,pagingPredicate,iterationType);
}

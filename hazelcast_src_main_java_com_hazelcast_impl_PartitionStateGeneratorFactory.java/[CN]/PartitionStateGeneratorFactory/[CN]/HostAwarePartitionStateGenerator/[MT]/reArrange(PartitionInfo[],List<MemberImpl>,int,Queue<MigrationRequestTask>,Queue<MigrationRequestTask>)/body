{
  final ClusterPartitionRegistry registry=new PerHostPartitionRegistry();
  PartitionInfo[] newState=arrange(members,partitionCount,registry,new CopyStateInitializer(currentState));
  finalizeArrangement(currentState,newState,members.size(),registry.getMaxReplicaCount(),migrationQueue,replicaQueue);
  return newState;
}

{
  this.name=name;
  this.partitionId=partitionId;
  this.nodeEngine=nodeEngine;
  this.cacheService=cacheService;
  this.cacheConfig=cacheService.getCacheConfig(name);
  if (this.cacheConfig == null) {
    throw new IllegalStateException("Cache is not exist !");
  }
  if (cacheConfig.getCacheLoaderFactory() != null) {
    final Factory<CacheLoader> cacheLoaderFactory=cacheConfig.getCacheLoaderFactory();
    cacheLoader=cacheLoaderFactory.create();
  }
  if (cacheConfig.getCacheWriterFactory() != null) {
    final Factory<CacheWriter> cacheWriterFactory=cacheConfig.getCacheWriterFactory();
    cacheWriter=cacheWriterFactory.create();
  }
  if (cacheConfig.isStatisticsEnabled()) {
    this.statistics=cacheService.createCacheStatIfAbsent(name);
  }
  this.defaultExpiryPolicy=expiryPolicy != null ? expiryPolicy : (ExpiryPolicy)cacheConfig.getExpiryPolicyFactory().create();
  this.records=createRecordCacheMap();
  this.evictionPolicy=evictionPolicy != null ? evictionPolicy : cacheConfig.getEvictionPolicy();
  this.evictionEnabled=evictionPolicy != EvictionPolicy.NONE;
  this.evictionPercentage=evictionPercentage;
  this.evictionThreshold=(float)Math.max(1,ONE_HUNDRED_PERCENT - evictionThresholdPercentage) / ONE_HUNDRED_PERCENT;
  this.records=createRecordCacheMap();
}

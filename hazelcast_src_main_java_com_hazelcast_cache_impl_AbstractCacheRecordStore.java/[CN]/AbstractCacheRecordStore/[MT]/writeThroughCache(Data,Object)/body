{
  if (isWriteThrough() && cacheWriter != null) {
    try {
      final Object objKey=dataToValue(key);
      final Object objValue;
switch (cacheConfig.getInMemoryFormat()) {
case BINARY:
        objValue=toValue(value);
      break;
case OBJECT:
    objValue=toValue(value);
  break;
case OFFHEAP:
objValue=toValue(value);
break;
default :
throw new IllegalArgumentException("Invalid storage format: " + cacheConfig.getInMemoryFormat());
}
CacheEntry<?,?> entry=new CacheEntry<Object,Object>(objKey,objValue);
cacheWriter.write(entry);
}
 catch (Exception e) {
if (!(e instanceof CacheWriterException)) {
throw new CacheWriterException("Exception in CacheWriter during write",e);
}
 else {
throw (CacheWriterException)e;
}
}
}
}

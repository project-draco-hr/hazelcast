{
  if (maxSizeConfig == null) {
    return null;
  }
  final MaxSizeConfig.MaxSizePolicy maxSizePolicy=maxSizeConfig.getMaxSizePolicy();
  if (maxSizePolicy == null) {
    return null;
  }
  if (maxSizePolicy == MaxSizeConfig.MaxSizePolicy.PER_NODE) {
    return new PerNodeMaxSizeChecker(maxSizeConfig);
  }
 else   if (maxSizePolicy == MaxSizeConfig.MaxSizePolicy.PER_PARTITION) {
    return new PerPartitionMaxSizeChecker(maxSizeConfig);
  }
  return null;
}

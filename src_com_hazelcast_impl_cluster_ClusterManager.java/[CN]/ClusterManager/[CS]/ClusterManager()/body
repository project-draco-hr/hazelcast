{
  ClusterService.get().registerPeriodicRunnable(new Runnable(){
    public void run(){
      heartBeater();
    }
  }
);
  ClusterService.get().registerPeriodicRunnable(new Runnable(){
    public void run(){
      checkScheduledActions();
    }
  }
);
  ConnectionManager.get().addConnectionListener(this);
  ClusterService.get().registerPacketProcessor(ClusterOperation.RESPONSE,new PacketProcessor(){
    public void process(    Packet packet){
      handleResponse(packet);
    }
  }
);
  ClusterService.get().registerPacketProcessor(ClusterOperation.HEARTBEAT,new PacketProcessor(){
    public void process(    Packet packet){
      packet.returnToContainer();
    }
  }
);
  ClusterService.get().registerPacketProcessor(ClusterOperation.REMOTELY_PROCESS_AND_RESPOND,new PacketProcessor(){
    public void process(    Packet packet){
      Data data=BufferUtil.doTake(packet.value);
      RemotelyProcessable rp=(RemotelyProcessable)ThreadContext.get().toObject(data);
      rp.setConnection(packet.conn);
      rp.process();
      sendResponse(packet);
    }
  }
);
  ClusterService.get().registerPacketProcessor(ClusterOperation.REMOTELY_PROCESS,new PacketProcessor(){
    public void process(    Packet packet){
      Data data=BufferUtil.doTake(packet.value);
      RemotelyProcessable rp=(RemotelyProcessable)ThreadContext.get().toObject(data);
      rp.setConnection(packet.conn);
      rp.process();
      packet.returnToContainer();
    }
  }
);
  ClusterService.get().registerPacketProcessor(ClusterOperation.REMOTELY_CALLABLE_BOOLEAN,new PacketProcessor(){
    public void process(    Packet packet){
      Boolean result;
      try {
        Data data=BufferUtil.doTake(packet.value);
        AbstractRemotelyCallable<Boolean> callable=(AbstractRemotelyCallable<Boolean>)ThreadContext.get().toObject(data);
        callable.setConnection(packet.conn);
        result=callable.call();
      }
 catch (      Exception e) {
        e.printStackTrace(System.out);
        result=Boolean.FALSE;
      }
      if (result == Boolean.TRUE) {
        sendResponse(packet);
      }
 else {
        sendResponseFailure(packet);
      }
    }
  }
);
  ClusterService.get().registerPacketProcessor(ClusterOperation.REMOTELY_CALLABLE_OBJECT,new PacketProcessor(){
    public void process(    Packet packet){
      Object result;
      try {
        Data data=BufferUtil.doTake(packet.value);
        AbstractRemotelyCallable callable=(AbstractRemotelyCallable)ThreadContext.get().toObject(data);
        callable.setConnection(packet.conn);
        result=callable.call();
      }
 catch (      Exception e) {
        e.printStackTrace(System.out);
        result=null;
      }
      if (result != null) {
        Data value;
        if (result instanceof Data) {
          value=(Data)result;
        }
 else {
          value=ThreadContext.get().toData(result);
        }
        BufferUtil.doSet(value,packet.value);
      }
      sendResponse(packet);
    }
  }
);
}

{
  Config config1=new Config();
  config1.setProperty(GroupProperty.MERGE_FIRST_RUN_DELAY_SECONDS,"5");
  config1.setProperty(GroupProperty.MERGE_NEXT_RUN_DELAY_SECONDS,"3");
  String firstGroupName=generateRandomString(10);
  config1.getGroupConfig().setName(firstGroupName);
  NetworkConfig networkConfig1=config1.getNetworkConfig();
  JoinConfig join1=networkConfig1.getJoin();
  join1.getMulticastConfig().setEnabled(true);
  join1.getTcpIpConfig().addMember("127.0.0.1");
  Config config2=new Config();
  config2.setProperty(GroupProperty.MERGE_FIRST_RUN_DELAY_SECONDS,"5");
  config2.setProperty(GroupProperty.MERGE_NEXT_RUN_DELAY_SECONDS,"3");
  String secondGroupName=generateRandomString(10);
  config2.getGroupConfig().setName(secondGroupName);
  NetworkConfig networkConfig2=config2.getNetworkConfig();
  JoinConfig join2=networkConfig2.getJoin();
  join2.getMulticastConfig().setEnabled(true);
  join2.getTcpIpConfig().addMember("127.0.0.1");
  HazelcastInstance h1=Hazelcast.newHazelcastInstance(config1);
  HazelcastInstance h2=Hazelcast.newHazelcastInstance(config2);
  LifecycleCountingListener l=new LifecycleCountingListener();
  h2.getLifecycleService().addLifecycleListener(l);
  assertEquals(1,h1.getCluster().getMembers().size());
  assertEquals(1,h2.getCluster().getMembers().size());
  HazelcastTestSupport.sleepSeconds(10);
  assertEquals(0,l.getCount(LifecycleState.MERGING));
  assertEquals(0,l.getCount(LifecycleState.MERGED));
  assertEquals(1,h1.getCluster().getMembers().size());
  assertEquals(1,h2.getCluster().getMembers().size());
}

{
  final MapService mapService=mapContainer.getMapService();
  final MapStoreWrapper store=mapContainer.getStore();
  final SerializationService serializationService=mapService.getNodeEngine().getSerializationService();
  final int writeDelaySeconds=mapContainer.getMapConfig().getMapStoreConfig().getWriteDelaySeconds();
  final long millis=MapService.convertTime(writeDelaySeconds,TimeUnit.SECONDS);
  final int capacity=mapService.getNodeEngine().getGroupProperties().MAP_WRITE_BEHIND_QUEUE_CAPACITY.getInteger();
  final AtomicInteger writeBehindQueueItemCounter=mapService.getWriteBehindQueueItemCounter();
  final WriteBehindMapDataStore mapDataStore=new WriteBehindMapDataStore(store,serializationService,millis,partitionId,capacity,writeBehindQueueItemCounter);
  mapDataStore.setWriteBehindProcessor(writeBehindProcessor);
  return (MapDataStore<K,V>)mapDataStore;
}

{
  Deflater def=new Deflater();
  def.setInput(data);
  def.finish();
  InflatingPipedBuffer infBuffer=PipedZipBufferFactory.createInflatingBuffer(compressedDataLength);
  int k=def.deflate(infBuffer.getInputBuffer().array());
  int k2=infBuffer.inflate(k);
  Assert.assertEquals("Inflated data length should be equal to actual data length!",data.length,k2);
  byte[] data2=new byte[data.length];
  System.arraycopy(infBuffer.getOutputBuffer().array(),0,data2,0,k2);
  Assert.assertTrue("Inflated data should be equal to actual data!",Arrays.equals(data,data2));
}

{
  final ClientConnection conn=(ClientConnection)connection;
  ClientInvocationService invocationService=client.getInvocationService();
  conn.incrementPacketCount();
  if (message.isFlagSet(ClientMessage.LISTENER_EVENT_FLAG)) {
    final ClientListenerServiceImpl listenerService=(ClientListenerServiceImpl)client.getListenerService();
    listenerService.handleClientMessage(message);
  }
 else {
    invocationService.handleClientMessage(message,connection);
  }
}

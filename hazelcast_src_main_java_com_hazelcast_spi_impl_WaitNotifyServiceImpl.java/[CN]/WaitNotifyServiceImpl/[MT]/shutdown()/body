{
  logger.log(Level.FINEST,"Stopping tasks...");
  expirationTask.cancel(true);
  expirationService.shutdown();
  final Object response=new HazelcastInstanceNotActiveException();
  final Address thisAddress=nodeEngine.getThisAddress();
  for (  Queue<WaitingOp> q : mapWaitingOps.values()) {
    for (    WaitingOp waitingOp : q) {
      if (waitingOp.isValid()) {
        final Operation op=waitingOp.getOperation();
        if (thisAddress.equals(op.getCallerAddress())) {
          op.getResponseHandler().sendResponse(response);
        }
      }
    }
    q.clear();
  }
  mapWaitingOps.clear();
}

{
  final ClientEndpoint clientEndpoint=getClientEndpoint(packet.conn);
  boolean includeValue=(int)packet.longValue == 1;
  if (getInstanceType(packet.name).equals(InstanceType.MAP)) {
    IMap<Object,Object> map=(IMap)factory.getOrCreateProxyByName(packet.name);
    clientEndpoint.addThisAsListener(map,packet.getKeyData(),includeValue);
  }
 else   if (getInstanceType(packet.name).equals(InstanceType.LIST)) {
    ListProxyImpl listProxy=(ListProxyImpl)factory.getOrCreateProxyByName(packet.name);
    IMap map=(IMap)factory.getOrCreateProxyByName(Prefix.MAP + (String)listProxy.getId());
    clientEndpoint.addThisAsListener(map,null,true);
  }
 else   if (getInstanceType(packet.name).equals(InstanceType.SET)) {
    SetProxy collectionProxy=(SetProxy)factory.getOrCreateProxyByName(packet.name);
    IMap map=collectionProxy.getMProxy();
    clientEndpoint.addThisAsListener(map,null,includeValue);
  }
 else   if (getInstanceType(packet.name).equals(InstanceType.QUEUE)) {
    IQueue<Object> queue=(IQueue)factory.getOrCreateProxyByName(packet.name);
    final String packetName=packet.name;
    ItemListener itemListener=new ClientItemListener(clientEndpoint,packetName);
    queue.addItemListener(itemListener,includeValue);
    clientEndpoint.queueItemListeners.put(queue,itemListener);
  }
 else   if (getInstanceType(packet.name).equals(InstanceType.TOPIC)) {
    ITopic<Object> topic=(ITopic)factory.getOrCreateProxyByName(packet.name);
    final String packetName=packet.name;
    MessageListener messageListener=new ClientMessageListener(clientEndpoint,packetName);
    topic.addMessageListener(messageListener);
    clientEndpoint.messageListeners.put(topic,messageListener);
  }
  packet.clearForResponse();
}

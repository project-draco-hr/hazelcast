{
  try {
    String name=packet.name;
    ExecutorService executorService=factory.getExecutorService(name);
    ClientDistributedTask cdt=(ClientDistributedTask)toObject(packet.getKeyData());
    DistributedTask task;
    if (cdt.getKey() != null) {
      task=new DistributedTask(cdt.getCallable(),cdt.getKey());
    }
 else     if (cdt.getMember() != null) {
      task=new DistributedTask(cdt.getCallable(),cdt.getMember());
    }
 else     if (cdt.getMembers() != null) {
      task=new MultiTask(cdt.getCallable(),cdt.getMembers());
    }
 else {
      task=new DistributedTask(cdt.getCallable());
    }
    final ClientEndpoint clientEndpoint=getClientEndpoint(packet.conn);
    clientEndpoint.storeTask(packet.callId,task);
    task.setExecutionCallback(new ExecutionCallback(){
      public void done(      Future future){
        Object result;
        try {
          clientEndpoint.removeTask(packet.callId);
          result=future.get();
          packet.setValue(toData(result));
        }
 catch (        InterruptedException e) {
          return;
        }
catch (        CancellationException e) {
          packet.setValue(toData(e));
        }
catch (        ExecutionException e) {
          packet.setValue(toData(e));
        }
        sendResponse(packet);
      }
    }
);
    executorService.execute(task);
  }
 catch (  RuntimeException e) {
    logger.log(Level.WARNING,"exception during handling " + packet.operation + ": "+ e.getMessage(),e);
    packet.clearForResponse();
    packet.setValue(toData(e));
  }
}

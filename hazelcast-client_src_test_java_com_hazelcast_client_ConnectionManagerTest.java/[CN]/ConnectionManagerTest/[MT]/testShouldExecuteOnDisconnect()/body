{
  HazelcastClient client=mock(HazelcastClient.class);
  InetSocketAddress inetSocketAddress=new InetSocketAddress("localhost",5701);
  final Connection connection=mock(Connection.class);
  final List<LifecycleState> lifecycleEvents=new ArrayList<LifecycleState>();
  final LifecycleServiceClientImpl lifecycleService=createLifecycleServiceClientImpl(client,lifecycleEvents);
  ConnectionManager connectionManager=new ConnectionManager(client,credentials,lifecycleService,inetSocketAddress,60000){
    protected Connection getNextConnection(){
      return connection;
    }
  }
;
  assertTrue(connectionManager.shouldExecuteOnDisconnect(connection));
  assertFalse(connectionManager.shouldExecuteOnDisconnect(connection));
  assertArrayEquals(new Object[0],lifecycleEvents.toArray());
}

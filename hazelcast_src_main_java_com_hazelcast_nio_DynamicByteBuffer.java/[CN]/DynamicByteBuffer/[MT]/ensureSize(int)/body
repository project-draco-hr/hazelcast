{
  check();
  if (buffer.remaining() < i) {
    int newCap=Math.max(buffer.limit() << 1,buffer.limit() + i);
    ByteBuffer newBuffer=buffer.isDirect() ? ByteBuffer.allocateDirect(newCap) : ByteBuffer.allocate(newCap);
    newBuffer.order(buffer.order());
    buffer.flip();
    newBuffer.put(buffer);
    buffer=newBuffer;
  }
}

{
  ClientEndpoint endpoint=getEndpoint();
  OperationFactory operationFactory=createOperationFactory();
  Collection<Address> targets=getTargets();
  if (targets.isEmpty()) {
    endpoint.sendResponse(reduce(new HashMap<Address,Object>()),getCallId());
    return;
  }
  MultiTargetCallback callback=new MultiTargetCallback(targets);
  for (  Address target : targets) {
    Operation op=operationFactory.createOperation();
    op.setCallerUuid(endpoint.getUuid());
    InvocationBuilder builder=clientEngine.createInvocationBuilder(getServiceName(),op,target).setTryCount(TRY_COUNT).setCallback(new SingleTargetCallback(target,callback));
    builder.invoke();
  }
}

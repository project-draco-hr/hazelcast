{
  final ClientEndpoint endpoint=getEndpoint();
  OperationFactory operationFactory=createOperationFactory();
  Collection<Address> targets=getTargets();
  if (targets.isEmpty()) {
    clientEngine.sendResponse(getEndpoint(),reduce(new HashMap<Address,Object>()));
    return;
  }
  MultiTargetCallback callback=new MultiTargetCallback(targets);
  for (  Address target : targets) {
    final Operation op=operationFactory.createOperation();
    op.setCallerUuid(endpoint.getUuid());
    final InvocationBuilder builder=clientEngine.createInvocationBuilder(getServiceName(),op,target).setTryCount(100).setCallback(new SingleTargetCallback(target,callback));
    builder.invoke();
  }
}

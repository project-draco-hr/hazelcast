{
  if (threadId != Thread.currentThread().getId()) {
    throw new IllegalStateException("Transaction cannot span multiple threads!");
  }
}

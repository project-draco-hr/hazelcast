{
  while (running) {
    Object obj=null;
    try {
      lsBuffer.clear();
      queue.drainTo(lsBuffer);
      final int size=lsBuffer.size();
      if (size > 0) {
        for (int i=0; i < size; i++) {
          obj=lsBuffer.get(i);
          checkPeriodics();
          process(obj);
        }
        lsBuffer.clear();
      }
 else {
        obj=queue.poll(100,TimeUnit.MILLISECONDS);
        checkPeriodics();
        if (obj != null) {
          process(obj);
        }
      }
    }
 catch (    final InterruptedException e) {
      Node.get().handleInterruptedException(Thread.currentThread(),e);
    }
catch (    final Throwable e) {
      logger.log(Level.FINEST,e + ",  message: " + e+ ", obj="+ obj,e);
    }
  }
  lsBuffer.clear();
  queue.clear();
}

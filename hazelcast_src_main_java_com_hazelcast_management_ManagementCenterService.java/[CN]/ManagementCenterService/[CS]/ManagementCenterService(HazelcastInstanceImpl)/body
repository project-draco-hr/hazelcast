{
  this.instance=instance;
  logger=this.instance.node.getLogger(ManagementCenterService.class.getName());
  managementCenterConfig=this.instance.node.config.getManagementCenterConfig();
  if (managementCenterConfig == null) {
    throw new IllegalStateException("ManagementCenterConfig should not be null!");
  }
  this.instance.getLifecycleService().addLifecycleListener(this);
  this.instance.getCluster().addMembershipListener(this);
  this.instanceFilterMap=new StatsInstanceFilter(instance.node.getGroupProperties().MC_MAP_EXCLUDES.getString());
  this.instanceFilterQueue=new StatsInstanceFilter(instance.node.getGroupProperties().MC_QUEUE_EXCLUDES.getString());
  this.instanceFilterTopic=new StatsInstanceFilter(instance.node.getGroupProperties().MC_TOPIC_EXCLUDES.getString());
  maxVisibleInstanceCount=this.instance.node.groupProperties.MC_MAX_INSTANCE_COUNT.getInteger();
  commandHandler=new ConsoleCommandHandler(this.instance);
  String tmpWebServerUrl=managementCenterConfig.getUrl();
  webServerUrl=tmpWebServerUrl != null ? (!tmpWebServerUrl.endsWith("/") ? tmpWebServerUrl + '/' : tmpWebServerUrl) : tmpWebServerUrl;
  updateIntervalMs=(managementCenterConfig.getUpdateInterval() > 0) ? managementCenterConfig.getUpdateInterval() * 1000 : 5000;
  taskPoller=new TaskPoller();
  stateSender=new StateSender();
  serializationService=new SerializationServiceImpl(1,null);
}

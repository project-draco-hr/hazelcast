{
  URL url=newCollectorUrl();
  try {
    HttpURLConnection connection=openConnection(url);
    OutputStream outputStream=connection.getOutputStream();
    final OutputStreamWriter writer=new OutputStreamWriter(outputStream,"UTF-8");
    try {
      JsonObject root=new JsonObject();
      root.add("identifier",identifier.toJson());
      TimedMemberState timedMemberState=timedMemberStateFactory.createTimedMemberState();
      root.add("timedMemberState",timedMemberState.toJson());
      root.writeTo(writer);
      writer.flush();
      outputStream.flush();
      post(connection);
      if (manCenterConnectionLost) {
        logger.info("Connection to management center restored.");
      }
      manCenterConnectionLost=false;
    }
  finally {
      closeResource(writer);
      closeResource(outputStream);
    }
  }
 catch (  ConnectException e) {
    if (!manCenterConnectionLost) {
      manCenterConnectionLost=true;
      if (logger.isFinestEnabled()) {
        logger.finest("Failed to connect to:" + url,e);
      }
 else {
        logger.info("Failed to connect to:" + url);
      }
    }
  }
catch (  Exception e) {
    logger.warning(e);
  }
}

{
  URL url=newCollectorUrl();
  try {
    HttpURLConnection connection=openConnection(url);
    OutputStream outputStream=connection.getOutputStream();
    try {
      identifier.write(outputStream);
      ObjectDataOutputStream out=serializationService.createObjectDataOutputStream(outputStream);
      TimedMemberState timedMemberState=timedMemberStateFactory.createTimedMemberState();
      timedMemberState.writeData(out);
      outputStream.flush();
      post(connection);
      if (manCenterConnectionLost) {
        logger.info("Connection to management center restored.");
      }
      manCenterConnectionLost=false;
    }
  finally {
      closeResource(outputStream);
    }
  }
 catch (  ConnectException e) {
    if (!manCenterConnectionLost) {
      manCenterConnectionLost=true;
      log("Failed to connect to:" + url,e);
    }
  }
catch (  Exception e) {
    logger.warning(e);
  }
}

{
  try {
    if (logFile == null) {
      logFile=new File(format(pathname,index));
      renderHead=true;
    }
    if (writer == null) {
      FileOutputStream fos=new FileOutputStream(logFile,true);
      writer=new BufferedWriter(new OutputStreamWriter(fos,UTF8));
    }
    if (renderHead) {
      headRenderer.render(writer);
      renderHead=false;
    }
    bodyRenderer.render(writer);
    writer.flush();
    lastModified=logFile.lastModified();
    if (logFile.length() > maxRollingFileSizeBytes) {
      closeResource(writer);
      writer=null;
      logFile=null;
      index++;
      deleteOld();
    }
  }
 catch (  IOException e) {
    logIOError(e);
    logFile=null;
    closeResource(writer);
    writer=null;
  }
}

{
  final int requiredDataSize=calculateDataSize(map);
  ClientMessage clientMessage=ClientMessage.createForEncode(requiredDataSize);
  clientMessage.setMessageType(TYPE.id());
  for (  Map.Entry<Integer,Data> entry : map.entrySet()) {
    clientMessage.set(entry.getKey());
    clientMessage.set(entry.getValue());
  }
  clientMessage.updateFrameLength();
  return clientMessage;
}

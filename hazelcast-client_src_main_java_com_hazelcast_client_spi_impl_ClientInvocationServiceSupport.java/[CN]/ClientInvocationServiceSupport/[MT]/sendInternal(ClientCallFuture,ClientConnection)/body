{
  connection.registerCallId(future);
  future.setConnection(connection);
  final SerializationService ss=client.getSerializationService();
  final ClientRequest request=future.getRequest();
  final Data data=ss.toData(request);
  Packet packet=new Packet(data,request.getPartitionId(),ss.getPortableContext());
  if (!isAllowedToSendRequest(connection,request) || !connection.write(packet)) {
    final int callId=request.getCallId();
    connection.deRegisterCallId(callId);
    connection.deRegisterEventHandler(callId);
    future.notify(new TargetNotMemberException("Address : " + connection.getRemoteEndpoint()));
  }
}

{
  if (tx.getState() != Transaction.State.ACTIVE) {
    throw new IllegalStateException("Transaction is not active!");
  }
  tx.addPartition(partitionId);
}

{
  VersionedValue versionedValue=lockAndGet(key,-1,10000);
  if (versionedValue == null) {
    throw new ConcurrentModificationException("Transaction couldn't obtain lock");
  }
  tx.addTransactionLog(new MapTransactionLog(name,key,new TxnPutOperation(name,key,value,-1),versionedValue.version));
  return versionedValue.value;
}

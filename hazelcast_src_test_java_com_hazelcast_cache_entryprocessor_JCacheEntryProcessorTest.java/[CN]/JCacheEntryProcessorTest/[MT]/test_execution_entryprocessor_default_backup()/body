{
  CachingProvider cachingProvider=HazelcastServerCachingProvider.createCachingProvider(hz1);
  CacheManager cacheManager=cachingProvider.getCacheManager();
  final String cacheName=randomString();
  CompleteConfiguration<Integer,String> config=new MutableConfiguration<Integer,String>().setTypes(Integer.class,String.class);
  Cache<Integer,String> cache=cacheManager.createCache(cacheName,config);
  cache.invoke(1,new SimpleEntryProcessor());
  final Data key=serializationService.toData(1);
  final int partitionId=hz1.getPartitionService().getPartition(1).getPartitionId();
  assertTrueEventually(new AssertTask(){
    @Override public void run() throws Exception {
      ICacheRecordStore recordStore1=getRecordStore(cacheServiceHz1,cacheName,partitionId);
      ICacheRecordStore recordStore2=getRecordStore(cacheServiceHz2,cacheName,partitionId);
      CacheRecord record1=recordStore1.getRecord(key);
      CacheRecord record2=recordStore2.getRecord(key);
      checkIfRecordsNull(record1,record2);
      Object value1=serializationService.toObject(record1.getValue());
      Object value2=serializationService.toObject(record2.getValue());
      assertEquals("Foo",value1);
      assertEquals("Foo",value2);
    }
  }
,timeoutSeconds());
}

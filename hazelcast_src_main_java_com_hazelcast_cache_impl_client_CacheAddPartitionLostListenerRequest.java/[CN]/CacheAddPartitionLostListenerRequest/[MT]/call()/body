{
  final ClientEndpoint endpoint=getEndpoint();
  final CachePartitionLostListener listener=new CachePartitionLostListener(){
    @Override public void partitionLost(    CachePartitionLostEvent event){
      if (endpoint.isAlive()) {
        final PortableCachePartitionLostEvent portableEvent=new PortableCachePartitionLostEvent(event.getPartitionId(),event.getMember().getUuid());
        endpoint.sendEvent(null,portableEvent,getCallId());
      }
    }
  }
;
  final InternalCachePartitionLostListenerAdapter listenerAdapter=new InternalCachePartitionLostListenerAdapter(listener);
  final EventFilter filter=new CachePartitionLostEventFilter();
  final ICacheService service=getService();
  final EventRegistration registration=service.getNodeEngine().getEventService().registerListener(AbstractCacheService.SERVICE_NAME,name,filter,listenerAdapter);
  final String registrationId=registration.getId();
  endpoint.addListenerDestroyAction(CacheService.SERVICE_NAME,name,registrationId);
  return registrationId;
}

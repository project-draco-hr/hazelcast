{
  if (bb == null) {
    bb=bufferProvider.takeEmptyBuffer();
  }
  if (!bb.hasRemaining()) {
    bufferProvider.addBuffer(bb);
    bb=bufferProvider.takeEmptyBuffer();
  }
  if (debug)   logger.log(Level.INFO,"writing byte " + (byte)b);
  bb.put((byte)b);
}

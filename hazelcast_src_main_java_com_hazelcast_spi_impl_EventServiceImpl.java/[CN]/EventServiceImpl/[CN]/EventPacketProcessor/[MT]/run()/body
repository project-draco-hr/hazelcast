{
  Data data=packet.getValue();
  EventPacket eventPacket=(EventPacket)nodeEngine.toObject(data);
  Object eventObject=eventPacket.event;
  if (eventObject instanceof Data) {
    eventObject=nodeEngine.toObject(eventObject);
  }
  final String serviceName=eventPacket.serviceName;
  EventPublishingService service=nodeEngine.getService(serviceName);
  if (service == null) {
    logger.log(Level.WARNING,"There is no service named: " + serviceName);
    return;
  }
  EventServiceSegment segment=getSegment(serviceName,false);
  if (segment == null) {
    logger.log(Level.WARNING,"No service registration found for " + serviceName);
    return;
  }
  Registration registration=segment.registrationIdMap.get(eventPacket.id);
  if (registration == null) {
    logger.log(Level.WARNING,"No registration found for " + serviceName + " / "+ eventPacket.id);
    return;
  }
  if (!registration.isLocal()) {
    logger.log(Level.WARNING,"Invalid target for  " + registration);
    return;
  }
  service.dispatchEvent(eventObject,registration.listener);
}

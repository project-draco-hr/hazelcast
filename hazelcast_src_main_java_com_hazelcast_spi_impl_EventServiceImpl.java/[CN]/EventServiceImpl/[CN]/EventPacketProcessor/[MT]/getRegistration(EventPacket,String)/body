{
  EventServiceSegment segment=getSegment(serviceName,false);
  if (segment == null) {
    if (nodeEngine.isActive()) {
      logger.warning("No service registration found for " + serviceName);
    }
    return null;
  }
  Registration registration=segment.registrationIdMap.get(eventPacket.id);
  if (registration == null) {
    if (nodeEngine.isActive()) {
      if (logger.isFinestEnabled()) {
        logger.finest("No registration found for " + serviceName + " / "+ eventPacket.id);
      }
    }
    return null;
  }
  if (!isLocal(registration)) {
    logger.severe("Invalid target for  " + registration);
    return null;
  }
  if (registration.listener == null) {
    logger.warning("Something seems wrong! Subscriber is local but listener instance is null! -> " + registration);
    return null;
  }
  return registration;
}

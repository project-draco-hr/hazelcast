{
  final String serviceName=eventPacket.serviceName;
  final EventServiceSegment segment=getSegment(serviceName,true);
  boolean sync=segment.incrementPublish() % 100000 == 0;
  if (sync) {
    Future f=nodeEngine.getOperationService().createInvocationBuilder(serviceName,new SendEventOperation(eventPacket,orderKey),subscriber).setTryCount(50).invoke();
    try {
      f.get(3,TimeUnit.SECONDS);
    }
 catch (    Exception ignored) {
    }
  }
 else {
    final Packet packet=new Packet(nodeEngine.toData(eventPacket),orderKey,nodeEngine.getPortableContext());
    packet.setHeader(Packet.HEADER_EVENT);
    nodeEngine.send(packet,subscriber);
  }
}

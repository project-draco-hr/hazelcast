{
  final String serviceName=eventPacket.serviceName;
  final EventServiceSegment segment=getSegment(serviceName,true);
  boolean sync=segment.incrementPublish() % 1000 == 0;
  if (sync) {
    Invocation inv=nodeEngine.getOperationService().createInvocationBuilder(serviceName,new SendEventOperation(eventPacket),subscriber).setTryCount(10).build();
    try {
      inv.invoke().get(5,TimeUnit.SECONDS);
    }
 catch (    Exception ignored) {
    }
  }
 else {
    final Packet packet=new Packet(nodeEngine.toData(eventPacket),nodeEngine.getSerializationContext());
    packet.setHeader(Packet.HEADER_EVENT,true);
    nodeEngine.send(packet,subscriber);
  }
}

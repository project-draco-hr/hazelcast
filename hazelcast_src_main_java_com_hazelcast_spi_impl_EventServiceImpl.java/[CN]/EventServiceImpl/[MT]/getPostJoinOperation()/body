{
  final Collection<Registration> registrations=new LinkedList<Registration>();
  for (  EventServiceSegment segment : segments.values()) {
    for (    Collection<Registration> all : segment.registrations.values()) {
      for (      Registration reg : all) {
        if (!reg.isLocalOnly()) {
          registrations.add(reg);
        }
      }
    }
  }
  return registrations.isEmpty() ? null : new PostJoinRegistrationOperation(registrations);
}

{
  final Map<Integer,DataSerializableFactory> factories=new HashMap<Integer,DataSerializableFactory>();
  factories.put(OFFER,new DataSerializableFactory(){
    public DataSerializable create(){
      return new OfferOperation();
    }
  }
);
  factories.put(OFFER_BACKUP,new DataSerializableFactory(){
    public DataSerializable create(){
      return new OfferBackupOperation();
    }
  }
);
  factories.put(POLL,new DataSerializableFactory(){
    public DataSerializable create(){
      return new PollOperation();
    }
  }
);
  factories.put(POLL_BACKUP,new DataSerializableFactory(){
    public DataSerializable create(){
      return new PollBackupOperation();
    }
  }
);
  factories.put(PEEK,new DataSerializableFactory(){
    public DataSerializable create(){
      return new PeekOperation();
    }
  }
);
  return factories;
}

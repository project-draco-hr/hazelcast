{
  ClientInvocation clientInvocation;
  final HazelcastClientInstanceImpl client=(HazelcastClientInstanceImpl)context.getHazelcastInstance();
  if (target != null) {
    ClientMessage request=ExecutorServiceCancelOnAddressCodec.encodeRequest(uuid,target.getHost(),target.getPort(),mayInterruptIfRunning);
    clientInvocation=new ClientInvocation(client,request,target);
  }
 else {
    ClientMessage request=ExecutorServiceCancelOnPartitionCodec.encodeRequest(uuid,partitionId,mayInterruptIfRunning);
    clientInvocation=new ClientInvocation(client,request,partitionId);
  }
  try {
    return clientInvocation.invoke();
  }
 catch (  Exception e) {
    throw rethrow(e);
  }
}

{
  nullCheck(xid);
  final TransactionProxy transaction=getTransaction(xid);
  if (transaction == null) {
    if (transactionManager.recover(xid,true)) {
      return;
    }
  }
  validateTx(transaction,onePhase ? ACTIVE : PREPARED);
  try {
    transaction.commit(onePhase);
    transactionManager.removeManagedTransaction(xid);
  }
 catch (  TransactionException e) {
    throw new XAException(XAException.XAER_RMERR);
  }
}

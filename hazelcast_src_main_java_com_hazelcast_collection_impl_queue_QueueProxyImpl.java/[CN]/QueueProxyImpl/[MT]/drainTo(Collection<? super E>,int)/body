{
  ValidationUtil.checkNotNull(objects,"Collection is null");
  if (this.equals(objects)) {
    throw new IllegalArgumentException("Can not drain to same Queue");
  }
  final NodeEngine nodeEngine=getNodeEngine();
  Collection<Data> dataList=drainInternal(i);
  for (  Data data : dataList) {
    E e=nodeEngine.toObject(data);
    objects.add(e);
  }
  return dataList.size();
}

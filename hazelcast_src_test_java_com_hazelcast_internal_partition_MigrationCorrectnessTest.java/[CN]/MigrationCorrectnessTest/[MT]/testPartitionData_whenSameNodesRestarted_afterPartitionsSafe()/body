{
  Config config=getConfig(true,false);
  HazelcastInstance[] instances=factory.newInstances(config,nodeCount);
  fillData(instances[instances.length - 1]);
  assertSizeAndDataEventually();
  Address[] restartingAddresses=new Address[backupCount];
  for (int i=0; i < backupCount; i++) {
    restartingAddresses[i]=getAddress(instances[i]);
  }
  for (int i=0; i < 10; i++) {
    for (    Address address : restartingAddresses) {
      TestUtil.terminateInstance(factory.getInstance(address));
    }
    startNodes(config,Arrays.asList(restartingAddresses));
  }
  assertSizeAndDataEventually();
}

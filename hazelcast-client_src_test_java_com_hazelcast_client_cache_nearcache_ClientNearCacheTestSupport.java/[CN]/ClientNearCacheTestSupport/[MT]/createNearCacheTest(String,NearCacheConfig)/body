{
  HazelcastClientProxy client=(HazelcastClientProxy)HazelcastClient.newHazelcastClient(createClientConfig());
  NearCacheManager nearCacheManager=client.client.getNearCacheManager();
  CachingProvider provider=HazelcastClientCachingProvider.createCachingProvider(client);
  HazelcastClientCacheManager cacheManager=(HazelcastClientCacheManager)provider.getCacheManager();
  CacheConfig<Integer,String> cacheConfig=new CacheConfig<Integer,String>();
  cacheConfig.setNearCacheConfig(nearCacheConfig);
  ICache<Integer,String> cache=cacheManager.createCache(cacheName,cacheConfig);
  NearCache<Data,String> nearCache=nearCacheManager.getNearCache(cacheManager.getCacheNameWithPrefix(cacheName));
  return new NearCacheTestContext(client,cacheManager,nearCacheManager,cache,nearCache);
}

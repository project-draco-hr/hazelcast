{
  return new MessageListener<Object>(){
    public void onMessage(    final Message<Object> message){
      if (message.getPublishingMember().localMember()) {
        return;
      }
      final Timestamp ts=(Timestamp)message.getMessageObject();
      final Object key=ts.getKey();
      for (; ; ) {
        final Value value=cache.get(key);
        final Long current=value != null ? (Long)value.getValue() : null;
        if (current != null) {
          if (ts.getTimestamp() > current) {
            if (cache.replace(key,value,new Value(value.getVersion(),ts.getTimestamp(),Clock.currentTimeMillis()))) {
              return;
            }
          }
 else {
            return;
          }
        }
 else {
          if (cache.putIfAbsent(key,new Value(null,ts.getTimestamp(),Clock.currentTimeMillis())) == null) {
            return;
          }
        }
      }
    }
  }
;
}

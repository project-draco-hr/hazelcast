{
  try {
    final NodeService nodeService=getNodeService();
    Map<Integer,Object> results=new HashMap<Integer,Object>(partitions.size());
    Map<Integer,ResponseQueue> responses=new HashMap<Integer,ResponseQueue>(partitions.size());
    for (    final int partitionId : partitions) {
      Operation op=(Operation)toObject(operationData);
      ResponseQueue r=new ResponseQueue();
      op.setNodeService(getNodeService()).setCaller(getCaller()).setPartitionId(partitionId).setResponseHandler(r).setService(getService());
      nodeService.runLocally(op);
      responses.put(partitionId,r);
    }
    for (    Map.Entry<Integer,ResponseQueue> partitionResponse : responses.entrySet()) {
      Object result=partitionResponse.getValue().get();
      results.put(partitionResponse.getKey(),result);
    }
    getResponseHandler().sendResponse(results);
  }
 catch (  Exception e) {
    e.printStackTrace();
    getResponseHandler().sendResponse(e);
  }
}

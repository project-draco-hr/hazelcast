{
  final NodeService nodeService=getOperationContext().getNodeService();
  final Object service=getOperationContext().getService();
  Map<Integer,Object> results=new HashMap<Integer,Object>(partitions.size());
  Map<Integer,Future> responses=new HashMap<Integer,Future>(partitions.size());
  for (  final int partitionId : partitions) {
    Future f=nodeService.runLocally(partitionId,new Callable(){
      public Object call() throws Exception {
        if (!nodeService.isOwner(partitionId)) {
          return "NOT OWNER";
        }
 else {
          Operation op=(Operation)toObject(operationData);
          op.getOperationContext().setPartitionId(partitionId).setService(service);
          return op.call();
        }
      }
    }
,false);
    responses.put(partitionId,f);
  }
  for (  Map.Entry<Integer,Future> partitionResponse : responses.entrySet()) {
    Object result=partitionResponse.getValue().get();
    System.out.println("result....  is " + result);
    results.put(partitionResponse.getKey(),result);
  }
  return new Response(results);
}

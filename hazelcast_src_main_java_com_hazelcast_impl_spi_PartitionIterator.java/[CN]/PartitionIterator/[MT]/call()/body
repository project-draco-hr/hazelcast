{
  final NodeService nodeService=getOperationContext().getNodeService();
  Map<Integer,Object> results=new HashMap<Integer,Object>(partitions.size());
  Map<Integer,Future> responses=new HashMap<Integer,Future>(partitions.size());
  for (  final int partitionId : partitions) {
    Operation op=(Operation)toObject(operationData);
    op.getOperationContext().setNodeService(getOperationContext().getNodeService()).setCaller(getOperationContext().getCaller()).setPartitionId(partitionId).setLocal(true).setService(getOperationContext().getService());
    Future f=nodeService.runLocally(partitionId,op,false);
    responses.put(partitionId,f);
  }
  for (  Map.Entry<Integer,Future> partitionResponse : responses.entrySet()) {
    Object result=partitionResponse.getValue().get();
    results.put(partitionResponse.getKey(),result);
  }
  return results;
}

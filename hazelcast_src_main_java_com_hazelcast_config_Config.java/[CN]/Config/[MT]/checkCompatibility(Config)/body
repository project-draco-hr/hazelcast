{
  if (config == null) {
    throw new IllegalArgumentException("Expected not null config");
  }
  if (!this.groupConfig.equals(config.getGroupConfig())) {
    throw new RuntimeException(format("Incompatible group config this:\n{0}\nanother:\n{1}",this.groupConfig,config.getGroupConfig()));
  }
  if (checkCompatibility) {
    checkMapConfigCompatible(config);
    checkQueueConfigCompatible(config);
    checkTopicConfigCompatible(config);
  }
}

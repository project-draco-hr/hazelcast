{
  if (requestedSessionId == null) {
    requestedSessionId=getSessionCookie(this);
    if (requestedSessionId == null) {
      requestedSessionId=getParameter(HAZELCAST_SESSION_COOKIE_NAME);
    }
  }
  if (requestedSessionId != null) {
    hazelcastSession=getSessionWithId(requestedSessionId);
    if (hazelcastSession == null) {
      final Boolean existing=(Boolean)getClusterMap().executeOnKey(requestedSessionId,new ReferenceSessionEntryProcessor());
      boolean canOrMustCreate=create || !RequestWrapper.this.res.isCommitted() || getOriginalSession(false) != null;
      if (existing != null && existing && canOrMustCreate) {
        hazelcastSession=createNewSession(RequestWrapper.this,requestedSessionId);
      }
    }
  }
  return hazelcastSession;
}

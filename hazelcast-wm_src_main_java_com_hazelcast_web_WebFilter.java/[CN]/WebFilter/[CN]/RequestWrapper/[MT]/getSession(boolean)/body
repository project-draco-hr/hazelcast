{
  if (hazelcastSession != null && !hazelcastSession.isValid()) {
    LOGGER.finest("Session is invalid!");
    destroySession(hazelcastSession,true);
    hazelcastSession=null;
  }
 else   if (hazelcastSession != null) {
    return hazelcastSession;
  }
  HttpSession originalSession=getOriginalSession(false);
  if (originalSession != null) {
    String hazelcastSessionId=MAP_ORIGINAL_SESSIONS.get(originalSession.getId());
    if (hazelcastSessionId != null) {
      hazelcastSession=MAP_SESSIONS.get(hazelcastSessionId);
      return hazelcastSession;
    }
    MAP_ORIGINAL_SESSIONS.remove(originalSession.getId());
    originalSession.invalidate();
  }
  hazelcastSession=fetchHazelcastSession();
  if (hazelcastSession == null && create) {
    hazelcastSession=createNewSession(RequestWrapper.this,null);
  }
  if (deferredWrite) {
    prepareReloadingSession(hazelcastSession);
  }
  return hazelcastSession;
}

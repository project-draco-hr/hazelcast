{
  final DistributedLock lock=locks.get(key);
  boolean result=false;
  if (lock == null)   return result;
  if (lock.canAcquireLock(caller,threadId)) {
    if (lock.unlock(caller,threadId)) {
      result=true;
    }
  }
  if (lock.isRemovable()) {
    locks.remove(key);
  }
  return result;
}

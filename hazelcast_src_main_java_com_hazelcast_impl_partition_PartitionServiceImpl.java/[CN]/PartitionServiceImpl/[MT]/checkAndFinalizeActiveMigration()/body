{
  lock.lock();
  try {
    final MigrationInfo migrationInfo=activeMigrationInfo;
    if (migrationInfo != null) {
      try {
        final Address thisAddress=node.getThisAddress();
        final boolean source=thisAddress.equals(migrationInfo.getFromAddress());
        final boolean destination=thisAddress.equals(migrationInfo.getToAddress());
        if (source || destination) {
          final int partitionId=migrationInfo.getPartitionId();
          final int replicaIndex=migrationInfo.getReplicaIndex();
          PartitionInfo migratingPartition=getPartition(partitionId);
          final Address address=migratingPartition.getReplicaAddress(replicaIndex);
          final boolean success=migrationInfo.getToAddress().equals(address);
          final FinalizeMigrationOperation op=new FinalizeMigrationOperation(source ? SOURCE : DESTINATION,success);
          Invocation inv=nodeService.createSingleInvocation(PARTITION_SERVICE_NAME,op,partitionId).setReplicaIndex(replicaIndex).setTarget(node.getThisAddress()).setTryCount(1).build();
          inv.invoke().get();
        }
      }
 catch (      Exception e) {
        logger.log(Level.WARNING,e.getMessage(),e);
      }
 finally {
        setActiveMigration(null);
      }
    }
  }
  finally {
    lock.unlock();
  }
}

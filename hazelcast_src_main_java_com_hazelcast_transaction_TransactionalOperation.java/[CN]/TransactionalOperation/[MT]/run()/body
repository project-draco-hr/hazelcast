{
switch (state) {
case ACTIVE:
    process();
  addTransactionRecord();
break;
case PREPARED:
onPrepare();
break;
case COMMITTED:
onCommit();
break;
case ROLLED_BACK:
onRollback();
break;
default :
throw new IllegalStateException();
}
}

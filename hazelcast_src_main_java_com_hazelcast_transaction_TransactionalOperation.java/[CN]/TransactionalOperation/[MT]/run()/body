{
switch (state) {
case ACTIVE:
    process();
  addTransactionRecord();
break;
case PREPARED:
prepare();
break;
case COMMITTED:
commit();
break;
case ROLLED_BACK:
rollback();
break;
default :
throw new IllegalStateException();
}
}

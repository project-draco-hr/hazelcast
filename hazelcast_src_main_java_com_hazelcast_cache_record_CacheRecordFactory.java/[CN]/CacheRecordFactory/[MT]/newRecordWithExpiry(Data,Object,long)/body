{
  final CacheRecord record;
switch (inMemoryFormat) {
case BINARY:
    Data dataValue=serializationService.toData(value);
  record=new CacheDataRecord(key,dataValue,expiryTime);
break;
case OBJECT:
Object objectValue=serializationService.toObject(value);
record=new CacheObjectRecord(key,objectValue,expiryTime);
break;
default :
throw new IllegalArgumentException("Invalid storage format: " + inMemoryFormat);
}
return record;
}

{
  HazelcastInstance hazelcastInstance=createHazelcastInstanceFactory(1).newHazelcastInstance();
  IAtomicLong ref=hazelcastInstance.getAtomicLong("getAndAlter_whenException");
  ref.set(10);
  try {
    ref.getAndAlter(new FailingFunction());
    fail();
  }
 catch (  WoohaaException expected) {
  }
  assertEquals(10,ref.get());
}

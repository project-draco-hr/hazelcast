{
  TestMapStore testMapStore=new TestMapStore(100,0,0);
  testMapStore.setLoadAllKeys(false);
  Config config=newConfig(testMapStore,2);
  TestHazelcastInstanceFactory nodeFactory=createHazelcastInstanceFactory(1);
  HazelcastInstance h1=nodeFactory.newHazelcastInstance(config);
  IMap<Object,Object> map=h1.getMap("testWriteBehindSameSecondSameKey");
  for (int i=0; i < 100; i++) {
    map.put("key","value" + i);
  }
  map.put("key","the_last_value");
  testMapStore.latchStore.await(5,TimeUnit.SECONDS);
  assertEquals("the_last_value",testMapStore.getStore().get("key"));
}

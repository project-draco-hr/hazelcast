{
  boolean isNull=str == null;
  writeBoolean(isNull);
  if (isNull)   return;
  int length=str.length();
  writeInt(length);
  int chunkSize=length / STRING_CHUNK_SIZE + 1;
  for (int i=0; i < chunkSize; i++) {
    int beginIndex=Math.max(0,i * STRING_CHUNK_SIZE - 1);
    int endIndex=Math.min((i + 1) * STRING_CHUNK_SIZE - 1,length);
    writeShortUTF(str.substring(beginIndex,endIndex));
  }
}

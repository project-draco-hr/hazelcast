{
  String executorName=op.getExecutorName();
  if (executorName == null) {
    int partitionId=getPartitionIdForExecution(op);
    boolean urgent=op.isUrgent();
    executor.execute(op,partitionId,urgent);
  }
 else {
    ExecutorService executor=executionService.getExecutor(executorName);
    if (executor == null) {
      throw new IllegalStateException("Could not found executor with name: " + executorName);
    }
    if (op instanceof PartitionAware) {
      throw new IllegalStateException("PartitionAwareOperation " + op + " can't be executed on a "+ "custom executor with name: "+ executorName);
    }
    if (op instanceof UrgentSystemOperation) {
      throw new IllegalStateException("UrgentSystemOperation " + op + " can't be executed on a custom "+ "executor with name: "+ executorName);
    }
    executor.execute(new LocalOperationProcessor(op));
  }
}

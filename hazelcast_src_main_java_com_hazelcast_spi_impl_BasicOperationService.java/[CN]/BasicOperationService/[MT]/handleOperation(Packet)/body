{
  try {
    if (packet.isHeaderSet(Packet.HEADER_RESPONSE)) {
      responseExecutor.execute(new RemoteOperationProcessor(packet));
    }
 else {
      final int partitionId=packet.getPartitionId();
      final Executor executor=getExecutor(partitionId);
      if (packet.isPriorityPacket()) {
        ConcurrentLinkedQueue<Runnable> priorityQueue=getPriorityQueue(partitionId);
        priorityQueue.add(new RemoteOperationProcessor(packet));
        executor.execute(new SystemOperationsProcessor());
      }
 else {
        executor.execute(new RemoteOperationProcessor(packet));
      }
    }
  }
 catch (  RejectedExecutionException e) {
    if (nodeEngine.isActive()) {
      throw e;
    }
  }
}

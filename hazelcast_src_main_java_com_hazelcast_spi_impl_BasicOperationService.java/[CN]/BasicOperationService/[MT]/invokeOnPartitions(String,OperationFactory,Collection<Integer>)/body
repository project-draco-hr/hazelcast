{
  final Map<Address,List<Integer>> memberPartitions=new HashMap<Address,List<Integer>>(3);
  for (  int partition : partitions) {
    InternalPartitionService partitionService=nodeEngine.getPartitionService();
    Address owner=partitionService.getPartitionOwner(partition);
    while (owner == null) {
      Thread.sleep(10);
      owner=partitionService.getPartitionOwner(partition);
    }
    if (!memberPartitions.containsKey(owner)) {
      memberPartitions.put(owner,new ArrayList<Integer>());
    }
    memberPartitions.get(owner).add(partition);
  }
  return invokeOnPartitions(serviceName,operationFactory,memberPartitions);
}

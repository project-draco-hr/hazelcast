{
  Connection conn=packet.getConn();
  Address caller=conn.getEndPoint();
  Data data=packet.getData();
  try {
    Object object=nodeEngine.toObject(data);
    Operation op=(Operation)object;
    op.setNodeEngine(nodeEngine);
    setCallerAddress(op,caller);
    setConnection(op,conn);
    setRemoteResponseHandler(nodeEngine,op);
    return op;
  }
 catch (  Throwable throwable) {
    long callId=IOUtil.extractOperationCallId(data,node.getSerializationService());
    RemoteOperationExceptionHandler exceptionHandler=new RemoteOperationExceptionHandler(callId);
    exceptionHandler.setNodeEngine(nodeEngine);
    exceptionHandler.setCallerAddress(caller);
    exceptionHandler.setConnection(conn);
    ResponseHandlerFactory.setRemoteResponseHandler(nodeEngine,exceptionHandler);
    operationHandler.handleOperationError(exceptionHandler,throwable);
    throw ExceptionUtil.rethrow(throwable);
  }
}

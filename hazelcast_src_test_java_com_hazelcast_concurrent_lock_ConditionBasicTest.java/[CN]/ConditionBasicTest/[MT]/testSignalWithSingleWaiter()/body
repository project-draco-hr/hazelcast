{
  String lockName=newName();
  String conditionName=newName();
  final ILock lock=callerInstance.getLock(lockName);
  final ICondition condition=lock.newCondition(conditionName);
  final AtomicInteger count=new AtomicInteger(0);
  Thread t=new Thread(new Runnable(){
    public void run(){
      try {
        lock.lock();
        if (lock.isLockedByCurrentThread()) {
          count.incrementAndGet();
        }
        condition.await();
        if (lock.isLockedByCurrentThread()) {
          count.incrementAndGet();
        }
      }
 catch (      InterruptedException ignored) {
      }
 finally {
        lock.unlock();
      }
    }
  }
);
  t.start();
  Thread.sleep(1000);
  assertEquals(false,lock.isLocked());
  lock.lock();
  assertEquals(true,lock.isLocked());
  condition.signal();
  lock.unlock();
  t.join();
  assertEquals(2,count.get());
}

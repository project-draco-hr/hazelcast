{
  long oldValue=missingValue;
  int index=hash(key);
  long candidateKey;
  while ((candidateKey=entries[index]) != missingValue) {
    if (candidateKey == key) {
      oldValue=entries[index + 1];
      break;
    }
    index=next(index);
  }
  if (oldValue == missingValue) {
    ++size;
    entries[index]=key;
  }
  entries[index + 1]=value;
  checkResize();
  return oldValue;
}

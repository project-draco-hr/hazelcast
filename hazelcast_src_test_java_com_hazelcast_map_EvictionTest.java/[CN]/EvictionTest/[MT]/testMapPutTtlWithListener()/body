{
  Config cfg=new Config();
  TestHazelcastInstanceFactory factory=createHazelcastInstanceFactory(2);
  final HazelcastInstance[] instances=factory.newInstances(cfg);
  warmUpPartitions(instances);
  final int k=10;
  final int putCount=10000;
  final CountDownLatch latch=new CountDownLatch(k * putCount);
  final IMap map=instances[0].getMap("testMapEvictionTtlWithListener");
  map.addEntryListener(new EntryAdapter(){
    public void entryEvicted(    EntryEvent event){
      latch.countDown();
    }
  }
,true);
  for (int i=0; i < k; i++) {
    final int threadId=i;
    new Thread(){
      public void run(){
        int ttl=(int)(Math.random() * 5000 + 3000);
        for (int j=0; j < putCount; j++) {
          map.put(j + putCount * threadId,"value",ttl,TimeUnit.MILLISECONDS);
        }
      }
    }
.start();
  }
  assertTrue(latch.await(1,TimeUnit.MINUTES));
}

{
  final SerializationService serializationService=new SerializationServiceBuilder().setVersion(1).addPortableFactory(FACTORY_ID,new PortableFactory(){
    public Portable create(    int classId){
      return new NamedPortable();
    }
  }
).build();
  final SerializationService serializationService2=new SerializationServiceBuilder().setVersion(2).addPortableFactory(FACTORY_ID,new PortableFactory(){
    public Portable create(    int classId){
      return new NamedPortableV2();
    }
  }
).build();
  NamedPortable p1=new NamedPortable("portable-v1",111);
  Data data=serializationService.toData(p1);
  BufferObjectDataOutput out=serializationService.createObjectDataOutput(1024);
  data.writeData(out);
  byte[] bytes=out.toByteArray();
  BufferObjectDataInput in=serializationService2.createObjectDataInput(bytes);
  data=new Data();
  data.readData(in);
  Object object1=serializationService2.toObject(data);
  NamedPortableV2 p2=new NamedPortableV2("portable-v2",123);
  Data data2=serializationService2.toData(p2);
  Object object2=serializationService.toObject(data2);
  assertTrue(object1 instanceof NamedPortableV2);
  assertTrue(object2 instanceof NamedPortable);
}

{
  SerializationConfig serializationConfig=new SerializationConfig();
  serializationConfig.addPortableFactory(FACTORY_ID,new TestPortableFactory());
  serializationConfig.setPortableVersion(1);
  serializationConfig.addClassDefinition(new ClassDefinitionBuilder(FACTORY_ID,RawDataPortable.CLASS_ID).addLongField("l").addCharArrayField("c").addPortableField("p",createNamedPortableClassDefinition()).build()).addClassDefinition(new ClassDefinitionBuilder(FACTORY_ID,NamedPortable.CLASS_ID).addUTFField("name").addIntField("myint").build());
  SerializationService serializationService=new SerializationServiceImpl(serializationConfig,null);
  RawDataPortable p=new RawDataPortable(System.currentTimeMillis(),"test chars".toCharArray(),new NamedPortable("named portable",34567),9876,"Testing raw portable",new SimpleDataSerializable("test bytes".getBytes()));
  final Data data=serializationService.toData(p);
  Assert.assertEquals(p,serializationService.toObject(data));
}

{
  if (shadedManifest == null) {
    shadedManifest=new Manifest(inputStream);
  }
  Manifest manifest=new Manifest(inputStream);
  Attributes attributes=manifest.getMainAttributes();
  Set<String> imports=new LinkedHashSet<String>();
  Set<String> exports=new LinkedHashSet<String>();
  String importPackages=attributes.getValue(IMPORT_PACKAGE);
  if (importPackages != null) {
    imports.addAll(ElementParser.parseDelimitedString(importPackages,',',true));
  }
  String exportPackages=attributes.getValue(EXPORT_PACKAGE);
  if (exportPackages != null) {
    exports.addAll(ElementParser.parseDelimitedString(exportPackages,',',true));
  }
  importedPackages.removeAll(exports);
  importedPackages.addAll(imports);
  exportedPackages.addAll(exports);
  IOUtil.close(inputStream);
}

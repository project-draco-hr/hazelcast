{
  final int itemCount=10000;
  final int rangeStart=1000;
  final int rangeEnd=9001;
  final String mapName=randomMapName();
  final Config config=createNewConfig(mapName);
  final TestHazelcastInstanceFactory instanceFactory=createHazelcastInstanceFactory(2);
  final HazelcastInstance node1=instanceFactory.newHazelcastInstance(config);
  final HazelcastInstance node2=instanceFactory.newHazelcastInstance(config);
  final IMap<Object,Object> map1=node1.getMap(mapName);
  final IMap<Object,Object> map2=node2.getMap(mapName);
  populateMap(map1,itemCount);
  map1.evictAll();
  final Set keysToLoad=selectKeysToLoad(rangeStart,rangeEnd);
  map1.loadAll(keysToLoad,true);
  assertEquals(rangeEnd - rangeStart,map1.size());
  assertRangeLoaded(map2,rangeStart,rangeEnd);
  assertTrue(map1.getLocalMapStats().getHeapCost() > 0L);
  assertTrue(map2.getLocalMapStats().getHeapCost() > 0L);
  assertEquals(map1.getLocalMapStats().getHeapCost(),map2.getLocalMapStats().getHeapCost());
}

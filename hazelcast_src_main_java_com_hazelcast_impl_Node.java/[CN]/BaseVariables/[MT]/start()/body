{
  if (completelyShutdown)   return;
  final Thread inThread=new Thread(inSelector,"hz.InThread");
  inThread.start();
  inThread.setPriority(8);
  threads.add(inThread);
  final Thread outThread=new Thread(outSelector,"hz.OutThread");
  outThread.start();
  outThread.setPriority(8);
  threads.add(outThread);
  final Thread clusterServiceThread=new Thread(clusterService,"hz.ServiceThread");
  clusterServiceThread.start();
  clusterServiceThread.setPriority(7);
  threads.add(clusterServiceThread);
  if (Config.get().getNetworkConfig().getJoin().getMulticastConfig().isEnabled()) {
    startMulticastService();
  }
  active=true;
  join();
  if (!completelyShutdown) {
    Runtime.getRuntime().addShutdownHook(new Thread(){
      @Override public void run(){
        try {
          completelyShutdown=true;
          if (logger != null) {
            logger.log(Level.INFO,"Hazelcast ShutdownHook is shutting down!");
          }
          shutdown();
        }
 catch (        Exception e) {
          if (logger != null) {
            logger.log(Level.WARNING,"Hazelcast shutdownhook exception:",e);
          }
        }
      }
    }
);
  }
}

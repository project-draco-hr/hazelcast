{
  final ConnectionManager connectionManager=node.getConnectionManager();
  final Connection connection=connectionManager.getConnection(target);
  if (connection != null) {
    return send(packet,connection);
  }
 else {
    if (futureSend == null) {
      futureSend=new FutureSend(packet,target);
    }
    final int retries=futureSend.retries;
    if (retries < RETRY_NUMBER && node.isActive()) {
      connectionManager.getOrConnect(target,true);
      executionService.schedule(futureSend,(retries + 1) * DELAY_FACTOR,TimeUnit.MILLISECONDS);
      return true;
    }
    return false;
  }
}

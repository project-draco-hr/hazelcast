{
  String mapName=randomMapName();
  Config config=createNearCachedMapConfig(mapName);
  config.setProperty(GroupProperty.PARTITION_COUNT.getName(),"1");
  TestHazelcastInstanceFactory factory=createHazelcastInstanceFactory();
  HazelcastInstance instance=factory.newHazelcastInstance(config);
  factory.newHazelcastInstance(config);
  factory.newHazelcastInstance(config);
  final IMap<Integer,Integer> map=instance.getMap(mapName);
  populateMap(map,1000);
  pullEntriesToNearCache(map,1000);
  map.clear();
  AssertTask task=new AssertTask(){
    @Override public void run(){
      assertEquals(0,((NearCachedMapProxyImpl)map).getNearCache().size());
    }
  }
;
  assertTrueEventually(task);
}

{
  String mapName=randomMapName();
  Config config=createNearCachedMapConfig(mapName);
  HazelcastInstance instance=createHazelcastInstance(config);
  IMap<Integer,Integer> map=instance.getMap(mapName);
  int mapSize=3;
  CountDownLatch latch=new CountDownLatch(mapSize);
  addListener(map,latch);
  populateMapWithExpirableEntries(map,mapSize,3,TimeUnit.SECONDS);
  pullEntriesToNearCache(map,mapSize);
  int nearCacheSizeBeforeExpiration=((NearCachedMapProxyImpl)map).getNearCache().size();
  waitUntilEvictionEventsReceived(latch);
  sleepSeconds(2);
  int nearCacheSizeAfterExpiration=((NearCachedMapProxyImpl)map).getNearCache().size();
  assertEquals(nearCacheSizeBeforeExpiration,nearCacheSizeAfterExpiration);
}

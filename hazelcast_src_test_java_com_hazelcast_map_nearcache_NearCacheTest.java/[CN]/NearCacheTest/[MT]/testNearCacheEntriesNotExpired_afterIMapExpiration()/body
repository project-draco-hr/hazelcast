{
  final String mapName=randomMapName();
  final Config config=createNearCachedMapConfig(mapName);
  final HazelcastInstance instance=createHazelcastInstance(config);
  final IMap<Integer,Integer> map=instance.getMap(mapName);
  final int mapSize=3;
  final CountDownLatch latch=new CountDownLatch(mapSize);
  addListener(map,latch);
  populateMapWithExpirableEntries(map,mapSize,3,TimeUnit.SECONDS);
  pullEntriesToNearCache(map,mapSize);
  int nearCacheSizeBeforeExpiration=((NearCachedMapProxyImpl)map).getNearCache().size();
  waitUntilEvictionEventsReceived(latch);
  sleepSeconds(2);
  int nearCacheSizeAfterExpiration=((NearCachedMapProxyImpl)map).getNearCache().size();
  assertEquals(nearCacheSizeBeforeExpiration,nearCacheSizeAfterExpiration);
}

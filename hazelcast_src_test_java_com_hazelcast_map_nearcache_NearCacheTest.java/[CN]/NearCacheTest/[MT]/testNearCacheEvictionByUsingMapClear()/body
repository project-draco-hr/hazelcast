{
  final Config cfg=getConfig();
  final String mapName="testNearCacheEviction";
  final NearCacheConfig nearCacheConfig=newNearCacheConfig();
  nearCacheConfig.setInvalidateOnChange(true);
  cfg.getMapConfig(mapName).setNearCacheConfig(nearCacheConfig);
  final TestHazelcastInstanceFactory factory=createHazelcastInstanceFactory(2);
  final HazelcastInstance hazelcastInstance1=factory.newHazelcastInstance(cfg);
  final HazelcastInstance hazelcastInstance2=factory.newHazelcastInstance(cfg);
  final IMap map1=hazelcastInstance1.getMap(mapName);
  final IMap map2=hazelcastInstance2.getMap(mapName);
  final int size=10;
  for (int i=0; i < size; i++) {
    map1.put(i,i);
  }
  for (int i=0; i < size; i++) {
    map1.get(i);
    map2.get(i);
  }
  map1.clear();
  for (int i=0; i < size; i++) {
    assertNull(map1.get(i));
  }
}

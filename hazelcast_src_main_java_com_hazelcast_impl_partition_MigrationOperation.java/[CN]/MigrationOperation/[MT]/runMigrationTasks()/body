{
  boolean error=false;
  final NodeServiceImpl nodeService=(NodeServiceImpl)getNodeService();
  final MigrationType migrationType=move ? MigrationType.MOVE : MigrationType.COPY;
  final PartitionServiceImpl partitionService=getService();
  partitionService.addActiveMigration(new MigrationInfo(getPartitionId(),getReplicaIndex(),move,from,nodeService.getThisAddress()));
  for (  Operation op : tasks) {
    try {
      nodeService.setOperationContext(op,op.getServiceName(),from,-1,getPartitionId(),getReplicaIndex());
      ResponseHandlerFactory.setNoReplyResponseHandler(nodeService,op);
      MigrationAwareService service=op.getService();
      service.beforeMigration(new MigrationServiceEvent(MigrationEndpoint.DESTINATION,getPartitionId(),getReplicaIndex(),migrationType));
      op.run();
    }
 catch (    Throwable e) {
      error=true;
      getLogger().log(Level.SEVERE,e.getMessage(),e);
      break;
    }
  }
  return !error;
}

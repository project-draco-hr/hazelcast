{
  begin=Clock.currentTimeMillis();
  MultiMapContainer container=getOrCreateContainer();
  MultiMapWrapper wrapper=container.getOrCreateCollectionWrapper(dataKey);
  response=true;
  for (  Long recordId : recordIds) {
    if (!wrapper.containsRecordId(recordId)) {
      response=false;
      return;
    }
  }
  Collection<MultiMapRecord> coll=wrapper.getCollection();
  removed=new LinkedList<MultiMapRecord>();
  for (  Long recordId : recordIds) {
    Iterator<MultiMapRecord> iter=coll.iterator();
    while (iter.hasNext()) {
      MultiMapRecord record=iter.next();
      if (record.getRecordId() == recordId) {
        iter.remove();
        removed.add(record);
        break;
      }
    }
  }
  if (coll.isEmpty()) {
    removeCollection();
  }
}

{
  HazelcastInstance instance1=Hazelcast.newHazelcastInstance();
  HazelcastInstance instance2=Hazelcast.newHazelcastInstance();
  final TransactionContext context=instance1.newTransactionContext();
  context.beginTransaction();
  context.getMap("map").put("key","value");
  final com.hazelcast.transaction.impl.Transaction transaction=TransactionAccessor.getTransaction(context);
  transaction.prepare();
  instance1.getLifecycleService().shutdown();
  assertEquals("value",instance2.getMap("map").get("key"));
}

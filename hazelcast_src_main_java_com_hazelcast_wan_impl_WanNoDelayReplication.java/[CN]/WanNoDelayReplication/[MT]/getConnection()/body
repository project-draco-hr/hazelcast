{
  final int defaultPort=node.getConfig().getNetworkConfig().getPort();
  while (running) {
    String targetStr=addressQueue.take();
    try {
      final AddressHolder addressHolder=AddressUtil.getAddressHolder(targetStr,defaultPort);
      final Address target=new Address(addressHolder.getAddress(),addressHolder.getPort());
      final ConnectionManager connectionManager=node.getConnectionManager();
      Connection conn=connectionManager.getOrConnect(target);
      for (int i=0; i < RETRY_CONNECTION_MAX; i++) {
        if (conn == null) {
          Thread.sleep(RETRY_CONNECTION_SLEEP_MILLIS);
        }
 else {
          return conn;
        }
        conn=connectionManager.getConnection(target);
      }
    }
 catch (    Throwable e) {
      Thread.sleep(RETRY_CONNECTION_SLEEP_MILLIS);
    }
 finally {
      addressQueue.offer(targetStr);
    }
  }
  return null;
}

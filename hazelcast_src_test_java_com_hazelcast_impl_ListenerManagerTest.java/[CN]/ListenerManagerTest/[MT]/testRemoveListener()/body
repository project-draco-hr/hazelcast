{
  final String topicName="testTopic";
  final AtomicInteger counter=new AtomicInteger(0);
  IncrementingMessageListener listener1=new IncrementingMessageListener(counter);
  hc.getTopic(topicName).addMessageListener(listener1);
  hc.getTopic(topicName).publish(new TestMessage());
  Thread.sleep(1000);
  TestCase.assertEquals("A single increment is expected",1,counter.get());
  IncrementingMessageListener listener2=new IncrementingMessageListener(counter);
  TestCase.assertEquals("The IncrementingMessageListener classes should be equal!",listener1,listener2);
  hc.getTopic(topicName).removeMessageListener(listener2);
  hc.getTopic(topicName).publish(new TestMessage());
  Thread.sleep(1000);
  TestCase.assertEquals("No additional increment is expected as we should remove the listeners by object equality, not object identity.",1,counter.get());
}

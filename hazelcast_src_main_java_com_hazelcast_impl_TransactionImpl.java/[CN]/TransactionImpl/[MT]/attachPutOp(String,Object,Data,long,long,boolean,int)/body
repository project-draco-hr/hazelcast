{
  Instance.InstanceType instanceType=Prefix.getInstanceType(name);
  Object matchValue=(instanceType.isMultiMap()) ? toObject(value) : null;
  TransactionRecord rec=findTransactionRecord(name,key,matchValue);
  if (rec == null) {
    rec=new TransactionRecord(name,key,value,newRecord);
    rec.timeout=timeout;
    rec.ttl=ttl;
    rec.index=index;
    transactionRecords.add(rec);
    return null;
  }
 else {
    Data old=rec.value;
    rec.value=value;
    rec.removed=false;
    rec.index=index;
    return old;
  }
}

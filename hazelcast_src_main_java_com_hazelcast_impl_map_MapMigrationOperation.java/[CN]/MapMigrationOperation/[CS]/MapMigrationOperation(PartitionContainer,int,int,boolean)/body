{
  this.partitionId=partitionId;
  this.replicaIndex=replicaIndex;
  this.diff=diff;
  data=new HashMap<String,Map<Data,DataRecordEntry>>(container.maps.size());
  for (  Entry<String,MapPartition> entry : container.maps.entrySet()) {
    String name=entry.getKey();
    MapPartition partition=entry.getValue();
    Map<Data,DataRecordEntry> map=new HashMap<Data,DataRecordEntry>(partition.records.size());
    for (    Entry<Data,Record> recordEntry : partition.records.entrySet()) {
      map.put(recordEntry.getKey(),new DataRecordEntry(recordEntry.getValue(),true));
    }
    data.put(name,map);
  }
}

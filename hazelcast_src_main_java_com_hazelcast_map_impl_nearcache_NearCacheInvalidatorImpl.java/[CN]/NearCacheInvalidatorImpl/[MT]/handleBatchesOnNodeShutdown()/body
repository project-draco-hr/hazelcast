{
  HazelcastInstance node=nodeEngine.getHazelcastInstance();
  LifecycleService lifecycleService=node.getLifecycleService();
  lifecycleService.addLifecycleListener(new LifecycleListener(){
    @Override public void stateChanged(    LifecycleEvent event){
      if (event.getState() == LifecycleEvent.LifecycleState.SHUTTING_DOWN) {
        Set<String> mapNames=NearCacheInvalidatorImpl.this.nearCacheProvider.nearCacheMap.keySet();
        for (        String mapName : mapNames) {
          InvalidationQueue invalidationQueue=invalidationQueues.get(mapName);
          sendBatchInvalidation(mapName,invalidationQueue);
        }
      }
    }
  }
);
}

{
  for (  Map.Entry<String,Map> entry : map.entrySet()) {
    String name=entry.getKey();
    MultiMapContainer container=getOrCreateCollectionContainer(partitionId,name);
    Map<Data,MultiMapWrapper> collections=entry.getValue();
    long maxRecordId=-1;
    for (    Map.Entry<Data,MultiMapWrapper> wrapperEntry : collections.entrySet()) {
      MultiMapWrapper wrapper=wrapperEntry.getValue();
      container.getMultiMapWrappers().put(wrapperEntry.getKey(),wrapper);
      long wrapperMaxRecordId=getMaxRecordId(wrapper);
      maxRecordId=Math.max(maxRecordId,wrapperMaxRecordId);
    }
    container.setId(maxRecordId);
  }
}

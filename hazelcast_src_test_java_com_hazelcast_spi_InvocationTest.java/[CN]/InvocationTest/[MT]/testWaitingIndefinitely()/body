{
  final Config config=new Config();
  config.setProperty(GroupProperties.PROP_OPERATION_CALL_TIMEOUT_MILLIS,"2000");
  TestHazelcastInstanceFactory factory=createHazelcastInstanceFactory(2);
  final HazelcastInstance[] instances=factory.newInstances(config);
  warmUpPartitions(instances);
  instances[0].getLock("testWaitingIndefinitely").lock();
  final CountDownLatch latch=new CountDownLatch(1);
  new Thread(){
    public void run(){
      try {
        instances[1].getLock("testWaitingIndefinitely").lock();
        latch.countDown();
      }
 catch (      Exception ignored) {
      }
    }
  }
.start();
  Thread.sleep(10000);
  instances[0].getLock("testWaitingIndefinitely").unlock();
  assertTrue(latch.await(5,TimeUnit.SECONDS));
}

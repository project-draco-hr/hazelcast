{
  final OutputStream zos=new BufferedOutputStream(new GZIPOutputStream(bbos));
  final ObjectOutputStream os=new ObjectOutputStream(zos);
  if (shared) {
    os.writeObject(obj);
  }
 else {
    os.writeUnshared(obj);
  }
  os.flush();
  os.close();
}

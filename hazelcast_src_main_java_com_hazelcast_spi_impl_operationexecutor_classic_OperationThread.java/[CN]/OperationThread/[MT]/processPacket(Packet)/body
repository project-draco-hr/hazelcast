{
  processedPacketCount.inc();
  currentOperationRunner=getOperationRunner(packet.getPartitionId());
  try {
    currentOperationRunner.run(packet);
  }
 catch (  Throwable e) {
    inspectOutputMemoryError(e);
    logger.severe("Failed to process packet: " + packet + " on "+ getName(),e);
  }
 finally {
    currentOperationRunner=null;
  }
}

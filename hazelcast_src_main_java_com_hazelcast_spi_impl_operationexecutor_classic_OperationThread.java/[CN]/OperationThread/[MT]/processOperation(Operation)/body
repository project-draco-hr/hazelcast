{
  processedOperations.inc();
  try {
    currentRunner=getOperationRunner(operation.getPartitionId());
    currentRunner.run(operation);
  }
 catch (  Throwable e) {
    inspectOutputMemoryError(e);
    logger.severe("Failed to process operation: " + operation + " on "+ getName(),e);
  }
 finally {
    currentRunner=null;
  }
}

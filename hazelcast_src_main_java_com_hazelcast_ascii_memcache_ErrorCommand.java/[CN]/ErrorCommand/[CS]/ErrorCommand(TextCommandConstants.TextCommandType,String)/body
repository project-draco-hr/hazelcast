{
  super(type);
  byte[] error=TextCommandConstants.ERROR;
  if (type == TextCommandConstants.TextCommandType.ERROR_CLIENT) {
    error=TextCommandConstants.CLIENT_ERROR;
  }
 else   if (type == TextCommandConstants.TextCommandType.ERROR_SERVER) {
    error=TextCommandConstants.SERVER_ERROR;
  }
  this.message=message;
  byte[] msg=(message == null) ? null : stringToBytes(message);
  int total=error.length;
  if (msg != null) {
    total+=msg.length;
  }
  total+=2;
  response=ByteBuffer.allocate(total);
  response.put(error);
  if (msg != null) {
    response.put(msg);
  }
  response.put(TextCommandConstants.RETURN);
  response.flip();
}

{
  this.node=node;
  this.logger=node.getLogger(this.getClass().getName());
  node.getClusterImpl().addMembershipListener(new ClientServiceMembershipListener());
  mapCommandHandlers.put(Command.AUTH.value,new ClientAuthenticateHandler());
  mapCommandHandlers.put(Command.MGET.value,new MapGetHandler());
  mapCommandHandlers.put(Command.MPUT.value,new MapPutHandler());
  mapCommandHandlers.put(Command.ADDLSTNR.value,new AddListenerHandler());
  mapCommandHandlers.put(Command.RMVLSTNR.value,new RemoveListenerHandler());
  registerHandler(CONCURRENT_MAP_PUT.getValue(),new MapPutHandler());
  registerHandler(CONCURRENT_MAP_PUT.getValue(),new MapPutHandler());
  registerHandler(CONCURRENT_MAP_PUT_AND_UNLOCK.getValue(),new MapPutAndUnlockHandler());
  registerHandler(CONCURRENT_MAP_PUT_ALL.getValue(),new MapPutAllHandler());
  registerHandler(CONCURRENT_MAP_PUT_MULTI.getValue(),new MapPutMultiHandler());
  registerHandler(CONCURRENT_MAP_PUT_IF_ABSENT.getValue(),new MapPutIfAbsentHandler());
  registerHandler(CONCURRENT_MAP_PUT_TRANSIENT.getValue(),new MapPutTransientHandler());
  registerHandler(CONCURRENT_MAP_SET.getValue(),new MapSetHandler());
  registerHandler(CONCURRENT_MAP_TRY_PUT.getValue(),new MapTryPutHandler());
  registerHandler(CONCURRENT_MAP_GET.getValue(),new MapGetHandler());
  registerHandler(CONCURRENT_MAP_GET_ALL.getValue(),new MapGetAllHandler());
  registerHandler(CONCURRENT_MAP_REMOVE.getValue(),new MapRemoveHandler());
  registerHandler(CONCURRENT_MAP_TRY_REMOVE.getValue(),new MapTryRemoveHandler());
  registerHandler(CONCURRENT_MAP_REMOVE_IF_SAME.getValue(),new MapRemoveIfSameHandler());
  registerHandler(CONCURRENT_MAP_REMOVE_MULTI.getValue(),new MapRemoveMultiHandler());
  registerHandler(CONCURRENT_MAP_EVICT.getValue(),new MapEvictHandler());
  registerHandler(CONCURRENT_MAP_FLUSH.getValue(),new MapFlushHandler());
  registerHandler(CONCURRENT_MAP_REPLACE_IF_NOT_NULL.getValue(),new MapReplaceIfNotNullHandler());
  registerHandler(CONCURRENT_MAP_REPLACE_IF_SAME.getValue(),new MapReplaceIfSameHandler());
  registerHandler(CONCURRENT_MAP_SIZE.getValue(),new MapSizeHandler());
  registerHandler(CONCURRENT_MAP_GET_MAP_ENTRY.getValue(),new GetMapEntryHandler());
  registerHandler(CONCURRENT_MAP_TRY_LOCK_AND_GET.getValue(),new MapTryLockAndGetHandler());
  registerHandler(CONCURRENT_MAP_LOCK.getValue(),new MapLockHandler());
  registerHandler(CONCURRENT_MAP_IS_KEY_LOCKED.getValue(),new MapIsKeyLockedHandler());
  registerHandler(CONCURRENT_MAP_UNLOCK.getValue(),new MapUnlockHandler());
  registerHandler(CONCURRENT_MAP_FORCE_UNLOCK.getValue(),new MapForceUnlockHandler());
  registerHandler(CONCURRENT_MAP_LOCK_MAP.getValue(),new MapLockMapHandler());
  registerHandler(CONCURRENT_MAP_UNLOCK_MAP.getValue(),new MapUnlockMapHandler());
  registerHandler(CONCURRENT_MAP_CONTAINS_KEY.getValue(),new MapContainsHandler());
  registerHandler(CONCURRENT_MAP_CONTAINS_VALUE.getValue(),new MapContainsValueHandler());
  registerHandler(CONCURRENT_MAP_ADD_TO_LIST.getValue(),new ListAddHandler());
  registerHandler(CONCURRENT_MAP_ADD_TO_SET.getValue(),new SetAddHandler());
  registerHandler(CONCURRENT_MAP_REMOVE_ITEM.getValue(),new MapItemRemoveHandler());
  registerHandler(CONCURRENT_MAP_ITERATE_KEYS.getValue(),new MapIterateKeysHandler());
  registerHandler(CONCURRENT_MAP_ITERATE_ENTRIES.getValue(),new MapIterateEntriesHandler());
  registerHandler(CONCURRENT_MAP_VALUE_COUNT.getValue(),new MapValueCountHandler());
  registerHandler(TOPIC_PUBLISH.getValue(),new TopicPublishHandler());
  registerHandler(BLOCKING_QUEUE_OFFER.getValue(),new QueueOfferHandler());
  registerHandler(BLOCKING_QUEUE_POLL.getValue(),new QueuePollHandler());
  registerHandler(BLOCKING_QUEUE_REMOVE.getValue(),new QueueRemoveHandler());
  registerHandler(BLOCKING_QUEUE_PEEK.getValue(),new QueuePeekHandler());
  registerHandler(BLOCKING_QUEUE_SIZE.getValue(),new QueueSizeHandler());
  registerHandler(BLOCKING_QUEUE_REMAINING_CAPACITY.getValue(),new QueueRemainingCapacityHandler());
  registerHandler(BLOCKING_QUEUE_ENTRIES.getValue(),new QueueEntriesHandler());
  registerHandler(TRANSACTION_BEGIN.getValue(),new TransactionBeginHandler());
  registerHandler(TRANSACTION_COMMIT.getValue(),new TransactionCommitHandler());
  registerHandler(TRANSACTION_ROLLBACK.getValue(),new TransactionRollbackHandler());
  registerHandler(ADD_LISTENER.getValue(),new AddListenerHandler());
  registerHandler(REMOVE_LISTENER.getValue(),new RemoveListenerHandler());
  registerHandler(REMOTELY_PROCESS.getValue(),new RemotelyProcessHandler());
  registerHandler(DESTROY.getValue(),new DestroyHandler());
  registerHandler(GET_ID.getValue(),new GetIdHandler());
  registerHandler(ADD_INDEX.getValue(),new AddIndexHandler());
  registerHandler(NEW_ID.getValue(),new NewIdHandler());
  registerHandler(EXECUTE.getValue(),new ExecutorServiceHandler());
  registerHandler(CANCEL_EXECUTION.getValue(),new CancelExecutionHandler());
  registerHandler(GET_INSTANCES.getValue(),new GetInstancesHandler());
  registerHandler(GET_MEMBERS.getValue(),new GetMembersHandler());
  registerHandler(GET_CLUSTER_TIME.getValue(),new GetClusterTimeHandler());
  registerHandler(CLIENT_AUTHENTICATE.getValue(),new ClientAuthenticateHandler());
  registerHandler(CLIENT_ADD_INSTANCE_LISTENER.getValue(),new ClientAddInstanceListenerHandler());
  registerHandler(CLIENT_GET_PARTITIONS.getValue(),new GetPartitionsHandler());
  registerHandler(ATOMIC_NUMBER_ADD_AND_GET.getValue(),new AtomicLongAddAndGetHandler());
  registerHandler(ATOMIC_NUMBER_COMPARE_AND_SET.getValue(),new AtomicLongCompareAndSetHandler());
  registerHandler(ATOMIC_NUMBER_GET_AND_SET.getValue(),new AtomicLongGetAndSetHandler());
  registerHandler(ATOMIC_NUMBER_GET_AND_ADD.getValue(),new AtomicLongGetAndAddHandler());
  registerHandler(COUNT_DOWN_LATCH_AWAIT.getValue(),new CountDownLatchAwaitHandler());
  registerHandler(COUNT_DOWN_LATCH_COUNT_DOWN.getValue(),new CountDownLatchCountDownHandler());
  registerHandler(COUNT_DOWN_LATCH_GET_COUNT.getValue(),new CountDownLatchGetCountHandler());
  registerHandler(COUNT_DOWN_LATCH_GET_OWNER.getValue(),new CountDownLatchGetOwnerHandler());
  registerHandler(COUNT_DOWN_LATCH_SET_COUNT.getValue(),new CountDownLatchSetCountHandler());
  registerHandler(SEMAPHORE_ATTACH_DETACH_PERMITS.getValue(),new SemaphoreAttachDetachHandler());
  registerHandler(SEMAPHORE_CANCEL_ACQUIRE.getValue(),new SemaphoreCancelAcquireHandler());
  registerHandler(SEMAPHORE_DRAIN_PERMITS.getValue(),new SemaphoreDrainHandler());
  registerHandler(SEMAPHORE_GET_ATTACHED_PERMITS.getValue(),new SemaphoreGetAttachedHandler());
  registerHandler(SEMAPHORE_GET_AVAILABLE_PERMITS.getValue(),new SemaphoreGetAvailableHandler());
  registerHandler(SEMAPHORE_REDUCE_PERMITS.getValue(),new SemaphoreReduceHandler());
  registerHandler(SEMAPHORE_RELEASE.getValue(),new SemaphoreReleaseHandler());
  registerHandler(SEMAPHORE_TRY_ACQUIRE.getValue(),new SemaphoreTryAcquireHandler());
  registerHandler(LOCK_LOCK.getValue(),new LockOperationHandler());
  registerHandler(LOCK_UNLOCK.getValue(),new UnlockOperationHandler());
  registerHandler(LOCK_FORCE_UNLOCK.getValue(),new UnlockOperationHandler());
  registerHandler(LOCK_IS_LOCKED.getValue(),new IsLockedOperationHandler());
  node.connectionManager.addConnectionListener(this);
  this.THREAD_COUNT=node.getGroupProperties().EXECUTOR_CLIENT_THREAD_COUNT.getInteger();
  workers=new Worker[THREAD_COUNT];
  for (int i=0; i < THREAD_COUNT; i++) {
    workers[i]=new Worker();
  }
  this.factory=node.factory;
}

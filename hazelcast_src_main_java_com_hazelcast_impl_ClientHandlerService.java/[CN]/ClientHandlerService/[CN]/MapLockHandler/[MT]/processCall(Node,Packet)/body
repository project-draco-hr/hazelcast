{
  Instance.InstanceType type=getInstanceType(packet.name);
  long timeout=packet.timeout;
  Data value=null;
  IMap<Object,Object> map=null;
  if (type == Instance.InstanceType.MAP) {
    map=(IMap)factory.getOrCreateProxyByName(packet.name);
  }
 else {
    MultiMapProxy multiMapProxy=(MultiMapProxy)factory.getOrCreateProxyByName(packet.name);
    map=multiMapProxy.getMProxy();
  }
  if (timeout == -1) {
    map.lock(packet.getKeyData());
    value=null;
  }
 else   if (timeout == 0) {
    value=toData(map.tryLock(packet.getKeyData()));
  }
 else {
    TimeUnit timeUnit=(TimeUnit)toObject(packet.getValueData());
    timeUnit=timeUnit == null ? TimeUnit.MILLISECONDS : timeUnit;
    value=toData(map.tryLock(packet.getKeyData(),timeout,timeUnit));
  }
  packet.setValue(value);
}

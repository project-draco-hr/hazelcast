{
  Credentials credentials;
  String[] args=protocol.getArgs();
  if (node.securityContext == null) {
    if (args.length < 3) {
    }
    credentials=new UsernamePasswordCredentials(args[1],args[2]);
  }
 else {
    credentials=(Credentials)toObject(new Data(protocol.getBuffers()[0].array()));
  }
  boolean authenticated=doAuthenticate(node,credentials,protocol.getConnection());
  return authenticated ? protocol.success((ByteBuffer)null) : protocol.error(null);
}

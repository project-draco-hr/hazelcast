{
  final ClientEndpoint clientEndpoint=removeClientEndpoint(connection);
  if (clientEndpoint != null) {
    node.executorManager.executeNow(new FallThroughRunnable(){
      public void doRun(){
        logger.log(Level.INFO,"Client {" + connection + "} has been removed.");
        clientEndpoint.connectionRemoved(connection);
        if (node.securityContext != null) {
          try {
            clientEndpoint.getLoginContext().logout();
          }
 catch (          LoginException e) {
            logger.log(Level.WARNING,e.getMessage(),e);
          }
        }
      }
    }
);
  }
}

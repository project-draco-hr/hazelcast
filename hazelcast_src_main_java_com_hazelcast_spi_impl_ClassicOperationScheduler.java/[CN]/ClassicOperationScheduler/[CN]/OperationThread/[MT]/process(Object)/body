{
  processedCount++;
  if (task instanceof Runnable) {
    try {
      ((Runnable)task).run();
    }
 catch (    Throwable e) {
      inspectOutputMemoryError(e);
      logger.severe("Failed to process task: " + task + " on partitionThread:"+ getName());
    }
    return;
  }
  Operation operation;
  if (task instanceof Packet) {
    try {
      operation=operationHandler.deserialize((Packet)task);
      if (operation == null) {
        return;
      }
    }
 catch (    Throwable e) {
      inspectOutputMemoryError(e);
      logger.severe("Failed to deserialize packet: " + task + " on partitionThread:"+ getName());
      return;
    }
  }
 else {
    operation=(Operation)task;
  }
  try {
    currentOperation=operation;
    operationHandler.process(operation);
  }
 catch (  Throwable e) {
    inspectOutputMemoryError(e);
    logger.severe("Failed to process operation: " + operation + " on partitionThread:"+ getName());
  }
 finally {
    currentOperation=null;
  }
}

{
  if (MOCK_NETWORK) {
    if (nodeIndex >= addresses.length) {
      throw new IndexOutOfBoundsException("Max " + addresses.length + " instances can be created!");
    }
    init(config);
    NodeContext nodeContext=registry.createNodeContext(addresses[nodeIndex++]);
    return HazelcastInstanceFactory.newHazelcastInstance(config,null,nodeContext);
  }
 else {
    return HazelcastInstanceFactory.newHazelcastInstance(config);
  }
}

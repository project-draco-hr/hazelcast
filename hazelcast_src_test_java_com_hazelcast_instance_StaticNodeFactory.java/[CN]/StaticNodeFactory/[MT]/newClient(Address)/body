{
  Set<HazelcastInstance> instances=Hazelcast.getAllHazelcastInstances();
  for (  HazelcastInstance p : instances) {
    HazelcastInstanceImpl hz=((HazelcastInstanceProxy)p).original;
    MemberImpl m=(MemberImpl)hz.getCluster().getLocalMember();
    if (m.getAddress().equals(nodeAddress)) {
      if (MOCK_NETWORK) {
        ClientEngineImpl engine=hz.node.clientEngine;
        return new MockSimpleClient(engine);
      }
 else {
        return new SocketSimpleClient(hz);
      }
    }
  }
  throw new IllegalArgumentException("Cannot connect to node: " + nodeAddress);
}

{
  if (returnAddress != null || bindAddress != null) {
    return;
  }
  try {
    final Config config=node.getConfig();
    final AddressDefinition addressDef=pickAddress(config);
    final boolean reuseAddress=config.isReuseAddress();
    final boolean bindAny=node.getGroupProperties().SOCKET_BIND_ANY.getBoolean();
    serverSocketChannel=ServerSocketChannel.open();
    final ServerSocket serverSocket=serverSocketChannel.socket();
    log(Level.FINEST,"inet reuseAddress:" + reuseAddress);
    serverSocket.setReuseAddress(reuseAddress);
    serverSocket.setSoTimeout(1000);
    InetSocketAddress isa;
    int port=config.getPort();
    for (int i=0; i < 100; i++) {
      try {
        if (bindAny) {
          isa=new InetSocketAddress(port);
        }
 else {
          isa=new InetSocketAddress(addressDef.inetAddress,port);
        }
        log(Level.FINEST,"Trying to bind inet socket address:" + isa);
        serverSocket.bind(isa,100);
        log(Level.FINEST,"Bind successful to inet socket address:" + isa);
        break;
      }
 catch (      final Exception e) {
        if (config.isPortAutoIncrement()) {
          port++;
        }
 else {
          String msg="Port [" + port + "] is already in use and auto-increment is "+ "disabled. Hazelcast cannot start.";
          logger.log(Level.SEVERE,msg,e);
          throw e;
        }
      }
    }
    serverSocketChannel.configureBlocking(false);
    bindAddress=new Address(addressDef.host != null ? addressDef.host : addressDef.address,port);
    log(Level.INFO,"Picked " + bindAddress + ", using socket "+ serverSocket+ ", bind any local is "+ bindAny);
    AddressDefinition natAddressDef=this.getSystemConfiguredAddress(config);
    if (natAddressDef != null) {
      returnAddress=new Address(natAddressDef.host != null ? natAddressDef.host : natAddressDef.address,port);
      log(Level.INFO,"Picked " + returnAddress + ", using socket "+ serverSocket+ " as returning address (NAT?).");
    }
 else {
      returnAddress=bindAddress;
      log(Level.INFO,"Picked " + returnAddress + ", using socket "+ serverSocket+ " the same as the bind address.");
    }
  }
 catch (  Exception e) {
    logger.log(Level.SEVERE,e.getMessage(),e);
    throw e;
  }
}

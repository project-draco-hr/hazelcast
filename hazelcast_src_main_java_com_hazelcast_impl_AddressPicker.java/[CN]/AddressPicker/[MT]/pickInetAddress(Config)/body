{
  InetAddress currentInetAddress=getSystemConfiguredAddress();
  if (currentInetAddress == null) {
    final NetworkConfig networkConfig=config.getNetworkConfig();
    final Collection<String> interfaces=getInterfaces(networkConfig);
    if (interfaces.contains("127.0.0.1") || interfaces.contains("localhost")) {
      currentInetAddress=pickLoopbackAddress();
    }
 else {
      if (interfaces.size() > 0) {
        currentInetAddress=pickInetAddress(interfaces);
      }
      if (currentInetAddress == null) {
        if (networkConfig.getInterfaces().isEnabled()) {
          String msg="Hazelcast CANNOT start on this node. No matching network interface found. ";
          msg+="\nInterface matching must be either disabled or updated in the hazelcast.xml config file.";
          logger.log(Level.SEVERE,msg);
          throw new RuntimeException(msg);
        }
 else {
          if (networkConfig.getJoin().getTcpIpConfig().isEnabled()) {
            logger.log(Level.WARNING,"Could not find a matching address to start with! " + "Picking one of non-loopback addresses.");
          }
          currentInetAddress=pickInetAddress((Collection<String>)null);
        }
      }
    }
  }
  if (currentInetAddress != null) {
    currentInetAddress=AddressUtil.fixScopeIdAndGetInetAddress(currentInetAddress);
  }
  if (currentInetAddress == null) {
    currentInetAddress=pickLoopbackAddress();
  }
  return currentInetAddress;
}

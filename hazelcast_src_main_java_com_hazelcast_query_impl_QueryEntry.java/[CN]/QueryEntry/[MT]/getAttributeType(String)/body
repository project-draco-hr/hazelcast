{
  if (KEY_ATTRIBUTE_NAME.equals(attributeName)) {
    return ReflectionHelper.getAttributeType(getKey().getClass());
  }
 else   if (THIS_ATTRIBUTE_NAME.equals(attributeName)) {
    return ReflectionHelper.getAttributeType(getValue().getClass());
  }
  boolean isKey=isKey(attributeName);
  attributeName=getAttributeName(isKey,attributeName);
  Data data=getOptionalTargetData(isKey);
  if (data != null && data.isPortable()) {
    PortableContext portableContext=serializationService.getPortableContext();
    return PortableExtractor.getAttributeType(portableContext,data,attributeName);
  }
  return ReflectionHelper.getAttributeType(isKey ? getKey() : getValue(),attributeName);
}

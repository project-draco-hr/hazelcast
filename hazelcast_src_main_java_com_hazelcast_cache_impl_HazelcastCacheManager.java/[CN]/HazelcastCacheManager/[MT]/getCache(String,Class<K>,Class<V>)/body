{
  if (isClosed()) {
    throw new IllegalStateException();
  }
  if (keyType == null) {
    throw new NullPointerException("keyType can not be null");
  }
  if (valueType == null) {
    throw new NullPointerException("valueType can not be null");
  }
synchronized (caches) {
    final ICache<?,?> cache=getCacheUnchecked(cacheName);
    if (cache != null) {
      Configuration<?,?> configuration=cache.getConfiguration(CacheConfig.class);
      if (configuration.getKeyType() != null && configuration.getKeyType().equals(keyType)) {
        if (configuration.getValueType() != null && configuration.getValueType().equals(valueType)) {
          return (ICache<K,V>)cache;
        }
 else {
          throw new ClassCastException("Incompatible cache value types specified, expected " + configuration.getValueType() + " but "+ valueType+ " was specified");
        }
      }
 else {
        throw new ClassCastException("Incompatible cache key types specified, expected " + configuration.getKeyType() + " but "+ keyType+ " was specified");
      }
    }
  }
  return null;
}

{
  int totalCount=getPartitionCount(index);
  int avgCount=totalCount / nodes.size();
  for (  PartitionTable table : nodeTables) {
    Set<Integer> partitions=table.getPartitions(index);
    if (partitions.size() > avgCount) {
      Iterator<Integer> iterator=partitions.iterator();
      while (partitions.size() > avgCount) {
        Integer partitionId=iterator.next();
        iterator.remove();
        partitionQ.add(partitionId);
      }
    }
 else {
      underLoadedStates.add(table);
    }
  }
  return avgCount;
}

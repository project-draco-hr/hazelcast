{
  if (callTimeout > 0) {
    return callTimeout;
  }
  BasicOperationService operationService=(BasicOperationService)nodeEngine.operationService;
  final long defaultCallTimeout=operationService.getDefaultCallTimeout();
  if (op instanceof WaitSupport) {
    final long waitTimeoutMillis=((WaitSupport)op).getWaitTimeoutMillis();
    if (waitTimeoutMillis > 0 && waitTimeoutMillis < Long.MAX_VALUE) {
      final long max=Math.max(waitTimeoutMillis,MIN_TIMEOUT);
      return Math.min(max,defaultCallTimeout);
    }
  }
  return defaultCallTimeout;
}

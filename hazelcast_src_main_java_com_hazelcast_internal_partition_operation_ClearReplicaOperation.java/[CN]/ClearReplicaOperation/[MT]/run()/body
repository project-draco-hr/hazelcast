{
  int partitionId=getPartitionId();
  InternalPartitionServiceImpl partitionService=getService();
  PartitionStateManager partitionStateManager=partitionService.getPartitionStateManager();
  InternalPartitionImpl partition=partitionStateManager.getPartitionImpl(partitionId);
  Address thisAddress=getNodeEngine().getThisAddress();
  int currentReplicaIndex=partition.getReplicaIndex(thisAddress);
  if (currentReplicaIndex == -1 || currentReplicaIndex > oldReplicaIndex) {
    if (currentReplicaIndex == -1) {
      partitionService.getReplicaManager().cancelReplicaSync(partitionId);
    }
    ILogger logger=getLogger();
    if (logger.isFinestEnabled()) {
      logger.finest("Clearing partition replica... partitionId=" + partitionId + ", old-replicaIndex="+ oldReplicaIndex+ ", current-replicaIndex="+ currentReplicaIndex);
    }
    clearPartition(partitionId,partitionService);
  }
}

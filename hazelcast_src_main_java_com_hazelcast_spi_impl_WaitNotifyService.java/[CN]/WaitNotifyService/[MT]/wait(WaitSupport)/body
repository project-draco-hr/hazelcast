{
  final WaitNotifyKey key=so.getWaitKey();
  final Queue<WaitingOp> q=ConcurrencyUtil.getOrPutIfAbsent(mapWaitingOps,key,waitQueueConstructor);
  long timeout=so.getWaitTimeoutMillis();
  WaitingOp waitingOp=(so instanceof KeyBasedOperation) ? new KeyBasedWaitingOp(q,so) : new WaitingOp(q,so);
  waitingOp.setNodeEngine(nodeEngine);
  if (timeout > -1 && timeout < 1500) {
    delayQueue.offer(waitingOp);
  }
  q.offer(waitingOp);
}

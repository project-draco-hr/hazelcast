{
  Iterator<NodeEngineImpl> iterator=nodes.values().iterator();
  while (iterator.hasNext()) {
    NodeEngineImpl nodeEngine=iterator.next();
    HazelcastInstance hz=nodeEngine.getHazelcastInstance();
    LifecycleService lifecycleService=hz.getLifecycleService();
    if (terminate) {
      lifecycleService.terminate();
    }
 else {
      lifecycleService.shutdown();
    }
    iterator.remove();
  }
}

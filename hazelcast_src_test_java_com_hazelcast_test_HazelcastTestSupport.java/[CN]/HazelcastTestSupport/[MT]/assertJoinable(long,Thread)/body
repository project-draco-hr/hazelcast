{
  try {
    long remainingTimeoutMs=TimeUnit.SECONDS.toMillis(timeoutSeconds);
    for (    Thread t : threads) {
      long startMs=System.currentTimeMillis();
      t.join(remainingTimeoutMs);
      if (t.isAlive()) {
        fail("Timeout waiting for thread " + t.getName() + " to terminate");
      }
      long durationMs=System.currentTimeMillis() - startMs;
      remainingTimeoutMs-=durationMs;
    }
  }
 catch (  InterruptedException e) {
    e.printStackTrace();
  }
}

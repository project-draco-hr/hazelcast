{
  Map liveThreads=Thread.getAllStackTraces();
  for (Iterator i=liveThreads.keySet().iterator(); i.hasNext(); ) {
    Thread key=(Thread)i.next();
    System.err.println("Thread " + key.getName());
    StackTraceElement[] trace=(StackTraceElement[])liveThreads.get(key);
    for (int j=0; j < trace.length; j++) {
      System.err.println("\tat " + trace[j]);
    }
  }
}

{
  assertTrueEventually(new AssertTask(){
    public void run(){
      Map<Address,PartitionServiceState> states=new HashMap<Address,PartitionServiceState>();
      for (      HazelcastInstance instance : instances) {
        PartitionServiceState state=getPartitionServiceState(instance);
        if (state != PartitionServiceState.SAFE) {
          states.put(getNode(instance).getThisAddress(),state);
        }
      }
      assertTrue("Instances not in safe state! " + states,states.isEmpty());
    }
  }
,timeoutInSeconds);
}

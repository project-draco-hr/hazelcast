{
  assertTrueEventually(new AssertTask(){
    @Override public void run() throws Exception {
      Collection<HazelcastInstance> instances=factory.getAllHazelcastInstances();
      final int actualBackupCount=Math.min(backupCount,instances.size() - 1);
      for (      HazelcastInstance hz : instances) {
        Node node=getNode(hz);
        InternalPartitionService partitionService=node.getPartitionService();
        InternalPartition[] partitions=partitionService.getInternalPartitions();
        for (        InternalPartition partition : partitions) {
          for (int i=0; i <= actualBackupCount; i++) {
            Address replicaAddress=partition.getReplicaAddress(i);
            assertNotNull("Replica " + i + " is not found in "+ partition,replicaAddress);
            assertTrue("Not member: " + replicaAddress,node.getClusterService().getMember(replicaAddress) != null);
          }
        }
      }
    }
  }
);
}

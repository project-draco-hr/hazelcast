{
  op.setCallerUuid(endpoint.getUuid());
  final InvocationBuilder builder;
  if (target == null) {
    builder=nodeEngine.getOperationService().createInvocationBuilder(serviceName,op,partitionId).setReplicaIndex(replicaIndex);
  }
 else {
    builder=nodeEngine.getOperationService().createInvocationBuilder(serviceName,op,target);
  }
  builder.setTryCount(100).setCallTimeout(20 * 1000);
  Invocation inv=builder.build();
  Future f=inv.invoke();
  return f.get(30,TimeUnit.SECONDS);
}

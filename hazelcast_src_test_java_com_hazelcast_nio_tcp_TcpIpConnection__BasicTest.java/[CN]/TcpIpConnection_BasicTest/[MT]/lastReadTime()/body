{
  TcpIpConnection connAB=connect(connManagerA,addressB);
  TcpIpConnection connBA=connect(connManagerB,addressA);
  sleepSeconds(5);
  Packet packet=new Packet(serializationService.toBytes("foo"));
  connAB.write(packet);
  assertTrueEventually(new AssertTask(){
    @Override public void run() throws Exception {
      assertEquals(1,packetsB.size());
    }
  }
);
  long result=connBA.lastReadTime();
  long current=System.currentTimeMillis();
  final int marginOfErrorMs=1000;
  assertTrue(current + marginOfErrorMs > result);
  assertTrue(current - marginOfErrorMs < result);
}

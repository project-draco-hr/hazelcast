{
  logger.finest("Carrying " + recordSet.size() + " records for partition -> "+ getPartitionId()+ " from -> "+ getCallerAddress()+ ", to -> "+ getNodeEngine().getThisAddress());
  ReplicatedMapService service=getService();
  AbstractReplicatedRecordStore store=(AbstractReplicatedRecordStore)service.getReplicatedRecordStore(name,true,getPartitionId());
  InternalReplicatedMapStorage<K,V> newStorage=new InternalReplicatedMapStorage<K,V>();
  for (  RecordMigrationInfo record : recordSet) {
    K key=(K)store.marshall(record.getKey());
    V value=(V)store.marshall(record.getValue());
    newStorage.putInternal(key,buildReplicatedRecord(key,value,record.getTtl()));
  }
  newStorage.setVersion(version);
  AtomicReference<InternalReplicatedMapStorage<K,V>> storageRef=store.getStorageRef();
  storageRef.set(newStorage);
  store.setLoaded(true);
}

{
  if (transaction.getState() != Transaction.State.ACTIVE) {
    throw new IllegalStateException("Transaction is not active!");
  }
  transaction.attachParticipant(getServiceName(),partitionId);
  return transaction.getTxnId();
}

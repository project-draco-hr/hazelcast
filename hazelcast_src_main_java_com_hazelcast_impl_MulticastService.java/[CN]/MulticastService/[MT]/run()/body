{
  Config config=node.getConfig();
  while (running) {
    try {
      Runnable runnable=queue.poll();
      if (runnable != null) {
        runnable.run();
        return;
      }
      final JoinInfo joinInfo=receive();
      if (joinInfo != null) {
        if (node.address != null && !node.address.equals(joinInfo.address)) {
          if (config.getGroupConfig().getName().equals(joinInfo.groupName) && config.getGroupConfig().getPassword().equals(joinInfo.groupPassword)) {
            if (node.master()) {
              if (joinInfo.request) {
                send(joinInfo.copy(false,node.address));
              }
            }
 else {
              if (!node.joined() && !joinInfo.request) {
                if (node.masterAddress == null) {
                  node.masterAddress=new Address(joinInfo.address);
                }
              }
            }
          }
        }
      }
    }
 catch (    Exception e) {
      e.printStackTrace();
    }
  }
}

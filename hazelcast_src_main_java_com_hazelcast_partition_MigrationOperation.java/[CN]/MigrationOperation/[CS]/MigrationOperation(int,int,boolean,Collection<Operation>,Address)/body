{
  super();
  setPartitionId(partitionId).setReplicaIndex(replicaIndex);
  this.move=move;
  this.from=from;
  this.tasks=tasks;
  this.taskCount=tasks.size();
  ByteArrayOutputStream bos=new ByteArrayOutputStream(8192 * taskCount);
  DataOutputStream out=null;
  try {
    out=new DataOutputStream(new DeflaterOutputStream(bos));
    out.writeInt(taskCount);
    for (    Operation task : tasks) {
      IOUtil.writeObject(out,task);
    }
  }
  finally {
    IOUtil.closeResource(out);
  }
  bytesRecordSet=bos.toByteArray();
}

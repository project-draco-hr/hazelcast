{
  boolean error=false;
  final NodeEngineImpl nodeEngine=(NodeEngineImpl)getNodeEngine();
  final PartitionServiceImpl partitionService=getService();
  partitionService.addActiveMigration(migrationInfo);
  for (  Operation op : tasks) {
    try {
      op.setNodeEngine(nodeEngine).setPartitionId(getPartitionId()).setReplicaIndex(getReplicaIndex());
      op.setResponseHandler(ERROR_RESPONSE_HANDLER);
      OperationAccessor.setCallerAddress(op,migrationInfo.getSource());
      MigrationAwareService service=op.getService();
      service.beforeMigration(new PartitionMigrationEvent(MigrationEndpoint.DESTINATION,migrationInfo.getPartitionId()));
      op.beforeRun();
      op.run();
      op.afterRun();
    }
 catch (    Throwable e) {
      error=true;
      getLogger().log(Level.SEVERE,"While executing " + op,e);
      break;
    }
  }
  return !error;
}

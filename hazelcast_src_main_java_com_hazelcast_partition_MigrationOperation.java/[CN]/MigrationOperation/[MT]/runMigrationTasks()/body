{
  boolean error=false;
  final NodeServiceImpl nodeService=(NodeServiceImpl)getNodeService();
  final PartitionService partitionService=getService();
  partitionService.addActiveMigration(new MigrationInfo(getPartitionId(),getReplicaIndex(),copyBackReplicaIndex,migrationType,from,nodeService.getThisAddress()));
  for (  Operation op : tasks) {
    try {
      op.setNodeService(nodeService).setCaller(from).setPartitionId(getPartitionId()).setReplicaIndex(getReplicaIndex());
      op.setResponseHandler(ERROR_RESPONSE_HANDLER);
      MigrationAwareService service=op.getService();
      service.beforeMigration(new MigrationServiceEvent(MigrationEndpoint.DESTINATION,getPartitionId(),getReplicaIndex(),migrationType,copyBackReplicaIndex));
      op.beforeRun();
      op.run();
      op.afterRun();
    }
 catch (    Throwable e) {
      error=true;
      getLogger().log(Level.SEVERE,"While executing " + op,e);
      break;
    }
  }
  return !error;
}

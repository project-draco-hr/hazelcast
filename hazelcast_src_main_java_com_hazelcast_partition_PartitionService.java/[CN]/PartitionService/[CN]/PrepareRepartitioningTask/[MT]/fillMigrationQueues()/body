{
  lastRepartitionTime.set(Clock.currentTimeMillis());
  if (!lostQ.isEmpty()) {
    immediateTasksQueue.offer(new AssignLostPartitions(lostQ));
    logger.log(Level.WARNING,"Assigning new owners for " + lostQ.size() + " LOST partitions!");
  }
  for (  MigrationInfo migrationInfo : immediateQ) {
    immediateTasksQueue.offer(new Migrator(migrationInfo));
  }
  immediateQ.clear();
  for (  MigrationInfo migrationInfo : scheduledQ) {
    scheduledTasksQueue.offer(new Migrator(migrationInfo));
  }
  scheduledQ.clear();
}

{
  final int partitionId=migrationRequestOp.getPartitionId();
  final int replicaIndex=migrationRequestOp.getReplicaIndex();
  final PartitionInfo partition=partitions[partitionId];
  if (PartitionInfo.MAX_REPLICA_COUNT < replicaIndex) {
    String msg="Migrated [" + partitionId + ":"+ replicaIndex+ "] but cannot assign. Length:"+ PartitionInfo.MAX_REPLICA_COUNT;
    logger.log(Level.WARNING,msg);
  }
 else {
    lock.lock();
    try {
      Address newOwner=migrationInfo.getToAddress();
      MemberImpl ownerMember=node.clusterService.getMember(newOwner);
      if (ownerMember == null)       return;
      partition.setReplicaAddress(replicaIndex,newOwner);
      if (migrationInfo.getCopyBackReplicaIndex() > -1) {
        partition.setReplicaAddress(migrationInfo.getCopyBackReplicaIndex(),migrationInfo.getFromAddress());
      }
      finalizeMigration();
      fireMigrationEvent(MigrationStatus.COMPLETED);
    }
  finally {
      lock.unlock();
    }
  }
}

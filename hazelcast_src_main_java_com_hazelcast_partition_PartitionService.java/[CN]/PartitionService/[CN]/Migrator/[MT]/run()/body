{
  try {
    if (!node.isActive() || !node.isMaster()) {
      return;
    }
    fireMigrationEvent(MigrationStatus.STARTED);
    if (migrationRequestOp.getToAddress() == null) {
      logger.log(Level.FINEST,"Fixing partition, " + migrationRequestOp.getReplicaIndex() + ". replica of partition["+ migrationRequestOp.getPartitionId()+ "] should be removed.");
      removeReplicaOwner();
    }
 else {
      MemberImpl fromMember=null;
      Boolean result=Boolean.FALSE;
      if (migrationRequestOp.isMigration()) {
        fromMember=getMember(migrationRequestOp.getFromAddress());
      }
 else {
        final int partitionId=migrationRequestOp.getPartitionId();
        fromMember=getMember(partitions[partitionId].getOwner());
      }
      logger.log(Level.FINEST,"Started Migration : " + migrationRequestOp);
      systemLogService.logPartition("Started Migration : " + migrationRequestOp);
      if (fromMember != null) {
        migrationRequestOp.setFromAddress(fromMember.getAddress());
        Invocation inv=nodeService.createInvocationBuilder(SERVICE_NAME,migrationRequestOp,migrationRequestOp.getFromAddress()).setTryCount(3).setTryPauseMillis(1000).setReplicaIndex(migrationRequestOp.getReplicaIndex()).build();
        Future future=inv.invoke();
        try {
          result=(Boolean)IOUtil.toObject(future.get(partitionMigrationTimeout,TimeUnit.SECONDS));
        }
 catch (        Throwable e) {
          logger.log(Level.WARNING,"Failed migrating from " + fromMember,e);
        }
      }
 else {
        result=Boolean.TRUE;
      }
      logger.log(Level.FINEST,"Finished Migration : " + migrationRequestOp);
      systemLogService.logPartition("Finished Migration : " + migrationRequestOp);
      if (Boolean.TRUE.equals(result)) {
        processMigrationResult();
      }
 else {
        logger.log(Level.WARNING,"Migration task has failed => " + migrationRequestOp);
        migrationTaskFailed();
      }
    }
  }
 catch (  Throwable t) {
    logger.log(Level.WARNING,"Error [" + t.getClass() + ": "+ t.getMessage()+ "] "+ "while executing "+ migrationRequestOp);
    logger.log(Level.FINEST,t.getMessage(),t);
    migrationTaskFailed();
  }
}

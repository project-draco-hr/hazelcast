{
  if (!initialized)   return false;
  if (node.isLiteMember())   return false;
  int maxBackupCount=getMaxBackupCount();
  if (maxBackupCount == 0)   return false;
  MemberGroupFactory mgf=PartitionStateGeneratorFactory.newMemberGroupFactory(node.config.getPartitionGroupConfig());
  if (mgf.createMemberGroups(node.getClusterService().getMembers()).size() < 2)   return false;
  boolean needBackup=false;
  if (immediateTasksQueue.isEmpty()) {
    for (    PartitionInfo partition : partitions) {
      if (partition.getReplicaAddress(1) == null) {
        needBackup=true;
        logger.log(Level.WARNING,node.getThisAddress() + " still has no replica for partitionId:" + partition.getPartitionId());
        break;
      }
    }
  }
  return needBackup || !immediateTasksQueue.isEmpty();
}

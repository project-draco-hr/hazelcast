{
  for (  Record record : records.values()) {
    if (flushAllRecords || record.getState().isDirty()) {
      mapContainer.getStore().store(mapService.toObject(record.getKey()),mapService.toObject(record.getValue()));
      record.onStore();
    }
  }
  for (  Data key : toBeRemovedKeys) {
    if (toBeRemovedKeys.remove(key))     mapContainer.getStore().delete(mapService.toObject(key));
  }
}

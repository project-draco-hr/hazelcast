{
  MapProxyImpl mapProxy=(MapProxyImpl)map;
  MapService mapService=(MapService)mapProxy.getService();
  MapServiceContext mapServiceContext=mapService.getMapServiceContext();
  NodeEngine nodeEngine=mapServiceContext.getNodeEngine();
  InternalPartitionService partitionService=nodeEngine.getPartitionService();
  int partitionId=partitionService.getPartitionId(key);
  PartitionContainer container=mapServiceContext.getPartitionContainer(partitionId);
  RecordStore recordStore=container.getRecordStore(map.getName());
  return (DefaultRecordStore)recordStore;
}

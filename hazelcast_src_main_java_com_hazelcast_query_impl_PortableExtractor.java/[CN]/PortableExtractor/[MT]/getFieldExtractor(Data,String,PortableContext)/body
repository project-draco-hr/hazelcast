{
  FieldDefinition fieldDefinition=getFieldDefinition(data,fieldName,portableContext);
  int fieldType=fieldDefinition.getType().getId();
  if (fieldType < 0 || fieldType >= FIELD_EXTRACTORS.length) {
    throw new ArrayIndexOutOfBoundsException("Invalid fieldType: " + fieldType);
  }
  PortableFieldExtractor fieldExtractor=FIELD_EXTRACTORS[fieldType];
  if (fieldExtractor == null) {
    throw new QueryException("Field extractor is not defined: " + fieldType);
  }
  return fieldExtractor;
}

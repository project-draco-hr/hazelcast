{
  if (isClosed()) {
    throw new IllegalStateException();
  }
  if (keyType == null) {
    throw new NullPointerException("keyType can not be null");
  }
  if (valueType == null) {
    throw new NullPointerException("valueType can not be null");
  }
  final CacheConfig<?,?> configuration=hazelcastInstance.getConfig().getCacheConfig(cacheName);
  if (configuration.getKeyType() != null && configuration.getKeyType().equals(keyType)) {
    if (configuration.getValueType() != null && configuration.getValueType().equals(valueType)) {
      return getCacheObject(cacheName);
    }
 else {
      throw new ClassCastException("Incompatible cache value types specified, expected " + configuration.getValueType() + " but "+ valueType+ " was specified");
    }
  }
 else {
    throw new ClassCastException("Incompatible cache key types specified, expected " + configuration.getKeyType() + " but "+ keyType+ " was specified");
  }
}

{
  String result;
  try {
    SecretKeySpec signingKey=new SecretKeySpec(stringToBytes(key),SIGNATURE_METHOD);
    Mac mac=Mac.getInstance(SIGNATURE_METHOD);
    mac.init(signingKey);
    byte[] rawSignature=mac.doFinal(stringToBytes(data));
    result=bytesToString(encode(rawSignature));
    result=result.trim();
  }
 catch (  Exception e) {
    throw new SignatureException("Failed to generate HMAC : " + e.getMessage());
  }
  return result;
}

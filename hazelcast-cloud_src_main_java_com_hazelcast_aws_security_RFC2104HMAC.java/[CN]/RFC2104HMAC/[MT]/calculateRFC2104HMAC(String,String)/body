{
  String result=null;
  try {
    SecretKeySpec signingKey=new SecretKeySpec(key.getBytes(),SIGNATURE_METHOD);
    Mac mac=Mac.getInstance(SIGNATURE_METHOD);
    mac.init(signingKey);
    byte[] rawSignature=mac.doFinal(data.getBytes());
    result=new String(encode(rawSignature));
    result=result.trim();
  }
 catch (  Exception e) {
    throw new SignatureException("Failed to generate HMAC : " + e.getMessage());
  }
  return result;
}

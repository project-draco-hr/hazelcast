{
  SemaphoreConfig semaphoreConfig=new SemaphoreConfig("default",10);
  Config config=new Config();
  config.addSemaphoreConfig(semaphoreConfig);
  HazelcastInstance instance=Hazelcast.newHazelcastInstance(config);
  HazelcastClient client1=newHazelcastClient(instance);
  HazelcastClient client2=newHazelcastClient(instance);
  ISemaphore semaphore1=client1.getSemaphore("test");
  ISemaphore semaphore2=client2.getSemaphore("test");
  semaphore2.tryAcquireAttach(5);
  semaphore2.tryAcquire(3);
  semaphore2.detach(2);
  assertEquals(2,semaphore1.availablePermits());
  client2.shutdown();
  assertEquals(5,semaphore1.availablePermits());
}

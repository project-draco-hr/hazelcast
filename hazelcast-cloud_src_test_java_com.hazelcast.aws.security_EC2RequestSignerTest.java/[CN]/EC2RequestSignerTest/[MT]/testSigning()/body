{
  AwsConfig awsConfig=new AwsConfig();
  awsConfig.setRegion(TEST_REGION);
  awsConfig.setHostHeader(TEST_HOST);
  awsConfig.setAccessKey(TEST_ACCESS_KEY);
  awsConfig.setSecretKey(TEST_SECRET_KEY);
  DescribeInstances di=new DescribeInstances(awsConfig);
  Field field=di.getClass().getDeclaredField("attributes");
  field.setAccessible(true);
  Map<String,String> attributes=(Map<String,String>)field.get(di);
  field.set(di,attributes);
  EC2RequestSigner rs=new EC2RequestSigner(awsConfig,TEST_REQUEST_DATE);
  String signature=rs.sign(TEST_SERVICE,attributes);
  assertEquals(TEST_SIGNATURE_EXPECTED,signature);
}

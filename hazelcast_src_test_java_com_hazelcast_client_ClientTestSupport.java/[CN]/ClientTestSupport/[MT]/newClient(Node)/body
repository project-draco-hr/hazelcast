{
  if (node.isActive()) {
    if (TestEnvironment.isMockNetwork()) {
      ClientEngineImpl engine=node.clientEngine;
      return new MockSimpleClient(engine);
    }
 else {
      return new SocketSimpleClient(node);
    }
  }
  throw new IllegalArgumentException("Node is not active: " + node.getThisAddress());
}

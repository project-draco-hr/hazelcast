{
  TransactionalQueue txnq=newTransactionalQueueProxy("test");
  TransactionalQueue txnq2=newTransactionalQueueProxy("test");
  txnq.offer("item0");
  assertEquals(1,txnq.size());
  assertEquals(1,txnq2.size());
  txnq.begin();
  txnq.offer("item");
  Iterator it=txnq.iterator();
  int size=0;
  while (it.hasNext()) {
    assertNotNull(it.next());
    size++;
  }
  assertEquals(2,size);
  it=txnq2.iterator();
  size=0;
  while (it.hasNext()) {
    assertNotNull(it.next());
    size++;
  }
  assertEquals(1,size);
  txnq.rollback();
  it=txnq.iterator();
  size=0;
  while (it.hasNext()) {
    assertNotNull(it.next());
    size++;
  }
  assertEquals(1,size);
  it=txnq2.iterator();
  size=0;
  while (it.hasNext()) {
    assertNotNull(it.next());
    size++;
  }
  assertEquals(1,size);
  assertEquals(1,txnq.size());
  assertEquals(1,txnq2.size());
}

{
  final int SIZE=3;
  BlockingQueue<Integer> queue=Hazelcast.getQueue("issue423");
  Transaction txn=Hazelcast.getTransaction();
  txn.begin();
  for (int i=0; i < SIZE; i++) {
    assertTrue(queue.offer(i));
  }
  txn.commit();
  assertNotNull(queue.peek());
  assertEquals(SIZE,queue.size());
  txn=Hazelcast.getTransaction();
  txn.begin();
  Integer value=queue.poll();
  assertNotNull(value);
  assertEquals(0,value.intValue());
  txn.rollback();
  assertEquals(0,queue.poll().intValue());
  assertEquals(1,queue.poll().intValue());
  assertEquals(2,queue.poll().intValue());
}

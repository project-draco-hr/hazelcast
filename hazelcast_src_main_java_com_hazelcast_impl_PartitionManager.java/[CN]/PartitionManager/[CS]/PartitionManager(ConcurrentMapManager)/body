{
  this.PARTITION_COUNT=concurrentMapManager.getPartitionCount();
  this.concurrentMapManager=concurrentMapManager;
  this.logger=concurrentMapManager.node.getLogger(PartitionManager.class.getName());
  this.partitions=new PartitionInfo[PARTITION_COUNT];
  for (int i=0; i < PARTITION_COUNT; i++) {
    this.partitions[i]=new PartitionInfo(i);
  }
  esMigrationService.scheduleAtFixedRate(new Runnable(){
    public void run(){
      concurrentMapManager.enqueueAndWait(new Processable(){
        public void process(){
          if (!concurrentMapManager.node.isActive())           return;
          sendClusterRuntimeState();
        }
      }
,1000);
    }
  }
,5,5,TimeUnit.SECONDS);
}

{
  if (concurrentMapManager.isMaster()) {
    if (initialized) {
      esMigrationService.getQueue().clear();
      PartitionStateGenerator psg=PartitionStateGeneratorFactory.newRandomPartitionStateGenerator();
      Queue<MigrationRequestTask> migrationQ=new LinkedList<MigrationRequestTask>();
      Queue<MigrationRequestTask> replicaQ=new LinkedList<MigrationRequestTask>();
      psg.reArrange(partitions,concurrentMapManager.lsMembers,PARTITION_COUNT,migrationQ,replicaQ);
      int count=0;
      for (      MigrationRequestTask migrationRequestTask : replicaQ) {
        esMigrationService.schedule(new Migrator(migrationRequestTask),0 * count++,TimeUnit.SECONDS);
      }
      for (      MigrationRequestTask migrationRequestTask : migrationQ) {
        esMigrationService.schedule(new Migrator(migrationRequestTask),0 * count++,TimeUnit.SECONDS);
      }
    }
    sendClusterRuntimeState();
  }
}

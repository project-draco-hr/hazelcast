{
  final Address thisAddress=node.getThisAddress();
  node.clusterManager.enqueueAndWait(new Processable(){
    public void process(){
      addActiveMigration(partitionId,replicaIndex,thisAddress,newAddress);
    }
  }
);
  final Collection<MigrationAware> services=node.nodeService.getServices(MigrationAware.class);
  final Collection<ServiceMigrationOperation> tasks=new LinkedList<ServiceMigrationOperation>();
  for (  MigrationAware service : services) {
    ServiceMigrationOperation op=service.getMigrationTask(partitionId,replicaIndex,diffOnly);
    if (op != null) {
      tasks.add(op);
    }
  }
  return tasks;
}

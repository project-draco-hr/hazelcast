{
  if (deadAddress == null || deadAddress.equals(thisAddress)) {
    return;
  }
  Set<Integer> blocksOwnedAfterDead=new HashSet<Integer>();
  for (  Block block : blocks) {
    if (block != null) {
      syncForDead(deadAddress,block);
      if (thisAddress.equals(block.getOwner())) {
        blocksOwnedAfterDead.add(block.getBlockId());
      }
    }
  }
  Collection<CMap> cmaps=concurrentMapManager.maps.values();
  for (  CMap cmap : cmaps) {
    Collection<Record> records=cmap.mapRecords.values();
    for (    Record record : records) {
      if (record != null) {
        cmap.onDisconnect(record,deadAddress);
        if (record.isActive() && blocksOwnedAfterDead.contains(record.getBlockId())) {
          cmap.markAsOwned(record);
          int valueHash=record.getValueHash();
          long[] indexes=record.getIndexes();
          byte[] indexTypes=record.getIndexTypes();
          record.setValueHash(Integer.MIN_VALUE);
          record.setIndexes(null,null);
          node.queryService.updateIndex(cmap.getName(),indexes,indexTypes,record,valueHash);
        }
      }
    }
  }
  onMembershipChange();
}

{
  if (!node.isMaster() || !node.isActive() || !node.joined()) {
    return;
  }
  if (!migrationActive.get()) {
    return;
  }
  if (!initialized) {
    return;
  }
  lock.lock();
  try {
    final long clusterTime=node.getClusterImpl().getClusterTime();
    final Collection<MemberImpl> members=node.clusterManager.getMembers();
    final List<MemberInfo> memberInfos=new ArrayList<MemberInfo>(members.size());
    for (    MemberImpl member : members) {
      memberInfos.add(new MemberInfo(member.getAddress(),member.getNodeType(),member.getUuid()));
    }
    PartitionStateOperation operation=new PartitionStateOperation(memberInfos,partitions,clusterTime,version.get());
    for (    MemberImpl member : members) {
      if (!member.localMember()) {
        nodeService.createSingleInvocation(PARTITION_SERVICE_NAME,operation,-1).setTarget(member.getAddress()).setTryCount(1).build().invoke();
      }
    }
  }
  finally {
    lock.unlock();
  }
}

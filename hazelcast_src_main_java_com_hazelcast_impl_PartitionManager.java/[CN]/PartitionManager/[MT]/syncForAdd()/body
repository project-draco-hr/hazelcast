{
  invalidateBlocksHash();
  if (concurrentMapManager.isMaster()) {
    if (concurrentMapManager.isLiteMember()) {
      MemberImpl nonSuperMember=null;
      for (      MemberImpl member : concurrentMapManager.getMembers()) {
        if (!member.isSuperClient()) {
          nonSuperMember=member;
        }
      }
      if (nonSuperMember != null) {
        for (int i=0; i < PARTITION_COUNT; i++) {
          Block block=blocks[i];
          if (block == null) {
            block=getOrCreateBlock(i);
          }
          if (block.getOwner() == null) {
            block.setOwner(nonSuperMember.getAddress());
          }
        }
      }
    }
    for (int i=0; i < PARTITION_COUNT; i++) {
      Block block=blocks[i];
      if (block == null) {
        block=getOrCreateBlock(i);
      }
    }
    if (node.groupProperties.INITIAL_WAIT_SECONDS.getInteger() == 0 && node.groupProperties.INITIAL_MIN_CLUSTER_SIZE.getInteger() == 0) {
      quickBlockRearrangement();
    }
 else {
      createAllBlocks();
      sendBlocks(null);
    }
  }
  InitialState initialState=new InitialState();
  Collection<CMap> cmaps=concurrentMapManager.maps.values();
  for (  final CMap cmap : cmaps) {
    initialState.createAndAddMapState(cmap);
  }
  concurrentMapManager.sendProcessableToAll(initialState,false);
  onMembershipChange(true);
}

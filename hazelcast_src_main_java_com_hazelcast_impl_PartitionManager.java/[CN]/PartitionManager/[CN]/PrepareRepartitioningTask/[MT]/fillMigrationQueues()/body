{
  lastRepartitionTime.set(Clock.currentTimeMillis());
  if (!lostQ.isEmpty()) {
    concurrentMapManager.enqueueAndReturn(new LostPartitionsAssignmentProcess(lostQ));
    logger.log(Level.WARNING,"Assigning new owners for " + lostQ.size() + " LOST partitions!");
  }
  for (  MigrationRequestTask migrationRequestTask : immediateQ) {
    immediateTasksQueue.offer(new Migrator(migrationRequestTask));
  }
  immediateQ.clear();
  for (  MigrationRequestTask migrationRequestTask : scheduledQ) {
    scheduledTasksQueue.offer(new Migrator(migrationRequestTask));
  }
  scheduledQ.clear();
}

{
  final NodeEngine nodeEngine=getNodeEngine();
  Invocation invocation=nodeEngine.getOperationService().createInvocationBuilder(SERVICE_NAME,operation,partitionId).build();
  Future f=invocation.invoke();
  Object response=f.get();
  Object returnObj;
  if (response instanceof Response) {
    Response r=(Response)response;
    returnObj=r.getResult();
  }
 else {
    returnObj=nodeEngine.toObject(response);
  }
  if (returnObj instanceof Throwable) {
    throw (Throwable)returnObj;
  }
  return returnObj;
}

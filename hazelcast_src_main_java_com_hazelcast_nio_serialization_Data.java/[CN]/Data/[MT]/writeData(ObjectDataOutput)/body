{
  out.writeInt(type);
  if (cd != null) {
    out.writeInt(cd.getClassId());
    out.writeInt(cd.getVersion());
    byte[] classDefBytes=cd.getBinary();
    out.writeInt(classDefBytes.length);
    out.write(classDefBytes);
  }
 else {
    out.writeInt(NO_CLASS_ID);
  }
  int size=bufferSize();
  out.writeInt(size);
  if (size > 0) {
    out.write(buffer);
  }
  out.writeInt(partitionHash);
}

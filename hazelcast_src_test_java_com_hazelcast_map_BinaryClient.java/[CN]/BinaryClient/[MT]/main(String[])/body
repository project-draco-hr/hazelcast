{
  Config config=new Config();
  final HazelcastInstance hz=Hazelcast.newHazelcastInstance(config);
  IMap<Object,Object> map=hz.getMap("test");
  map.put(1,1);
  final SerializationService ss=new SerializationServiceImpl(0);
  final Client c=new Client();
  c.auth();
  final Thread thread=new Thread(){
    public void run(){
      try {
        c.send(new MapAddEntryListenerRequest("test"));
        while (!isInterrupted()) {
          System.err.println("--> " + c.receive());
        }
        c.close();
      }
 catch (      IOException e) {
        e.printStackTrace();
      }
    }
  }
;
  thread.start();
  Thread.sleep(100);
  for (int i=0; i < 10; i++) {
    map.put(i,i);
  }
  Thread.sleep(10);
  thread.interrupt();
  Thread.sleep(1000);
  c.close();
  thread.join();
  map.put(1111,1111);
  Thread.sleep(2000);
  Hazelcast.shutdownAll();
}

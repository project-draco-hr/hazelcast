{
  internalMigrationListener.onMigrationComplete(MigrationParticipant.MASTER,migrationInfo,true);
  addCompletedMigration(migrationInfo);
  boolean commitSuccessful=commitMigrationToDestination(migrationInfo,addresses);
  lock.lock();
  try {
    if (commitSuccessful) {
      updatePartitionReplicaAddresses(migrationInfo.getPartitionId(),addresses);
      internalMigrationListener.onMigrationCommit(MigrationParticipant.MASTER,migrationInfo);
    }
 else {
      internalMigrationListener.onMigrationRollback(MigrationParticipant.MASTER,migrationInfo);
    }
    scheduleActiveMigrationFinalization(migrationInfo);
    syncPartitionRuntimeState();
  }
  finally {
    lock.unlock();
  }
  sendMigrationEvent(migrationInfo,MigrationStatus.COMPLETED);
}

{
  internalMigrationListener.onMigrationComplete(MigrationParticipant.MASTER,migrationInfo,true);
  lock.lock();
  try {
    final int partitionId=migrationInfo.getPartitionId();
    InternalPartitionImpl partition=partitions[partitionId];
    partition.setReplicaAddresses(addresses);
    addCompletedMigration(migrationInfo);
    finalizeActiveMigration(migrationInfo);
    internalMigrationListener.onMigrationCommit(MigrationParticipant.MASTER,migrationInfo);
    syncPartitionRuntimeState();
  }
  finally {
    lock.unlock();
  }
  sendMigrationEvent(migrationInfo,MigrationStatus.COMPLETED);
}

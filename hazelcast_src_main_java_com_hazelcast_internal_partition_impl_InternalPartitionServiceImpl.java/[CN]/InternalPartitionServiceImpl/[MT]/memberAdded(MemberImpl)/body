{
  if (!member.localMember()) {
    partitionStateManager.updateMemberGroupsSize();
  }
  lastMaster=node.getMasterAddress();
  if (node.isMaster()) {
    lock.lock();
    try {
      if (partitionStateManager.isInitialized()) {
        final ClusterState clusterState=nodeEngine.getClusterService().getClusterState();
        if (clusterState == ClusterState.ACTIVE) {
          partitionStateManager.incrementVersion();
          migrationManager.triggerRepartitioning();
        }
      }
    }
  finally {
      lock.unlock();
    }
  }
}

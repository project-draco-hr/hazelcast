{
  if (!member.localMember()) {
    updateMemberGroupsSize();
  }
  if (node.isMaster()) {
    lock.lock();
    try {
      migrationQueue.clear();
      if (initialized) {
        ClusterState clusterState=nodeEngine.getClusterService().getClusterState();
        if (clusterState == ClusterState.ACTIVE) {
          stateVersion.incrementAndGet();
          migrationQueue.add(new RepartitioningTask());
        }
        PartitionStateOperation op=new PartitionStateOperation(createPartitionState());
        nodeEngine.getOperationService().send(op,member.getAddress());
      }
    }
  finally {
      lock.unlock();
    }
  }
}

{
  if (initialized) {
    return;
  }
  ClusterState clusterState=node.getClusterService().getClusterState();
  if (clusterState != ClusterState.ACTIVE) {
    logger.warning("Partitions can't be assigned since cluster-state= " + clusterState);
    return;
  }
  if (lock.tryLock()) {
    try {
      if (!initialized && !node.isMaster() && node.getMasterAddress() != null && node.joined()) {
        Future f=nodeEngine.getOperationService().createInvocationBuilder(SERVICE_NAME,new AssignPartitions(),node.getMasterAddress()).setTryCount(1).invoke();
        f.get(1,TimeUnit.SECONDS);
      }
    }
 catch (    Exception e) {
      logger.finest(e);
    }
 finally {
      lock.unlock();
    }
  }
}

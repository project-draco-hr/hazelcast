{
  Collection<MigrationInfo> completedMigrations=partitionState.getCompletedMigrations();
  for (  MigrationInfo completedMigration : completedMigrations) {
    migrationManager.addCompletedMigration(completedMigration);
    int partitionId=completedMigration.getPartitionId();
    PartitionInfo partitionInfo=state[partitionId];
    partitionStateManager.updateReplicaAddresses(partitionInfo.getPartitionId(),partitionInfo.getReplicaAddresses());
    migrationManager.scheduleActiveMigrationFinalization(completedMigration);
  }
  updateAllPartitions(state);
}

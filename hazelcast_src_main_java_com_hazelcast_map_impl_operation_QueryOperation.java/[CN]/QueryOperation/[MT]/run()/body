{
  NodeEngine nodeEngine=getNodeEngine();
  MapService service=getService();
  final MapServiceContext mapServiceContext=service.getMapServiceContext();
  InternalPartitionService partitionService=nodeEngine.getPartitionService();
  Collection<Integer> initialPartitions=mapService.getMapServiceContext().getOwnedPartitions();
  int partitionStateVersion=partitionService.getPartitionStateVersion();
  IndexService indexService=mapService.getMapServiceContext().getMapContainer(name).getIndexService();
  Set<QueryableEntry> entries=null;
  if (!partitionService.hasOnGoingMigrationLocal()) {
    entries=indexService.query(predicate);
  }
  result=new QueryResult();
  if (entries != null) {
    for (    QueryableEntry entry : entries) {
      QueryResultEntryImpl resultEntry=new QueryResultEntryImpl(entry.getKeyData(),entry.getKeyData(),entry.getValueData());
      result.add(resultEntry);
    }
  }
 else {
    if (pagingPredicate != null) {
      runParallelForPaging(initialPartitions);
    }
 else {
      runParallel(initialPartitions);
    }
  }
  Collection<Integer> finalPartitions=mapServiceContext.getOwnedPartitions();
  if (initialPartitions.equals(finalPartitions)) {
    result.setPartitionIds(finalPartitions);
  }
  if (mapContainer.getMapConfig().isStatisticsEnabled()) {
    LocalMapStatsImpl localMapStatsImpl=mapServiceContext.getLocalMapStatsProvider().getLocalMapStatsImpl(name);
    localMapStatsImpl.incrementOtherOperations();
  }
  checkPartitionStateChanges(partitionService,partitionStateVersion);
}

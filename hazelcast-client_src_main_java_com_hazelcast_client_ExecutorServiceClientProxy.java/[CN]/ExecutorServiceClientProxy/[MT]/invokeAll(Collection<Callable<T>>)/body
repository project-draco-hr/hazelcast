{
  if (callables == null)   throw new NullPointerException();
  List<Future<T>> futures=new ArrayList<Future<T>>(callables.size());
  boolean done=false;
  try {
    for (    Callable<T> command : callables) {
      futures.add(submit(command));
    }
    for (    Future<T> f : futures) {
      if (!f.isDone()) {
        try {
          f.get();
        }
 catch (        CancellationException ignore) {
        }
catch (        ExecutionException ignore) {
        }
      }
    }
    done=true;
    return futures;
  }
  finally {
    if (!done)     for (    Future<T> f : futures)     f.cancel(true);
  }
}

{
  Set<Data> lockedKeySet=lockStore == null ? EMPTY_SET : lockStore.getLockedKeys();
  Set<Data> keySet=storage.keySet();
  if (keySet.isEmpty()) {
    return emptyList();
  }
  int notLockedKeyCount=keySet.size() - lockedKeySet.size();
  if (notLockedKeyCount == 0) {
    return emptyList();
  }
  List<Data> notLockedKeys=new ArrayList<Data>(notLockedKeyCount);
  for (  Data keyData : keySet) {
    if (lockedKeySet.isEmpty()) {
      notLockedKeys.add(keyData);
    }
 else     if (!lockedKeySet.contains(keyData)) {
      notLockedKeys.add(keyData);
    }
  }
  return notLockedKeys;
}

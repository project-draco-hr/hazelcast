{
  checkIfLoaded();
  final long now=getNow();
  final Record record=getRecordOrNull(key,now,false);
  Object oldValue;
  boolean removed=false;
  if (record == null) {
    oldValue=mapDataStore.load(key);
    if (oldValue == null) {
      return false;
    }
  }
 else {
    oldValue=record.getValue();
  }
  if (mapServiceContext.compare(name,testValue,oldValue)) {
    mapServiceContext.interceptRemove(name,oldValue);
    removeIndex(key);
    mapDataStore.remove(key,now);
    onStore(record);
    updateSizeEstimator(-calculateRecordHeapCost(record));
    deleteRecord(key);
    removed=true;
  }
  return removed;
}

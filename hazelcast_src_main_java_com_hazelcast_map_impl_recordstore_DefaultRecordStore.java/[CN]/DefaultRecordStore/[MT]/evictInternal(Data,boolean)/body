{
  Record record=records.get(key);
  Object value=null;
  if (record != null) {
    value=record.getValue();
    final long lastUpdateTime=record.getLastUpdateTime();
    mapDataStore.flush(key,value,lastUpdateTime,backup);
    if (!backup) {
      mapServiceContext.interceptRemove(name,value);
    }
    updateSizeEstimator(-calculateRecordHeapCost(record));
    removeIndex(record);
    deleteRecord(key);
  }
  return value;
}

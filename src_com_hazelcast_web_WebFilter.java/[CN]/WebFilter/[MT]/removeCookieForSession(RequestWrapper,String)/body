{
  final Cookie[] cookies=req.getCookies();
  if (cookies != null) {
    removeCookies:     for (int i=0; i < cookies.length; i++) {
      final Cookie cookie=cookies[i];
      final String name=cookie.getName();
      final String value=cookie.getValue();
      final String path=cookie.getPath();
      if (req.getContextPath().equals(path)) {
        if (name.equals("JSESSIONID") && value.equals(sessionId)) {
          if (DEBUG) {
            log("Found old sessionId cookie DELETING " + value);
          }
          cookie.setMaxAge(0);
          req.res.addCookie(cookie);
          break removeCookies;
        }
      }
    }
  }
}

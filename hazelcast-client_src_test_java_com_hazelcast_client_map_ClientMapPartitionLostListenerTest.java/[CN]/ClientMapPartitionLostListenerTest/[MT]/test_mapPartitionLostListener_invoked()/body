{
  final String mapName=randomMapName();
  final Config config=new Config();
  config.getMapConfig(mapName).setBackupCount(0);
  final HazelcastInstance instance=Hazelcast.newHazelcastInstance(config);
  final HazelcastInstance client=HazelcastClient.newHazelcastClient();
  final EventCollectingMapPartitionLostListener listener=new EventCollectingMapPartitionLostListener(0);
  client.getMap(mapName).addPartitionLostListener(listener);
  final MapService mapService=getNode(instance).getNodeEngine().getService(MapService.SERVICE_NAME);
  final int partitionId=5;
  mapService.onPartitionLost(new InternalPartitionLostEvent(partitionId,0,null));
  assertTrueEventually(new AssertTask(){
    @Override public void run() throws Exception {
      final List<MapPartitionLostEvent> events=listener.getEvents();
      assertFalse(events.isEmpty());
      assertEquals(partitionId,events.get(0).getPartitionId());
    }
  }
);
}

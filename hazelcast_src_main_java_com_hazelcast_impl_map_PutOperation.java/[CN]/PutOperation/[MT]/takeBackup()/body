{
  boolean callerBackup=false;
  NodeService NodeService=getNodeService();
  MapService mapService=(MapService)getService();
  MapPartition mapPartition=mapService.getMapPartition(getPartitionId(),name);
  int mapBackupCount=1;
  int backupCount=Math.min(getClusterSize() - 1,mapBackupCount);
  if (backupCount > 0) {
    List<Future> backupOps=new ArrayList<Future>(backupCount);
    PartitionInfo partitionInfo=mapPartition.partitionInfo;
    for (int i=0; i < backupCount; i++) {
      int replicaIndex=i + 1;
      Address replicaTarget=partitionInfo.getReplicaAddress(replicaIndex);
      if (replicaTarget != null) {
        if (replicaTarget.equals(NodeService.getThisAddress())) {
        }
 else {
          if (replicaTarget.equals(getCaller())) {
            callerBackup=true;
          }
 else {
            PutBackupOperation pbo=new PutBackupOperation(name,dataKey,dataValue,ttl);
            try {
              backupOps.add(NodeService.createSingleInvocation(MapService.MAP_SERVICE_NAME,pbo,partitionInfo.getPartitionId()).setReplicaIndex(replicaIndex).build().invoke());
            }
 catch (            Exception e) {
              e.printStackTrace();
            }
          }
        }
      }
    }
    for (    Future backupOp : backupOps) {
      try {
        backupOp.get(10,TimeUnit.SECONDS);
      }
 catch (      Exception e) {
      }
    }
  }
  return callerBackup;
}

{
  final String mapName="testGetAllWithNearCache";
  Config config=new Config();
  config.getMapConfig(mapName).setNearCacheConfig(new NearCacheConfig());
  final TestHazelcastInstanceFactory hazelcastInstanceFactory=createHazelcastInstanceFactory(2);
  HazelcastInstance instance1=hazelcastInstanceFactory.newHazelcastInstance(config);
  HazelcastInstance instance2=hazelcastInstanceFactory.newHazelcastInstance(config);
  IMap<Integer,Integer> map=instance1.getMap(mapName);
  HashSet keys=new HashSet();
  int size=1000;
  for (int i=0; i < size; i++) {
    map.put(i,i);
    keys.add(i);
  }
  long begin=System.currentTimeMillis();
  map.getAll(keys);
  long firstRead=System.currentTimeMillis() - begin;
  begin=System.currentTimeMillis();
  final Map<Integer,Integer> all=map.getAll(keys);
  long secondRead=System.currentTimeMillis() - begin;
  Assert.assertTrue(secondRead < firstRead);
  for (int i=0; i < size; i++) {
    assertEquals(i,(int)all.get(i));
  }
}

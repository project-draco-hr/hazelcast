{
  final String mapName="testGetAllWithNearCacheIssue1863";
  Config config=new Config();
  final NearCacheConfig nearCacheConfig=new NearCacheConfig();
  nearCacheConfig.setCacheLocalEntries(true);
  config.getMapConfig(mapName).setNearCacheConfig(nearCacheConfig);
  final TestHazelcastInstanceFactory hazelcastInstanceFactory=createHazelcastInstanceFactory(2);
  final HazelcastInstance instance1=hazelcastInstanceFactory.newHazelcastInstance(config);
  final HazelcastInstance instance2=hazelcastInstanceFactory.newHazelcastInstance(config);
  IMap<Integer,Integer> map=instance1.getMap(mapName);
  HashSet keys=new HashSet();
  int size=1000;
  for (int i=0; i < size; i++) {
    map.get(i);
    keys.add(i);
  }
  final Map<Integer,Integer> all=map.getAll(keys);
  NearCacheStats stats=map.getLocalMapStats().getNearCacheStats();
  assertEquals(0,all.size());
  assertEquals(size,stats.getHits());
}

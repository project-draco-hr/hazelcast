{
  final int partitionId=getPartitionId();
  final InternalPartitionService partitionService=getService();
  final long[] versions=partitionService.getPartitionReplicaVersions(partitionId);
  final ILogger logger=getLogger();
  if (reason == PartitionReplicaChangeReason.MEMBER_REMOVED) {
    final int lostReplicaIndex=getLostReplicaIndex(versions);
    if (lostReplicaIndex > 0) {
      if (logger.isFinestEnabled()) {
        logger.finest("Partition replica is lost! partitionId=" + partitionId + " lostReplicaIndex="+ lostReplicaIndex+ " replicaVersions="+ Arrays.toString(versions));
      }
      overwriteLostReplicaVersionsWithFirstAvailableVersion(versions,lostReplicaIndex);
    }
    sendPartitionLostEvent(partitionId,lostReplicaIndex);
  }
 else {
    if (logger.isFinestEnabled()) {
      logger.finest("Resetting all SYNC_WAITING Versions. partitionId=" + partitionId + " versionsBeforeReset="+ Arrays.toString(versions));
    }
    resetSyncWaitingVersions(versions);
  }
}

{
  Config cfg=new Config();
  MapConfig mc=cfg.getMapConfig("testMapRecordIdleEviction");
  int maxIdleSeconds=8;
  int size=100;
  int nsize=size / 10;
  int waitBetween=maxIdleSeconds / 2;
  int waitMore=2;
  mc.setMaxIdleSeconds(maxIdleSeconds);
  HazelcastInstance[] instances=StaticNodeFactory.newInstances(cfg,2);
  IMap map=instances[0].getMap("testMapRecordIdleEviction");
  long cur=System.currentTimeMillis();
  for (int i=0; i < size; i++) {
    map.put(i,i);
  }
  long lasts=System.currentTimeMillis() - cur;
  long wait1=((maxIdleSeconds - waitBetween) * 1000) - lasts;
  Thread.sleep(wait1);
  for (int i=0; i < nsize; i++) {
    map.get(i);
  }
  Thread.sleep(waitBetween * 1000);
  Thread.sleep(waitMore * 1000);
  Assert.assertEquals(nsize,map.size());
  Hazelcast.shutdownAll();
}

{
  Config config=new Config();
  StaticNodeFactory factory=new StaticNodeFactory(2);
  HazelcastInstance h1=factory.newHazelcastInstance(config);
  HazelcastInstance h2=factory.newHazelcastInstance(config);
  IMap map1=h1.getMap("default");
  IMap map2=h2.getMap("default");
  Transaction txn=h1.getTransaction();
  txn.setTransactionTimeout(1);
  txn.begin();
  try {
    map1.put("1","value");
    Thread.sleep(1010);
    map1.put("13","value");
    fail();
  }
 catch (  Throwable e) {
  }
  try {
    txn.commit();
    fail();
  }
 catch (  IllegalStateException e) {
  }
  map2.lock("1");
  txn=h1.getTransaction();
  txn.setTransactionTimeout(1);
  txn.begin();
  try {
    map1.put("1","value");
  }
 catch (  Exception e) {
  }
}

{
  final String TEST_MAP="testMap";
  final String key="k";
  final TestHazelcastInstanceFactory factory=createHazelcastInstanceFactory(1);
  final HazelcastInstance hazelcastInstance=factory.newHazelcastInstance(getConfig());
  IMap<String,Object> map=hazelcastInstance.getMap(TEST_MAP);
  map.put(key,"v");
  hazelcastInstance.executeTransaction(new TransactionalTask<Object>(){
    @Override public Object execute(    TransactionalTaskContext transactionContext) throws TransactionException {
      TransactionalMap<String,Object> map=transactionContext.getMap(TEST_MAP);
      map.putIfAbsent(key,"t");
      return null;
    }
  }
);
  assertFalse("Key remains locked!",map.isLocked(key));
}

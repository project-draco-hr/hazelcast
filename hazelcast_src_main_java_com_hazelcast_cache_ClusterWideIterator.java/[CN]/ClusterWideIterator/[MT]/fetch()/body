{
  final NodeEngine nodeEngine=cacheProxy.getNodeEngine();
  final Operation op=new CacheKeyIteratorOperation(cacheProxy.getName(),segmentIndex,tableIndex,fetchSize);
  final InternalCompletableFuture<Object> f=nodeEngine.getOperationService().invokeOnPartition(CacheService.SERVICE_NAME,op,partitionIndex);
  final CacheKeyIteratorResult iteratorResult=(CacheKeyIteratorResult)f.getSafely();
  if (iteratorResult != null) {
    segmentIndex=iteratorResult.getSegmentIndex();
    tableIndex=iteratorResult.getTableIndex();
    keys=iteratorResult.getKeySet();
    keysIterator=keys.iterator();
    if (keysIterator.hasNext()) {
      lastKey=nextKey;
      nextKey=this.keysIterator.next();
      return;
    }
  }
  segmentIndex=-1;
  tableIndex=-1;
  nextKey=null;
}

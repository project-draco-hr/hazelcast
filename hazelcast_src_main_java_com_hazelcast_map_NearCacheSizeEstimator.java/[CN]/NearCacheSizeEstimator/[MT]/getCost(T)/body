{
  if (record == null) {
    return 0;
  }
  if (record instanceof NearCache.CacheRecord) {
    final NearCache.CacheRecord rec=(NearCache.CacheRecord)record;
    final long cost=rec.getCost();
    if (cost == 0)     return 0;
    long size=0;
    size+=4 * ((Integer.SIZE / Byte.SIZE));
    size+=rec.getCost();
    return size;
  }
  final String msg="NearCacheSizeEstimator::not known object for near cache heap cost" + " calculation [" + record.getClass().getCanonicalName() + "]";
  throw new RuntimeException(msg);
}

{
  final TestHazelcastInstanceFactory nodeFactory=createHazelcastInstanceFactory(1);
  final HazelcastInstance instance=nodeFactory.newHazelcastInstance();
  final AtomicInteger atomicInteger=new AtomicInteger(0);
  final ILock lock=instance.getLock("testSimpleUsage");
  assertEquals("testSimpleUsage",lock.getName());
  final Runnable tryLockRunnable=new Runnable(){
    public void run(){
      if (lock.tryLock())       atomicInteger.incrementAndGet();
    }
  }
;
  final Runnable lockRunnable=new Runnable(){
    public void run(){
      lock.lock();
    }
  }
;
  assertEquals(false,lock.isLocked());
  lock.lock();
  assertEquals(true,lock.isLocked());
  assertEquals(true,lock.tryLock());
  lock.unlock();
  Thread thread1=new Thread(tryLockRunnable);
  thread1.start();
  thread1.join();
  assertEquals(0,atomicInteger.get());
  lock.unlock();
  Thread thread2=new Thread(tryLockRunnable);
  thread2.start();
  thread2.join();
  assertEquals(1,atomicInteger.get());
  assertEquals(true,lock.isLocked());
  lock.forceUnlock();
  Thread thread3=new Thread(lockRunnable);
  thread3.start();
  thread3.join();
  assertEquals(true,lock.isLocked());
  assertEquals(false,lock.tryLock(2,TimeUnit.SECONDS));
  Thread thread4=new Thread(lockRunnable);
  thread4.start();
  assertTrueEventually(new AssertTask(){
    @Override public void run(){
      assertEquals(true,lock.isLocked());
    }
  }
);
  lock.forceUnlock();
  thread4.join();
}

{
  final String keyWithNullValue="keyWithNullValue";
  TestEventBasedMapStore testMapStore=new TestEventBasedMapStore(){
    @Override public Set loadAllKeys(){
      Set keys=new HashSet(super.loadAllKeys());
      keys.add(keyWithNullValue);
      return keys;
    }
  }
;
  Map mapForStore=new HashMap();
  mapForStore.put("key1",17);
  mapForStore.put("key2",37);
  mapForStore.put("key3",47);
  testMapStore.getStore().putAll(mapForStore);
  Config config=newConfig(testMapStore,0);
  HazelcastInstance instance=createHazelcastInstance(config);
  IMap map=instance.getMap("default");
  Set expected=map.keySet();
  Set actual=mapForStore.keySet();
  assertEquals(expected,actual);
  List actualList=new ArrayList(map.values());
  List expectedList=new ArrayList(mapForStore.values());
  Collections.sort(actualList);
  Collections.sort(expectedList);
  assertEquals(expectedList,actualList);
  assertEquals(map.entrySet(),mapForStore.entrySet());
  assertFalse(map.containsKey(keyWithNullValue));
  assertNull(map.get(keyWithNullValue));
}

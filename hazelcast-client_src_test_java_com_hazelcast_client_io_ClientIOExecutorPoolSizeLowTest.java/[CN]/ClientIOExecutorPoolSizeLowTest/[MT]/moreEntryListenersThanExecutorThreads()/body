{
  EntryCounter counter=new EntryCounter();
  final IMap<Object,Object> map=client.getMap("map");
  map.addEntryListener(counter,true);
  for (int i=0; i < 1000; i++) {
    map.putAsync(i,i);
  }
  assertTrueEventually(new AssertTask(){
    public void run(){
      assertEquals(1000,map.size());
    }
  }
);
  assertEquals(1000,counter.count.get());
}

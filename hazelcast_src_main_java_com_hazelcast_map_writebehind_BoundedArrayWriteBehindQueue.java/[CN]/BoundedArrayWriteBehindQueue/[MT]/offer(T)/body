{
  final int perNodeMaxSize=getPerNodeMaxSize();
  if (hasReachedMaxSize(perNodeMaxSize)) {
    throw new ReachedMaxSizeException("Queue already reached per node max capacity [" + maxSize + "]");
  }
  incrementPerNodeMaxSize();
  return super.offer(t);
}

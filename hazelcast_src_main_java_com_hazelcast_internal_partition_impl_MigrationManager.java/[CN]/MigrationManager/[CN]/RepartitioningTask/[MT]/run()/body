{
  if (!node.isMaster()) {
    return;
  }
  partitionServiceLock.lock();
  try {
    if (!isMigrationAllowed()) {
      return;
    }
    Address[][] newState=partitionStateManager.repartition();
    if (newState == null) {
      return;
    }
    if (!isMigrationAllowed()) {
      return;
    }
    lastRepartitionTime.set(Clock.currentTimeMillis());
    processNewPartitionState(newState);
    partitionService.syncPartitionRuntimeState();
  }
  finally {
    partitionServiceLock.unlock();
  }
}

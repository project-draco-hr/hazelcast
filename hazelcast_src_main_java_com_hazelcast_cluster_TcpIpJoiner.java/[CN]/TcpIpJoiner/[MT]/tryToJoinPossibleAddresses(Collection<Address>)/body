{
  long connectionTimeoutMillis=getConnTimeoutSeconds() * 1000L;
  long start=Clock.currentTimeMillis();
  while (!node.joined() && Clock.currentTimeMillis() - start < connectionTimeoutMillis) {
    Address masterAddress=node.getMasterAddress();
    if (possibleAddresses.isEmpty() && masterAddress == null) {
      return;
    }
    if (masterAddress != null) {
      if (logger.isFinestEnabled()) {
        logger.finest("Sending join request to " + masterAddress);
      }
      node.clusterService.sendJoinRequest(masterAddress,true);
    }
 else {
      removeBlacklistedAddresses(possibleAddresses);
      sendMasterQuestion(possibleAddresses);
    }
    if (!node.joined()) {
      Thread.sleep(JOIN_RETRY_WAIT_TIME);
    }
  }
}

{
  FactoryImpl.HazelcastInstanceProxy proxy=(FactoryImpl.HazelcastInstanceProxy)hz;
  Node node=proxy.getFactory().node;
  CMap map=node.concurrentMapManager.getMap(Prefix.MAP + name);
  Address address=node.clusterManager.getThisAddress();
  int[] counts=new int[PartitionInfo.MAX_REPLICA_COUNT];
  PartitionManager partitionManager=node.concurrentMapManager.getPartitionManager();
  Collection<Record> records=map.mapRecords.values();
  for (  Record record : records) {
    int id=record.getBlockId();
    PartitionInfo p=partitionManager.getPartition(id);
    for (int i=0; i < PartitionInfo.MAX_REPLICA_COUNT; i++) {
      if (address.equals(p.getReplicaAddress(i))) {
        counts[i]++;
        break;
      }
    }
  }
  return counts;
}

{
  final NodeEngine nodeEngine=mapServiceContext.getNodeEngine();
  final InternalPartitionService partitionService=nodeEngine.getPartitionService();
  final int partitionCount=partitionService.getPartitionCount();
  List<Integer> partitionIds=null;
  for (int partitionId=0; partitionId < partitionCount; partitionId++) {
    final boolean owner=isOwner(mapServiceContext,partitionId);
    boolean valid=backup ? !owner : owner;
    if (valid) {
      if (partitionIds == null) {
        partitionIds=new ArrayList<Integer>();
      }
      partitionIds.add(partitionId);
    }
  }
  return partitionIds == null ? Collections.<Integer>emptyList() : partitionIds;
}

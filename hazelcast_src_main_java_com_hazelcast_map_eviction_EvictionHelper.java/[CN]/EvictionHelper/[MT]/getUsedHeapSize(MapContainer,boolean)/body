{
  long heapCost=0L;
  final MapServiceContext mapServiceContext=mapContainer.getMapServiceContext();
  final String mapName=mapContainer.getName();
  final List<Integer> partitionIds=findPartitionIds(mapServiceContext,backup);
  for (  int partitionId : partitionIds) {
    final PartitionContainer container=mapServiceContext.getPartitionContainer(partitionId);
    if (container == null) {
      continue;
    }
    heapCost+=getRecordStoreHeapCost(mapName,container);
  }
  heapCost+=mapContainer.getNearCacheSizeEstimator().getSize();
  return heapCost;
}

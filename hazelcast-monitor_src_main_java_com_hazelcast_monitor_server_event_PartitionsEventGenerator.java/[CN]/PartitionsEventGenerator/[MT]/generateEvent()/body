{
  Partitions event=new Partitions(clusterId);
  Set<com.hazelcast.partition.Partition> partitions=client.getPartitionService().getPartitions();
  Map<String,List<Integer>> map=new HashMap<String,List<Integer>>();
  for (  com.hazelcast.partition.Partition partition : partitions) {
    String name=getName(partition.getOwner());
    List blocks=map.get(name);
    if (blocks == null) {
      blocks=new ArrayList<Integer>();
      map.put(name,blocks);
    }
    blocks.add(partition.getPartitionId());
  }
  for (  String owner : map.keySet()) {
    List<Integer> list=map.get(owner);
    Collections.sort(list);
    StringBuilder blocks=new StringBuilder();
    for (    int i : list) {
      blocks.append(i).append(", ");
    }
    String value=blocks.toString();
    event.getPartitions().put(owner,value.substring(0,value.length() - 2));
    event.getCount().put(owner,list.size());
  }
  return event;
}

{
  totalWritten+=BufferUtil.copyToDirectBuffer(bbSizes,dest);
  totalWritten+=BufferUtil.copyToDirectBuffer(bbHeader,dest);
  if (key != null && key.size() > 0) {
    totalWritten+=BufferUtil.copyToDirectBuffer(key.buffer,dest);
  }
  if (value != null && value.size() > 0) {
    totalWritten+=BufferUtil.copyToDirectBuffer(value.buffer,dest);
  }
  return totalWritten >= totalSize;
}

{
  if (!isStatusSet(ST_VERSION)) {
    if (!destination.hasRemaining()) {
      return false;
    }
    destination.put(VERSION);
    setStatus(ST_VERSION);
  }
  if (!isStatusSet(ST_HEADER)) {
    if (destination.remaining() < Bits.SHORT_SIZE_IN_BYTES) {
      return false;
    }
    destination.putShort(header);
    setStatus(ST_HEADER);
  }
  if (!isStatusSet(ST_PARTITION)) {
    if (destination.remaining() < Bits.INT_SIZE_IN_BYTES) {
      return false;
    }
    destination.putInt(partitionId);
    setStatus(ST_PARTITION);
  }
  return super.writeTo(destination);
}

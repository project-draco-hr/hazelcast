{
  if (!isStatusSet(ST_PARTITION)) {
    if (!writeInt(destination,partitionId)) {
      return false;
    }
    setStatus(ST_PARTITION);
  }
  if (!isStatusSet(ST_SIZE)) {
    if (!writeInt(destination,value.size())) {
      return false;
    }
    setStatus(ST_SIZE);
  }
  if (isStatusSet(ST_SIZE) && !isStatusSet(ST_VALUE)) {
    IOUtil.copyToHeapBuffer(value.buffer,destination);
    if (value.buffer.hasRemaining()) {
      return false;
    }
    setStatus(ST_VALUE);
  }
  return true;
}

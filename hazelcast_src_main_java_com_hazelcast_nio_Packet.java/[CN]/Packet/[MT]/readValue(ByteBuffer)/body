{
  if (!isPersistStatusSet(PERSIST_VALUE)) {
    byte[] bytes;
    if (data == null) {
      bytes=new byte[size];
      data=new HeapData(bytes);
    }
 else {
      bytes=data.toByteArray();
    }
    if (size > 0) {
      int bytesReadable=source.remaining();
      int bytesNeeded=size - valueOffset;
      boolean done;
      int bytesRead;
      if (bytesReadable >= bytesNeeded) {
        bytesRead=bytesNeeded;
        done=true;
      }
 else {
        bytesRead=bytesReadable;
        done=false;
      }
      source.get(bytes,valueOffset,bytesRead);
      valueOffset+=bytesRead;
      if (!done) {
        return false;
      }
    }
    setPersistStatus(PERSIST_VALUE);
  }
  return true;
}

{
  Config config=new Config();
  if (withService) {
    ServiceConfig serviceConfig=TestMigrationAwareService.createServiceConfig(backupCount);
    config.getServicesConfig().addServiceConfig(serviceConfig);
  }
  config.setProperty(GroupProperty.PARTITION_COUNT.getName(),String.valueOf(PARTITION_COUNT));
  config.setProperty(GroupProperty.MIGRATION_MIN_DELAY_ON_MEMBER_REMOVED_SECONDS.getName(),String.valueOf(1));
  config.setProperty(GroupProperty.PARTITION_BACKUP_SYNC_INTERVAL.getName(),String.valueOf(BACKUP_SYNC_INTERVAL));
  int parallelReplications=antiEntropyEnabled ? PARALLEL_REPLICATIONS : 0;
  config.setProperty(GroupProperty.PARTITION_MAX_PARALLEL_REPLICATIONS.getName(),String.valueOf(parallelReplications));
  return config;
}

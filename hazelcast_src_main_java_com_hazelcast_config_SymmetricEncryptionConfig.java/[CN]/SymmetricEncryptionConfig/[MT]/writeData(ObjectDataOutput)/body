{
  boolean hasKey=key != null && key.length > 0;
  out.writeByte(ByteUtil.toByte(enabled,hasKey));
  if (enabled) {
    out.writeUTF(salt);
    out.writeUTF(password);
    out.writeInt(iterationCount);
    out.writeUTF(algorithm);
    if (hasKey) {
      out.writeInt(key.length);
      out.write(key);
    }
  }
}

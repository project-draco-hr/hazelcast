{
  CallIdSequence.CallIdSequenceWithoutBackpressure sequence=new CallIdSequence.CallIdSequenceWithoutBackpressure();
  Invocation invocation=newInvocation(operation);
  invocation.remote=remote;
  long oldSequence=sequence.getLastCallId();
  long result=sequence.next(invocation);
  if (skipped) {
    assertEquals(Operation.CALL_ID_LOCAL_SKIPPED,result);
    assertEquals(oldSequence,sequence.getLastCallId());
  }
 else {
    assertEquals(oldSequence + 1,result);
    assertEquals(oldSequence + 1,sequence.getLastCallId());
  }
}

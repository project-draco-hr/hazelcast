{
  ScriptEngine engine=null;
  for (  ScriptEngineManager manager : classLoaders.keySet()) {
    Thread currentThread=Thread.currentThread();
    ClassLoader old=currentThread.getContextClassLoader();
    currentThread.setContextClassLoader(classLoaders.get(manager));
    engine=manager.getEngineByExtension(extension);
    currentThread.setContextClassLoader(old);
    if (engine != null) {
      break;
    }
  }
  return engine;
}

{
  ScriptEngine engine=null;
  for (  ScriptEngineManager manager : classLoaders.keySet()) {
    ClassLoader old=Thread.currentThread().getContextClassLoader();
    Thread.currentThread().setContextClassLoader(classLoaders.get(manager));
    engine=manager.getEngineByExtension(extension);
    Thread.currentThread().setContextClassLoader(old);
    if (engine != null)     break;
  }
  return engine;
}

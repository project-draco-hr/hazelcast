{
  Bundle[] bundles=context.getBundles();
  List<String> factoryCandidates=new ArrayList<String>();
  for (  Bundle bundle : bundles) {
    if (bundle.getSymbolicName().equals("system.bundle"))     continue;
    Enumeration urls=bundle.findEntries("META-INF/services","javax.script.ScriptEngineFactory",false);
    if (urls == null)     continue;
    while (urls.hasMoreElements()) {
      URL u=(URL)urls.nextElement();
      BufferedReader reader=new BufferedReader(new InputStreamReader(u.openStream()));
      String line;
      while ((line=reader.readLine()) != null) {
        factoryCandidates.add(line.trim());
      }
    }
  }
  factoryCandidates.add("com.sun.script.javascript.RhinoScriptEngineFactory");
  return factoryCandidates;
}

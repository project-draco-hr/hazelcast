{
  Map<ScriptEngineManager,ClassLoader> managers=new HashMap<ScriptEngineManager,ClassLoader>();
  try {
    for (    String factoryName : findFactoryCandidates(context)) {
      ClassLoader factoryLoader;
      try {
        factoryLoader=Class.forName(factoryName).getClassLoader();
      }
 catch (      ClassNotFoundException cnfe) {
        logger.warning("Found ScriptEngineFactory candidate for " + factoryName + ", but cannot load class! -> "+ cnfe);
        if (logger.isFinestEnabled()) {
          logger.finest(cnfe);
        }
        continue;
      }
      try {
        ScriptEngineManager manager=new ScriptEngineManager(factoryLoader);
        manager.setBindings(bindings);
        managers.put(manager,factoryLoader);
      }
 catch (      Exception e) {
        logger.warning("Found ScriptEngineFactory candidate for " + factoryName + ", but could not load ScripEngineManager! -> "+ e);
        if (logger.isFinestEnabled()) {
          logger.finest(e);
        }
        continue;
      }
    }
    return managers;
  }
 catch (  IOException ioe) {
    throw new RuntimeException(ioe);
  }
}

{
  Map<Integer,List<KeyIn>> mappedKeys=new HashMap<Integer,List<KeyIn>>();
  for (  KeyIn key : keys) {
    int partitionId=ps.getPartitionId(key);
    List<KeyIn> selectedKeys=mappedKeys.get(partitionId);
    if (selectedKeys == null) {
      selectedKeys=new ArrayList<KeyIn>();
      mappedKeys.put(partitionId,selectedKeys);
    }
    selectedKeys.add(key);
  }
  return mappedKeys;
}

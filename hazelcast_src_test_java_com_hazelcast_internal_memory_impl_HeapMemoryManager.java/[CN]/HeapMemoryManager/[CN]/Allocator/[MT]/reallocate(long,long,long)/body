{
  assertFitsInt(address);
  assertFitsInt(currentSize);
  assertFitsInt(newSize);
  validateBlock(address,currentSize);
  final long sizeDelta=newSize - currentSize;
  final long newAddress;
  if (address == lastAllocatedAddress) {
    heapTop+=sizeDelta;
    newAddress=address;
  }
 else {
    newAddress=allocate(newSize);
    System.arraycopy(storage,(int)address,storage,(int)newAddress,(int)Math.min(currentSize,newSize));
    allocatedAddrs.remove(address);
  }
  usedMemory+=sizeDelta;
  return newAddress;
}

{
  NodeEngineImpl nodeEngine=(NodeEngineImpl)getNodeEngine();
  final MigrationServiceEvent event=new MigrationServiceEvent(MigrationEndpoint.SOURCE,migrationInfo);
  final Collection<Operation> tasks=new LinkedList<Operation>();
  for (  Object serviceObject : nodeEngine.getServices(MigrationAwareService.class)) {
    if (serviceObject instanceof MigrationAwareService) {
      MigrationAwareService service=(MigrationAwareService)serviceObject;
      final Operation op=service.prepareMigrationOperation(event);
      if (op != null) {
        service.beforeMigration(event);
        tasks.add(op);
      }
    }
  }
  return tasks;
}

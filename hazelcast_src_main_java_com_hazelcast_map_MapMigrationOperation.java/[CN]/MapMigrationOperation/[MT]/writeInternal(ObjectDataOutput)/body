{
  out.writeInt(data.size());
  for (  Entry<String,Map<Data,Record>> mapEntry : data.entrySet()) {
    out.writeUTF(mapEntry.getKey());
    Map<Data,Record> map=mapEntry.getValue();
    out.writeInt(map.size());
    for (    Entry<Data,Record> entry : map.entrySet()) {
      entry.getKey().writeData(out);
      out.writeObject(entry.getValue());
    }
  }
  out.writeInt(locks.size());
  for (  Entry<String,Map<Data,LockInfo>> mapEntry : locks.entrySet()) {
    out.writeUTF(mapEntry.getKey());
    Map<Data,LockInfo> map=mapEntry.getValue();
    out.writeInt(map.size());
    for (    Entry<Data,LockInfo> entry : map.entrySet()) {
      entry.getKey().writeData(out);
      IOUtil.writeNullableObject(out,entry.getValue());
    }
  }
}

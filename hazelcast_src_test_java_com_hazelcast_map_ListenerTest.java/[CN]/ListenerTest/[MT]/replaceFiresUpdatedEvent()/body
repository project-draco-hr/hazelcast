{
  TestHazelcastInstanceFactory nodeFactory=createHazelcastInstanceFactory(1);
  HazelcastInstance h1=nodeFactory.newHazelcastInstance();
  IMap<Object,Object> map=h1.getMap(randomMapName());
  map.put(1,1);
  final AtomicInteger updateCount=new AtomicInteger(0);
  final AtomicInteger addCount=new AtomicInteger(0);
  map.addEntryListener(new EntryAdapter<Object,Object>(){
    @Override public void entryAdded(    EntryEvent<Object,Object> event){
      addCount.incrementAndGet();
    }
    @Override public void entryUpdated(    EntryEvent<Object,Object> event){
      updateCount.incrementAndGet();
    }
  }
,true);
  map.replace(1,1,2);
  map.replace(1,1,2);
  assertTrueEventually(new AssertTask(){
    @Override public void run(){
      assertEquals(0,addCount.get());
      assertEquals(1,updateCount.get());
    }
  }
);
}

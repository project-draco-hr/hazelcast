{
  ReplicatedMapService replicatedMapService=getService();
  AbstractReplicatedRecordStore recordStorage=(AbstractReplicatedRecordStore)replicatedMapService.getReplicatedRecordStore(name,true);
  if (notYetReadyChooseSomeoneElse) {
    recordStorage.retryWithDifferentReplicationNode(origin);
  }
 else {
    for (int i=0; i < recordCount; i++) {
      ReplicatedRecord record=replicatedRecords[i];
      ReplicationMessage update=new ReplicationMessage(name,record.getKey(),record.getValue(),record.getVectorClock(),origin,record.getLatestUpdateHash(),record.getTtlMillis());
      recordStorage.queueUpdateMessage(update);
    }
    if (finalChunk) {
      recordStorage.finalChunkReceived();
    }
  }
}

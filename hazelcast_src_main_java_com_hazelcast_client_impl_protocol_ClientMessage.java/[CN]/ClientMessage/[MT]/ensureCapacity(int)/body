{
  int capacity=buffer.capacity() > 0 ? buffer.capacity() : 1;
  if (requiredCapacity > capacity) {
    int newCapacity=findSuitableMessageSize(requiredCapacity);
    byte[] newBuffer=Arrays.copyOf(buffer.byteArray(),newCapacity);
    buffer.wrap(newBuffer);
  }
}

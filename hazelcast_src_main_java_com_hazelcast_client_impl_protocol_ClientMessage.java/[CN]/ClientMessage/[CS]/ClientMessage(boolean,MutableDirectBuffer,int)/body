{
  super(buffer,offset);
  ensureHeaderSize(offset,buffer.capacity());
  if (encode) {
    setDataOffset(HEADER_SIZE);
    setFrameLength(HEADER_SIZE);
    setPartitionId(-1);
  }
  index(getDataOffset() + offset);
}

{
  out.writeByte(packetVersion);
  out.writeInt(buildNumber);
  boolean hasTo=(to != null);
  out.writeBoolean(hasTo);
  if (hasTo) {
    to.writeData(out);
  }
  address.writeData(out);
  out.writeInt(nodeType.getValue());
  config.writeData(out);
  out.writeUTF(uuid);
  IOUtil.writeObject(out,credentials);
}

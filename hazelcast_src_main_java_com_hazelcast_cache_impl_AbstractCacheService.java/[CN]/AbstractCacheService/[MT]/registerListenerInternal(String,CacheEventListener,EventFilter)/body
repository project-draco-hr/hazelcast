{
  final EventService eventService=getNodeEngine().getEventService();
  final EventRegistration registration;
  if (eventFilter == null) {
    registration=eventService.registerListener(AbstractCacheService.SERVICE_NAME,name,listener);
  }
 else {
    registration=eventService.registerListener(AbstractCacheService.SERVICE_NAME,name,eventFilter,listener);
  }
  final String id=registration.getId();
  if (listener instanceof Closeable) {
    closeableListeners.put(id,(Closeable)listener);
  }
 else   if (listener instanceof CacheEntryListenerProvider) {
    CacheEntryListener cacheEntryListener=((CacheEntryListenerProvider)listener).getCacheEntryListener();
    if (cacheEntryListener instanceof Closeable) {
      closeableListeners.put(id,(Closeable)cacheEntryListener);
    }
  }
  return id;
}

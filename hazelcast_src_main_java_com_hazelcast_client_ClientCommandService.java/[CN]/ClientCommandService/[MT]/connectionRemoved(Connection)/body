{
  if (connection.isClient() && connection instanceof TcpIpConnection) {
    final ClientEndpoint clientEndpoint=mapClientEndpoints.remove(connection);
    if (clientEndpoint != null) {
      final Collection<MemberImpl> memberList=node.nodeEngine.getClusterService().getMemberList();
      for (      MemberImpl member : memberList) {
        if (member.localMember()) {
          final ClientDisconnectionOperation op=new ClientDisconnectionOperation(clientEndpoint.uuid);
          op.setNodeEngine(node.nodeEngine).setResponseHandler(ResponseHandlerFactory.createEmptyResponseHandler());
          node.nodeEngine.getOperationService().executeOperation(op);
        }
 else {
          final Invocation inv=node.nodeEngine.getOperationService().createInvocationBuilder(ClusterServiceImpl.SERVICE_NAME,new ClientDisconnectionOperation(clientEndpoint.uuid),member.getAddress()).build();
          inv.invoke();
        }
      }
    }
  }
}

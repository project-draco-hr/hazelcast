{
  if (reconnection.get()) {
    Thread.sleep(50L);
    return;
  }
  try {
    boolean written=false;
    if (queue.size() > 0 || q.size() > 0) {
      queue.drainTo(q);
      Call call=q.poll();
      while (call != null) {
        writeCall(call);
        written=true;
        call=q.poll();
      }
    }
    try {
      if (written) {
        writer.flush(connection);
      }
    }
 catch (    IOException e) {
      clusterIsDown(connection);
    }
    Call call=queue.poll(12,TimeUnit.MILLISECONDS);
    if (call != null) {
      writeCall(call);
      try {
        writer.flush(connection);
      }
 catch (      IOException e) {
        clusterIsDown(connection);
      }
    }
  }
 catch (  Throwable e) {
    logger.log(Level.FINE,"OutRunnable [" + connection + "] got an exception:"+ e.toString(),e);
  }
}

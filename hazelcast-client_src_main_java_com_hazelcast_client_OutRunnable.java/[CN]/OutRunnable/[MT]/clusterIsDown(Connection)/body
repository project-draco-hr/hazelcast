{
  if (!running) {
    interruptWaitingCalls();
    return;
  }
  client.getConnectionManager().destroyConnection(oldConnection);
  if (reconnection.compareAndSet(false,true)) {
    client.runAsyncAndWait(new Runnable(){
      public void run(){
        try {
          final Connection lookForAliveConnection=client.getConnectionManager().lookForLiveConnection();
          if (lookForAliveConnection == null) {
            logger.log(Level.WARNING,"Could not restore the connection");
            if (reconnection.get()) {
              logger.log(Level.WARNING,"Reconnection: " + reconnection.get() + ". Interrupting and shutting down the client!");
              interruptWaitingCalls();
              client.getLifecycleService().shutdown();
            }
          }
 else {
            if (running) {
              enQueue(RECONNECT_CALL);
            }
          }
        }
 catch (        IOException e) {
          logger.log(Level.WARNING,Thread.currentThread().getName() + " got exception:" + e.getMessage(),e);
        }
 finally {
          reconnection.compareAndSet(true,false);
        }
      }
    }
);
  }
}

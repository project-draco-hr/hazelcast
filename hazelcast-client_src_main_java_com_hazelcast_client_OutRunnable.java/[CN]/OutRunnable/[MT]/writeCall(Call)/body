{
  try {
    Connection oldConnection=connection;
    connection=client.getConnectionManager().getConnection();
    if (restoredConnection(oldConnection,connection)) {
      queue.offer(call);
      resubscribe(oldConnection);
      if (reconnectionCalls.size() == 0) {
        client.getConnectionManager().notifyConnectionIsOpened();
      }
    }
 else     if (connection != null) {
      if (call != RECONNECT_CALL) {
        if (!call.isFireNforget()) {
          callMap.put(call.getId(),call);
        }
        writer.write(connection,call.getRequest());
        call.written=System.nanoTime();
      }
    }
 else {
      queue.offer(call);
      clusterIsDown(oldConnection);
      return;
    }
    if (reconnectionCalls.size() > 0) {
      checkOnReconnect(call);
    }
  }
 catch (  Exception e) {
    queue.offer(call);
    clusterIsDown(connection);
  }
}

{
  try {
    queryQ.put(new Runnable(){
      public void run(){
        long[] oldValues=record.getIndexes();
        int indexCount=indexes.length;
        if (indexCount != newValues.length) {
          throw new RuntimeException(indexCount + " is expected but newValues " + newValues.length);
        }
        for (int i=0; i < indexCount; i++) {
          Index index=indexes[i];
          long oldValue=(oldValues == null) ? Long.MIN_VALUE : oldValues[i];
          if (oldValue == Long.MIN_VALUE) {
            index.addNewIndex(newValues[i],record);
            ownedRecords.add(record);
          }
 else {
            index.updateIndex(oldValue,newValues[i],record);
          }
        }
        record.setIndexes(newValues);
      }
    }
);
  }
 catch (  InterruptedException ignore) {
  }
}

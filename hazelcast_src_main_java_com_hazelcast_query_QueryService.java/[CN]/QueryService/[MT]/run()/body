{
  while (running) {
    Runnable runnable;
    try {
      runnable=queryQ.poll(1,TimeUnit.SECONDS);
      long now=System.currentTimeMillis();
      if (now - lastStatePublishTime > 1000) {
        publishState();
        lastStatePublishTime=now;
      }
      if (runnable != null)       runnable.run();
    }
 catch (    Throwable e) {
      e.printStackTrace();
    }
  }
}

{
  if (record.isActive()) {
    updateValueIndex(valueHash,record);
    boolean added=ownedRecords.add(record);
    if (added && ownedRecords.size() % 1000 == 900) {
      System.out.println("size is " + ownedRecords.size());
    }
  }
 else {
    removeValueIndex(record);
    ownedRecords.remove(record);
  }
  if (indexes != null) {
    long[] oldValues=record.getIndexes();
    int indexCount=indexes.length;
    if (indexCount != newValues.length) {
      throw new RuntimeException(indexCount + " is expected but newValues " + newValues.length);
    }
    for (int i=0; i < indexCount; i++) {
      Index index=indexes[i];
      long oldValue=(oldValues == null) ? Long.MIN_VALUE : oldValues[i];
      if (oldValue == Long.MIN_VALUE) {
        index.addNewIndex(newValues[i],record);
      }
 else {
        index.updateIndex(oldValue,newValues[i],record);
      }
    }
    record.setIndexes(newValues);
  }
}

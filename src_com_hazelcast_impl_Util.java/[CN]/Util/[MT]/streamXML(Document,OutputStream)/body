{
  try {
    TransformerFactory tFactory=TransformerFactory.newInstance();
    Transformer transformer=tFactory.newTransformer();
    if (doc.getDoctype() != null) {
      String systemId=doc.getDoctype().getSystemId();
      String publicId=doc.getDoctype().getPublicId();
      transformer.setOutputProperty(OutputKeys.DOCTYPE_PUBLIC,publicId);
      transformer.setOutputProperty(OutputKeys.DOCTYPE_SYSTEM,systemId);
    }
    transformer.setOutputProperty(OutputKeys.INDENT,"yes");
    DOMSource source=new DOMSource(doc);
    StreamResult result=new StreamResult(out);
    transformer.transform(source,result);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}

{
  this.authenticator=authenticator;
  this.client=client;
  ClientConfig config=client.getClientConfig();
  router=new Router(loadBalancer);
  SocketInterceptorConfig sic=config.getSocketInterceptorConfig();
  if (sic != null && sic.isEnabled()) {
    Object implementation=sic.getImplementation();
    if (implementation == null && sic.getClassName() != null) {
      try {
        implementation=Class.forName(sic.getClassName()).newInstance();
      }
 catch (      Throwable e) {
        logger.severe("SocketInterceptor class cannot be instantiated!" + sic.getClassName(),e);
      }
    }
    if (implementation != null) {
      if (!(implementation instanceof SocketInterceptor)) {
        logger.severe("SocketInterceptor must be instance of " + SocketInterceptor.class.getName());
        implementation=null;
      }
 else {
        logger.info("SocketInterceptor is enabled");
      }
    }
    if (implementation != null) {
      socketInterceptor=(SocketInterceptor)implementation;
      socketInterceptor.init(sic.getProperties());
    }
 else {
      socketInterceptor=null;
    }
  }
 else {
    socketInterceptor=null;
  }
  poolSize=config.getConnectionPoolSize();
  int connectionTimeout=config.getConnectionTimeout();
  heartbeat=new HeartBeatChecker(connectionTimeout,client.getSerializationService(),client.getClientExecutionService());
  socketOptions=config.getSocketOptions();
}

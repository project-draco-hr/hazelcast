{
  checkLive();
  if (address == null) {
    throw new IllegalArgumentException("Target address is required!");
  }
  final ObjectPool<ConnectionWrapper> pool=getConnectionPool(address);
  if (pool == null) {
    return null;
  }
  Connection connection=null;
  try {
    connection=pool.take();
  }
 catch (  Exception e) {
    if (logger.isFinestEnabled()) {
      logger.warning("Error during connection creation... To -> " + address,e);
    }
 else {
      logger.warning("Error during connection creation... To -> " + address + ", Error: "+ e.toString());
    }
  }
  if (connection != null && !heartbeat.checkHeartBeat(connection)) {
    logger.warning(connection + " failed to heartbeat, closing...");
    connection.close();
    connection=null;
  }
  return connection;
}

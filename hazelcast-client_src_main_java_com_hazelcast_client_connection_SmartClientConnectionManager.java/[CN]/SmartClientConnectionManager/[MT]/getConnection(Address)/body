{
  checkLive();
  if (address == null) {
    throw new IllegalArgumentException("Target address is required!");
  }
  final ObjectPool<ConnectionWrapper> pool=getConnectionPool(address);
  if (pool == null) {
    return null;
  }
  Connection connection=null;
  try {
    connection=pool.take();
  }
 catch (  Exception e) {
    logger.log(Level.WARNING,"Error during connection creation... To -> " + address,e);
  }
  if (connection != null && !heartbeat.checkHeartBeat(connection)) {
    logger.log(Level.WARNING,connection + " failed to heartbeat, closing...");
    connection.close();
    connection=null;
  }
  return connection;
}

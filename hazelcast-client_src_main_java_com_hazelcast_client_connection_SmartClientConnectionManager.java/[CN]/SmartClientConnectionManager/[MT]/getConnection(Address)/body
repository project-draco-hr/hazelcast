{
  checkLive();
  if (address == null) {
    throw new IllegalArgumentException("Target address is required!");
  }
  final ObjectPool<ConnectionWrapper> pool=getConnectionPool(address);
  Connection connection=null;
  try {
    connection=pool == null ? getRandomConnection() : pool.take();
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  if (connection == null) {
    checkLive();
    try {
      Thread.sleep(100);
    }
 catch (    InterruptedException ignored) {
    }
    return getRandomConnection();
  }
  if (!heartbeat.checkHeartBeat(connection)) {
    connection.close();
    return getRandomConnection();
  }
  return connection;
}

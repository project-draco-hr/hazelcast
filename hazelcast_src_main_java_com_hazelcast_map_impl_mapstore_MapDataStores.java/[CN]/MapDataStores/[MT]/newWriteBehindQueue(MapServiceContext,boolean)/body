{
  GroupProperties groupProperties=mapServiceContext.getNodeEngine().getGroupProperties();
  final int capacity=groupProperties.getInteger(GroupProperty.MAP_WRITE_BEHIND_QUEUE_CAPACITY);
  final AtomicInteger counter=mapServiceContext.getWriteBehindQueueItemCounter();
  return (writeCoalescing ? createDefaultWriteBehindQueue() : createBoundedWriteBehindQueue(capacity,counter));
}

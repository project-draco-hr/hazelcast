{
  Index index=mapIndexes.get(expression);
  if (index == null) {
    if (size() > 0) {
      StringBuilder sb=new StringBuilder("Index can only be added before adding entries!");
      sb.append(" Add indexes first and only once then put entries.");
      throw new QueryException(sb.toString());
    }
    if (attributeIndex == -1) {
      attributeIndex=mapIndexes.size();
    }
    index=new Index(expression,ordered,attributeIndex);
    mapIndexes.put(expression,index);
    indexTypes=null;
    hasIndexedAttributes=true;
  }
  return index;
}

{
  int size=partitionInfos.size();
  PartitionInfo[] partitions=new PartitionInfo[size];
  for (int i=0; i < size; i++) {
    ShortPartitionInfo spi=partitionInfos.get(i);
    PartitionInfo partition=new PartitionInfo(spi.partitionId);
    int[] addressIndexes=spi.addressIndexes;
    for (int c=0; c < addressIndexes.length; c++) {
      int index=addressIndexes[c];
      if (index != -1) {
        partition.setReplicaAddress(c,members.get(index).getAddress());
      }
    }
    partitions[spi.partitionId]=partition;
  }
  return partitions;
}

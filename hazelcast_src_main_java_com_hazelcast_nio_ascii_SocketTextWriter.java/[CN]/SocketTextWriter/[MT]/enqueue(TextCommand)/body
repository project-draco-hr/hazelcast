{
  long requestId=response.getRequestId();
  if (requestId == -1) {
    connection.getWriteHandler().enqueueSocketWritable(response);
  }
 else {
    if (currentRequestId == requestId) {
      connection.getWriteHandler().enqueueSocketWritable(response);
      currentRequestId++;
      processWaitingResponses();
    }
 else {
      responses.put(requestId,response);
    }
  }
}

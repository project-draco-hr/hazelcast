{
  List<HazelcastInstance> instances=new ArrayList<HazelcastInstance>(factory.getAllHazelcastInstances());
  Collections.shuffle(instances);
  if (count == 1) {
    TestUtil.terminateInstance(instances.get(0));
  }
 else {
    int min=Math.min(count,instances.size());
    final CountDownLatch latch=new CountDownLatch(min);
    for (int i=0; i < min; i++) {
      final HazelcastInstance hz=instances.get(i);
      new Thread(){
        public void run(){
          TestUtil.terminateInstance(hz);
          latch.countDown();
        }
      }
.start();
    }
    assertTrue(latch.await(2,TimeUnit.MINUTES));
  }
}

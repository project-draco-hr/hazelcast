{
  if (!endpoint.isAlive() || endpoint.getUuid().equals(event.getSourceUuid())) {
    return;
  }
  if (event instanceof BatchNearCacheInvalidation) {
    List<Data> keys=((BatchNearCacheInvalidation)event).getDataList();
    sendClientMessage(parameters.name,encodeIMapBatchInvalidationEvent(keys));
    return;
  }
  if (event instanceof SingleNearCacheInvalidation) {
    Data key=((SingleNearCacheInvalidation)event).getKey();
    sendClientMessage(key,encodeIMapInvalidationEvent(key));
    return;
  }
  if (event instanceof CleaningNearCacheInvalidation) {
    sendClientMessage(parameters.name,encodeIMapInvalidationEvent(null));
    return;
  }
  throw new IllegalArgumentException("Unexpected event received [" + event + ']');
}

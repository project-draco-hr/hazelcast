{
  InternalPartitionService partitionService=mapReduceService.getNodeEngine().getPartitionService();
  InternalPartition[] partitions=partitionService.getPartitions();
  long startTime=Clock.currentTimeMillis();
  for (  InternalPartition partition : partitions) {
    while (partitionService.getPartition(partition.getPartitionId()).getOwner() == null) {
      try {
        Thread.sleep(RETRY_PARTITION_TABLE_MILLIS);
      }
 catch (      Exception ignore) {
        Logger.getLogger(MapReduceUtil.class).finest(ignore);
      }
      if (Clock.currentTimeMillis() - startTime > PARTITION_READY_TIMEOUT) {
        throw new TimeoutException("Partition get ready timeout reached!");
      }
    }
  }
}

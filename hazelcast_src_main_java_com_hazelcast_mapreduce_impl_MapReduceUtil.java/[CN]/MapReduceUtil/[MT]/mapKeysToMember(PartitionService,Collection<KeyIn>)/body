{
  if (keys == null) {
    return Collections.emptyMap();
  }
  Map<Address,List<KeyIn>> mappedKeys=new HashMap<Address,List<KeyIn>>();
  for (  KeyIn key : keys) {
    int partitionId=ps.getPartitionId(key);
    Address address=ps.getPartitionOwner(partitionId);
    List<KeyIn> selectedKeys=mappedKeys.get(address);
    if (selectedKeys == null) {
      selectedKeys=new ArrayList<KeyIn>();
      mappedKeys.put(address,selectedKeys);
    }
    selectedKeys.add(key);
  }
  return mappedKeys;
}

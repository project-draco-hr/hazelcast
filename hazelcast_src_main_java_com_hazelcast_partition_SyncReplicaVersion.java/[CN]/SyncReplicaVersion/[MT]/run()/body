{
  PartitionServiceImpl partitionService=getService();
  int partitionId=getPartitionId();
  int replicaIndex=syncReplicaIndex;
  InternalPartition partition=partitionService.getPartition(partitionId);
  Address target=partition.getReplicaAddress(replicaIndex);
  if (target == null) {
    return;
  }
  long[] currentVersions=partitionService.getPartitionReplicaVersions(partitionId);
  NodeEngine nodeEngine=getNodeEngine();
  CheckReplicaVersion op=new CheckReplicaVersion(currentVersions[replicaIndex],sync);
  op.setPartitionId(partitionId).setReplicaIndex(replicaIndex).setServiceName(PartitionServiceImpl.SERVICE_NAME);
  OperationService operationService=nodeEngine.getOperationService();
  if (sync) {
    operationService.createInvocationBuilder(PartitionServiceImpl.SERVICE_NAME,op,target).setCallback(callback).setTryCount(10).setTryPauseMillis(250).invoke();
  }
 else {
    operationService.send(op,target);
  }
}

{
  final PartitionServiceImpl partitionService=getService();
  final int partitionId=getPartitionId();
  final int replicaIndex=syncReplicaIndex;
  final PartitionImpl partition=partitionService.getPartition(partitionId);
  final Address target=partition.getReplicaAddress(replicaIndex);
  if (target != null) {
    final long[] currentVersions=partitionService.getPartitionReplicaVersions(partitionId);
    final NodeEngine nodeEngine=getNodeEngine();
    CheckReplicaVersion op=new CheckReplicaVersion(currentVersions[replicaIndex],sync);
    op.setPartitionId(partitionId).setReplicaIndex(replicaIndex).setServiceName(PartitionServiceImpl.SERVICE_NAME);
    OperationService operationService=nodeEngine.getOperationService();
    if (sync) {
      operationService.createInvocationBuilder(PartitionServiceImpl.SERVICE_NAME,op,target).setCallback(callback).setTryCount(10).setTryPauseMillis(250).build().invoke();
    }
 else {
      operationService.send(op,target);
    }
  }
}

{
  HazelcastInstance hazelcastInstance=createHazelcastInstanceFactory(1).newHazelcastInstance(new Config());
  IAtomicReference<String> ref=hazelcastInstance.getAtomicReference("alterAndGet_whenException");
  ref.set("foo");
  try {
    ref.alterAndGet(new FailingFunction());
    fail();
  }
 catch (  WoohaaException expected) {
  }
  assertEquals("foo",ref.get());
}

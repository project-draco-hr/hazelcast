{
  select:   while (live) {
    if (size.get() > 0) {
      processSelectionQueue();
    }
    int selectedKeys=0;
    try {
      selectedKeys=selector.select(waitTime);
      if (Thread.interrupted()) {
        Node.get().handleInterruptedException(Thread.currentThread(),new RuntimeException());
      }
    }
 catch (    final IOException ioe) {
      ioe.printStackTrace();
      continue select;
    }
    if (selectedKeys == 0) {
      continue select;
    }
    final Set<SelectionKey> setSelectedKeys=selector.selectedKeys();
    final Iterator<SelectionKey> it=setSelectedKeys.iterator();
    while (it.hasNext()) {
      final SelectionKey sk=it.next();
      it.remove();
      try {
        sk.interestOps(sk.interestOps() & ~sk.readyOps());
        final SelectionHandler selectionHandler=(SelectionHandler)sk.attachment();
        selectionHandler.handle();
      }
 catch (      final Exception e) {
        handleSelectorException(e);
      }
    }
  }
}

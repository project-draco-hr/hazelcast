{
  if (event.getPartitionId() < 0 || event.getPartitionId() >= nodeEngine.getPartitionCount()) {
    return null;
  }
  Map<String,QueueContainer> migrationData=new HashMap<String,QueueContainer>();
  for (  Entry<String,QueueContainer> entry : containerMap.entrySet()) {
    String name=entry.getKey();
    QueueContainer container=entry.getValue();
    if (container.getPartitionId() == event.getPartitionId() && container.getConfig().getTotalBackupCount() >= event.getReplicaIndex()) {
      migrationData.put(name,container);
    }
  }
  return new QueueMigrationOperation(migrationData,event.getPartitionId(),event.getReplicaIndex());
}

{
  Map<String,QueueContainer> migrationData=new HashMap<String,QueueContainer>();
  for (  Entry<String,QueueContainer> entry : containerMap.entrySet()) {
    String name=entry.getKey();
    int partitionId=nodeEngine.getPartitionService().getPartitionId(StringPartitioningStrategy.getPartitionKey(name));
    QueueContainer container=entry.getValue();
    if (partitionId == event.getPartitionId() && container.getConfig().getTotalBackupCount() >= event.getReplicaIndex()) {
      migrationData.put(name,container);
    }
  }
  return migrationData.isEmpty() ? null : new QueueReplicationOperation(migrationData,event.getPartitionId(),event.getReplicaIndex());
}

{
  checkNotNull(packet,"packet can't be null");
  if (!packet.isHeaderSet(Packet.HEADER_OP)) {
    throw new IllegalStateException("Packet " + packet + " doesn't have Packet.HEADER_OP set");
  }
  if (packet.isHeaderSet(Packet.HEADER_RESPONSE)) {
    responseThread.workQueue.add(packet);
  }
 else {
    int partitionId=packet.getPartitionId();
    boolean hasPriority=packet.isUrgent();
    execute(packet,partitionId,hasPriority);
  }
}

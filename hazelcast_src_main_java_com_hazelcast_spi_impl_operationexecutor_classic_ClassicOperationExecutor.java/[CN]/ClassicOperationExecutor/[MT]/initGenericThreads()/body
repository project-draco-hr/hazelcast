{
  int threadCount=genericOperationRunners.length;
  GenericOperationThread[] threads=new GenericOperationThread[threadCount];
  for (int threadId=0; threadId < threads.length; threadId++) {
    String threadName=threadGroup.getThreadPoolNamePrefix("generic-operation") + threadId;
    OperationRunner operationRunner=genericOperationRunners[threadId];
    GenericOperationThread operationThread=new GenericOperationThread(threadName,threadId,genericScheduleQueue,logger,threadGroup,nodeExtension,operationRunner);
    threads[threadId]=operationThread;
    operationRunner.setCurrentThread(operationThread);
    metricsRegistry.scanAndRegister(operationThread,"operation." + operationThread.getName());
  }
  return threads;
}

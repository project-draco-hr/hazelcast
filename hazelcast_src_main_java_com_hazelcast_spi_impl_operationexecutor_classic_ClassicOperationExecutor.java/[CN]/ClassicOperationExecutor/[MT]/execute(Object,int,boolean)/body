{
  OperationQueue operationQueue;
  if (partitionId < 0) {
    operationQueue=genericOperationQueue;
  }
 else {
    OperationThread partitionOperationThread=partitionOperationThreads[toPartitionThreadIndex(partitionId)];
    operationQueue=partitionOperationThread.queue;
  }
  if (priority) {
    operationQueue.addUrgent(task);
  }
 else {
    operationQueue.add(task);
  }
}

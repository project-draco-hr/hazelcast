{
  if (operation == null) {
    throw new NullPointerException("operation can't be null");
  }
  if (!isAllowedToRunInCurrentThread(operation)) {
    throw new IllegalThreadStateException("Operation '" + operation + "' cannot be run in current thread: "+ Thread.currentThread());
  }
  OperationRunner operationRunner=getCurrentThreadOperationRunner();
  operationRunner.run(operation);
}

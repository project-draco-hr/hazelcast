{
  checkNotNull(operation,"operation can't be null");
  if (operation.getPartitionId() >= 0) {
    return partitionOperationRunners[operation.getPartitionId()];
  }
  Thread thread=Thread.currentThread();
  if (!(thread instanceof OperationThread)) {
    return adHocOperationRunner;
  }
  OperationThread operationThread=(OperationThread)thread;
  return operationThread.getCurrentRunner();
}

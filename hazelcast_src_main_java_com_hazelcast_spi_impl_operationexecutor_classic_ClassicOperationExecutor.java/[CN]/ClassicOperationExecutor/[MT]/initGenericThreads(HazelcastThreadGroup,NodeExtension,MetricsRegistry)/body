{
  int threadCount=genericOperationRunners.length;
  GenericOperationThread[] threads=new GenericOperationThread[threadCount];
  for (int threadId=0; threadId < threads.length; threadId++) {
    String threadName=threadGroup.getThreadPoolNamePrefix("generic-operation") + threadId;
    OperationRunner operationRunner=genericOperationRunners[threadId];
    GenericOperationThread genericThread=new GenericOperationThread(threadName,threadId,genericQueue,logger,threadGroup,nodeExtension,operationRunner);
    threads[threadId]=genericThread;
    operationRunner.setCurrentThread(genericThread);
    metricsRegistry.scanAndRegister(genericThread,"operation." + genericThread.getName());
  }
  return threads;
}

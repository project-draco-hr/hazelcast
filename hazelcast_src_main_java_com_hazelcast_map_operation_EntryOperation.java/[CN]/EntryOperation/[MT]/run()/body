{
  final boolean isInMemoryObjectFormat=InMemoryFormat.OBJECT.equals(mapContainer.getMapConfig().getInMemoryFormat());
  oldValue=isInMemoryObjectFormat ? recordStore.getMapEntryObject(dataKey).getValue() : recordStore.getMapEntryData(dataKey).getValue();
  final Object valueBeforeProcess=mapService.toObject(oldValue);
  final MapEntrySimple entry=new MapEntrySimple(mapService.toObject(dataKey),valueBeforeProcess);
  response=mapService.toData(entryProcessor.process(entry));
  final Object valueAfterProcess=entry.getValue();
  if (oldValue == null && valueAfterProcess == null) {
    eventType=__NO_NEED_TO_FIRE_EVENT;
  }
 else   if (valueAfterProcess == null) {
    recordStore.remove(dataKey);
    eventType=EntryEventType.REMOVED;
  }
 else {
    if (oldValue == null) {
      eventType=EntryEventType.ADDED;
    }
 else     if (!entry.isModified()) {
      eventType=__NO_NEED_TO_FIRE_EVENT;
    }
 else {
      eventType=EntryEventType.UPDATED;
    }
    if (eventType != __NO_NEED_TO_FIRE_EVENT) {
      dataValue=mapService.toData(entry.getValue());
      recordStore.put(new AbstractMap.SimpleImmutableEntry<Data,Object>(dataKey,dataValue));
    }
  }
}

{
  MultiResultSet results=new MultiResultSet();
  if (valueOrder != null) {
    Set<Long> values=valueOrder.subSet(from,to);
    for (    Long value : values) {
      ConcurrentMap<Long,Record> records=mapRecords.get(value);
      if (records != null) {
        results.addResultSet(value,records.values());
      }
    }
    ConcurrentMap<Long,Record> records=mapRecords.get(to);
    if (records != null) {
      results.addResultSet(to,records.values());
    }
    return results;
  }
 else {
    Set<Long> values=mapRecords.keySet();
    for (    Long value : values) {
      if (value >= from && value <= to) {
        ConcurrentMap<Long,Record> records=mapRecords.get(value);
        if (records != null) {
          results.addResultSet(value,records.values());
        }
      }
    }
  }
  return results;
}

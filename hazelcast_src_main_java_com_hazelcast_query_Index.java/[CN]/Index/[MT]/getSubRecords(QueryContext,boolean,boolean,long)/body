{
  if (mapIndex instanceof HashSet)   return null;
  TreeMap<Long,Set<T>> treeMap=(TreeMap<Long,Set<T>>)mapIndex;
  Set<T> results=new HashSet<T>();
  Map<Long,Set<T>> sub=(lessThan) ? treeMap.headMap(value) : treeMap.tailMap(value);
  Set<Map.Entry<Long,Set<T>>> entries=sub.entrySet();
  for (  Map.Entry<Long,Set<T>> entry : entries) {
    if (equal || entry.getKey() != value) {
      Set<T> values=entry.getValue();
      if (queryContext.getIndexedPredicateCount() > 1 && values.size() > 100) {
        return null;
      }
      results.addAll(values);
    }
    if (queryContext.getIndexedPredicateCount() > 1 && results.size() > 100) {
      return null;
    }
  }
  if (lessThan && equal) {
    Set<T> recs=treeMap.get(value);
    if (recs != null) {
      results.addAll(recs);
    }
  }
  return results;
}

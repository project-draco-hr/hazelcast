{
  if (isRemoveAll) {
    final Set<Data> _keys=new HashSet<Data>(keys.isEmpty() ? records.keySet() : keys);
    try {
      final int initialCount=_keys.size();
      deleteAllCacheEntry(_keys);
      if (isStatisticsEnabled) {
        statistics.increaseCacheRemovals(initialCount - _keys.size());
      }
    }
  finally {
      final Set<Data> _keysToClean=new HashSet<Data>(keys.isEmpty() ? records.keySet() : keys);
      keys.clear();
      for (      Data key : _keysToClean) {
        if (_keys.contains(key)) {
          if (records.containsKey(key)) {
            deleteRecord(key);
          }
          keys.add(key);
        }
      }
    }
  }
 else {
    records.clear();
  }
}

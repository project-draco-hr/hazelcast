{
  if (isWriteThrough() && cacheWriter != null) {
    try {
      final Object _key=cacheService.toObject(key);
      final Object _value;
switch (cacheConfig.getInMemoryFormat()) {
case BINARY:
        _value=cacheService.toObject(value);
      break;
case OBJECT:
    _value=value;
  break;
default :
throw new IllegalArgumentException("Invalid storage format: " + cacheConfig.getInMemoryFormat());
}
CacheEntry<?,?> entry=new CacheEntry<Object,Object>(_key,_value);
cacheWriter.write(entry);
}
 catch (Exception e) {
if (!(e instanceof CacheWriterException)) {
throw new CacheWriterException("Exception in CacheWriter during write",e);
}
 else {
throw (CacheWriterException)e;
}
}
}
}

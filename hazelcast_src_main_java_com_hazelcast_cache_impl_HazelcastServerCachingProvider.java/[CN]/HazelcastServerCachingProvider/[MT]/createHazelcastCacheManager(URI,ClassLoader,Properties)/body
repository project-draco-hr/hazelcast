{
  final HazelcastInstance instance;
  if (uri == null || uri.equals(getDefaultURI())) {
    if (hazelcastInstance == null) {
      try {
        hazelcastInstance=instanceFromProperties(classLoader,properties,true);
      }
 catch (      Exception e) {
        throw ExceptionUtil.rethrow(e);
      }
    }
    instance=hazelcastInstance;
  }
 else {
    try {
      instance=instanceFromProperties(classLoader,properties,false);
      if (instance == null) {
        throw new IllegalArgumentException(INVALID_HZ_INSTANCE_SPECIFICATION_MESSAGE);
      }
    }
 catch (    Exception e) {
      throw ExceptionUtil.rethrow(e);
    }
  }
  return new HazelcastServerCacheManager(this,instance,uri,classLoader,properties);
}

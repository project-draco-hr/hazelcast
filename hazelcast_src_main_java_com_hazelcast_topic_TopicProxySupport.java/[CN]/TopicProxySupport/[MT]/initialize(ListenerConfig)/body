{
  NodeEngine nodeEngine=getNodeEngine();
  MessageListener listener;
  try {
    listener=(MessageListener)listenerConfig.getImplementation();
    if (listener == null && listenerConfig.getClassName() != null) {
      listener=ClassLoaderUtil.newInstance(configClassLoader,listenerConfig.getClassName());
    }
  }
 catch (  Exception e) {
    throw ExceptionUtil.rethrow(e);
  }
  if (listener != null) {
    if (listener instanceof HazelcastInstanceAware) {
      HazelcastInstanceAware hazelcastInstanceAware=(HazelcastInstanceAware)listener;
      hazelcastInstanceAware.setHazelcastInstance(nodeEngine.getHazelcastInstance());
    }
    addMessageListenerInternal(listener);
  }
}

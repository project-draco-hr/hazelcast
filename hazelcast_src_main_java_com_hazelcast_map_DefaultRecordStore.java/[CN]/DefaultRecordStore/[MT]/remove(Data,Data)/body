{
  Record record=records.get(dataKey);
  Object oldValue=null;
  boolean removed=false;
  if (record == null) {
    if (mapInfo.getStore() != null) {
      oldValue=mapInfo.getStore().load(mapService.toObject(dataKey));
    }
    if (oldValue == null)     return false;
  }
 else {
    oldValue=record.getValue();
  }
  if (mapService.toObject(testValue).equals(mapService.toObject(oldValue))) {
    records.remove(dataKey);
    removed=true;
    mapStoreDelete(record);
  }
  return removed;
}

{
  final long now=getNow();
  final Record existingRecord=records.put(key,record);
  updateSizeEstimator(-calculateRecordHeapCost(existingRecord));
  updateSizeEstimator(calculateRecordHeapCost(record));
  evictEntries(now,true);
}

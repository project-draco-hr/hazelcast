{
  StorageFormat storageFormat=recordFactory.getStorageFormat();
switch (storageFormat) {
case HEAP_BINARY:
case HEAP_OBJECT:
    records.clear();
  if (excludeRecords != null && !excludeRecords.isEmpty()) {
    records.putAll(excludeRecords);
  }
return;
case OFFHEAP:
Iterator<Record> iter=records.values().iterator();
while (iter.hasNext()) {
Record record=iter.next();
if (excludeRecords == null || !excludeRecords.containsKey(record.getKey())) {
record.invalidate();
iter.remove();
}
}
return;
default :
throw new IllegalArgumentException("Unknown storage format: " + storageFormat);
}
}

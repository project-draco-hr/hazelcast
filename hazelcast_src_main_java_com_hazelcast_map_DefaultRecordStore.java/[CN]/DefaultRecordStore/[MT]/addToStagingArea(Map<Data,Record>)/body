{
  final long now=getNow();
  Iterator<Record> iterator=records.values().iterator();
  while (iterator.hasNext()) {
    Record record=iterator.next();
    if (excludeRecords == null || !excludeRecords.containsKey(record.getKey())) {
      final Data key=record.getKey();
      final Object value=record.getValue();
      mapDataStore.addStagingArea(key,value,now);
    }
  }
}

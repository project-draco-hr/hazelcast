{
  checkIfLoaded();
  final long now=getNow();
  earlyWriteCleanup(now);
  Record record=records.get(key);
  Object oldValue=null;
  if (record == null) {
    removeIndex(key);
    mapDataStore.remove(key,now);
    onStore(record);
  }
 else {
    removeRecord(key,record,now);
  }
  return oldValue != null;
}

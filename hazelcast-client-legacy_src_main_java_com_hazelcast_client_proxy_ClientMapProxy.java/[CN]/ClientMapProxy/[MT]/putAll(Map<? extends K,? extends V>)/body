{
  ClientPartitionService partitionService=getContext().getPartitionService();
  int partitionCount=partitionService.getPartitionCount();
  List<Future<?>> futures=new ArrayList<Future<?>>(partitionCount);
  MapEntries[] entriesPerPartition=new MapEntries[partitionCount];
  for (  Entry<? extends K,? extends V> entry : m.entrySet()) {
    checkNotNull(entry.getKey(),NULL_KEY_IS_NOT_ALLOWED);
    checkNotNull(entry.getValue(),NULL_VALUE_IS_NOT_ALLOWED);
    Data keyData=toData(entry.getKey());
    int partitionId=partitionService.getPartitionId(keyData);
    MapEntries entries=entriesPerPartition[partitionId];
    if (entries == null) {
      entries=new MapEntries();
      entriesPerPartition[partitionId]=entries;
    }
    entries.add(new AbstractMap.SimpleImmutableEntry<Data,Data>(keyData,toData(entry.getValue())));
  }
  putAllInternal(futures,entriesPerPartition);
}

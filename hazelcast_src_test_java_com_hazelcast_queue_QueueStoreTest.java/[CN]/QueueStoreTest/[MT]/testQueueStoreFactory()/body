{
  final String queueName=randomString();
  final Config config=new Config();
  final QueueConfig queueConfig=config.getQueueConfig(queueName);
  final QueueStoreConfig queueStoreConfig=new QueueStoreConfig();
  queueStoreConfig.setEnabled(true);
  final QueueStoreFactory queueStoreFactory=new SimpleQueueStoreFactory();
  queueStoreConfig.setFactoryImplementation(queueStoreFactory);
  queueConfig.setQueueStoreConfig(queueStoreConfig);
  HazelcastInstance instance=createHazelcastInstance(config);
  final IQueue<Integer> queue=instance.getQueue(queueName);
  queue.add(1);
  final QueueStore queueStore=queueStoreFactory.newQueueStore(queueName,null);
  final TestQueueStore testQueueStore=(TestQueueStore)queueStore;
  final int size=testQueueStore.store.size();
  assertEquals("Queue store size should be 1 but found " + size,1,size);
}

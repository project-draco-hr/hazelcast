{
  final MyQueueStore store=new MyQueueStore();
  final Config config=new Config();
  final QueueConfig qConfig=config.getQueueConfig("test");
  qConfig.setMaxSize(10);
  final QueueStoreConfig queueStoreConfig=new QueueStoreConfig();
  queueStoreConfig.setStoreImplementation(store);
  queueStoreConfig.setEnabled(true);
  queueStoreConfig.setProperty("binary","false");
  queueStoreConfig.setProperty("memory-limit","0");
  queueStoreConfig.setProperty("bulk-load","100");
  qConfig.setQueueStoreConfig(queueStoreConfig);
  HazelcastInstance instance=createHazelcastInstance(config);
  for (int i=0; i < 10; i++) {
    TransactionContext context=instance.newTransactionContext();
    context.beginTransaction();
    TransactionalQueue<String> queue=context.getQueue("test");
    String queue_data=queue.poll();
    assertNotNull(queue_data);
    context.commitTransaction();
  }
}

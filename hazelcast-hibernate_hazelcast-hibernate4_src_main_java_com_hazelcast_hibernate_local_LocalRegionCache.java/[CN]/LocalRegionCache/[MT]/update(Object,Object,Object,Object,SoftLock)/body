{
  if (lock == LOCK_FAILURE) {
    return false;
  }
  final Value currentValue=cache.get(key);
  if (lock == LOCK_SUCCESS) {
    if (currentValue != null && currentVersion != null && versionComparator.compare(currentVersion,currentValue.getVersion()) < 0) {
      return false;
    }
  }
  if (topic != null) {
    topic.publish(createMessage(key,value,currentVersion));
  }
  cache.put(key,new Value(currentVersion,value,lock,Clock.currentTimeMillis()));
  return true;
}

{
synchronized (factoryLock) {
    FactoryImpl factory=hazelcastInstanceProxy.getFactory();
    try {
      factory.managementService.unregister();
    }
 catch (    Throwable e) {
      e.printStackTrace();
    }
    factory.proxies.clear();
    factory.node.shutdown();
    factories.remove(factory.getName());
    if (factories.size() == 0) {
      shutdownManagementService();
    }
  }
}

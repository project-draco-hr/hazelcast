{
synchronized (factoryLock) {
    FactoryImpl factory=hazelcastInstanceProxy.getFactory();
    try {
      factory.managementService.unregister();
    }
 catch (    Throwable e) {
      e.printStackTrace();
    }
    factory.proxies.clear();
    if (factory.managementCenterService != null) {
      factory.managementCenterService.shutdown();
    }
    for (    ExecutorServiceProxy esp : factory.executorServiceProxies.values()) {
      esp.shutdown();
    }
    factory.node.shutdown();
    factories.remove(factory.getName());
    if (factories.size() == 0) {
      shutdownManagementService();
    }
  }
}

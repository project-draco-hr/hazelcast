{
synchronized (factoryLock) {
    Collection<FactoryImpl> colFactories=factories.values();
    for (    FactoryImpl factory : colFactories) {
      factory.shutdown();
    }
    factories.clear();
  }
}

{
  InternalPartitionServiceImpl partitionService=getService();
  long[] currentVersions=partitionService.getPartitionReplicaVersions(partitionId);
  long currentReplicaVersion=currentVersions[replicaIndex - 1];
  if (currentReplicaVersion > 0) {
    CheckReplicaVersion op=createCheckReplicaVersion(partitionId,replicaIndex,currentReplicaVersion);
    NodeEngine nodeEngine=getNodeEngine();
    OperationService operationService=nodeEngine.getOperationService();
    if (sync) {
      operationService.createInvocationBuilder(InternalPartitionService.SERVICE_NAME,op,target).setCallback(callback).setTryCount(OPERATION_TRY_COUNT).setTryPauseMillis(OPERATION_TRY_PAUSE_MILLIS).invoke();
    }
 else {
      operationService.send(op,target);
    }
  }
 else {
    notifyCallback(true);
  }
}

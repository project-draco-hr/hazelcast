{
  Map<Long,Data> dataMap=new HashMap<Long,Data>(dataList.size());
  for (  Data data : dataList) {
    QueueItem item=new QueueItem(this,nextId());
    if (!store.isEnabled() || store.getMemoryLimit() > getItemQueue().size()) {
      item.setData(data);
    }
    getItemQueue().offer(item);
    dataMap.put(item.getItemId(),data);
  }
  if (store.isEnabled()) {
    try {
      store.storeAll(dataMap);
    }
 catch (    Exception e) {
      for (int i=0; i < dataList.size(); i++) {
        getItemQueue().poll();
      }
      throw new HazelcastException(e);
    }
  }
  return dataMap;
}

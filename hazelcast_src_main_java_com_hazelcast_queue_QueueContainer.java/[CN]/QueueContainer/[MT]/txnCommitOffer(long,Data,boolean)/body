{
  QueueItem item=txMap.remove(itemId);
  if (item == null && !backup) {
    throw new TransactionException("No reserve :" + itemId);
  }
 else   if (item == null) {
    item=new QueueItem(this,itemId,data);
  }
  item.setData(data);
  if (!backup) {
    getItemQueue().offer(item);
  }
  QueueItem replaced=itemMap.put(item.getItemId(),item);
  if (replaced != null) {
    logger.log(Level.SEVERE,"txnCommitOffer operation-> Item exists already at itemMap for itemId: " + item.getItemId());
  }
  if (store.isEnabled()) {
    try {
      store.store(item.getItemId(),data);
    }
 catch (    Exception e) {
      e.printStackTrace();
    }
  }
  return true;
}

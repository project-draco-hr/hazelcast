{
  QueueItem item=new QueueItem(this,nextId());
  if (store.isEnabled()) {
    try {
      store.store(item.getItemId(),data);
    }
 catch (    Exception e) {
      throw new HazelcastException(e);
    }
  }
  if (!store.isEnabled() || store.getMemoryLimit() > getItemQueue().size()) {
    item.setData(data);
  }
  getItemQueue().offer(item);
  QueueItem replaced=itemMap.put(item.getItemId(),item);
  if (replaced != null) {
    logger.log(Level.SEVERE,"offer operation-> Item already exists at itemMap for itemId: " + item.getItemId());
  }
  return item.getItemId();
}

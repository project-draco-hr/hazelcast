{
  if (prepareTransaction()) {
    return;
  }
  record=mapPartition.records.get(dataKey);
  if (record == null) {
    load();
    record=new DefaultRecord(getPartitionId(),dataKey,dataValue,-1,-1,mapService.nextId());
    mapPartition.records.put(dataKey,record);
  }
 else {
    record.setValueData(dataValue);
  }
  record.setActive();
  record.setDirty(true);
  store();
  successful=true;
}

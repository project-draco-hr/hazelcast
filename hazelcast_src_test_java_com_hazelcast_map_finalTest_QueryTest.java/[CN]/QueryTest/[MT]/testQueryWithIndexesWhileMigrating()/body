{
  Config cfg=new Config();
  StaticNodeFactory nodeFactory=new StaticNodeFactory(4);
  HazelcastInstance h1=nodeFactory.newHazelcastInstance(cfg);
  HazelcastInstance h2=nodeFactory.newHazelcastInstance(cfg);
  HazelcastInstance h3=nodeFactory.newHazelcastInstance(cfg);
  HazelcastInstance h4=nodeFactory.newHazelcastInstance(cfg);
  IMap imap=h1.getMap("employees");
  imap.addIndex("name",false);
  imap.addIndex("age",true);
  imap.addIndex("active",false);
  for (int i=0; i < 500; i++) {
    Map temp=new HashMap(100);
    for (int j=0; j < 100; j++) {
      String key=String.valueOf((i * 100000) + j);
      temp.put(key,new Employee("name" + key,i % 60,((i & 1) == 1),Double.valueOf(i)));
    }
    imap.putAll(temp);
  }
  assertEquals(50000,imap.size());
  for (int i=0; i < 1; i++) {
    Set<Map.Entry> entries=imap.entrySet(new SqlPredicate("active=true and age>44"));
    assertEquals(6400,entries.size());
  }
}

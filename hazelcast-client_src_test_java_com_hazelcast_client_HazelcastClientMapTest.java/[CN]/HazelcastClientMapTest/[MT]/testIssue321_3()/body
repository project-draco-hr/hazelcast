{
  HazelcastClient hClient=getHazelcastClient();
  final IMap<Integer,Integer> imap=hClient.getMap("testIssue321_3");
  final BlockingQueue<EntryEvent<Integer,Integer>> events=new LinkedBlockingQueue<EntryEvent<Integer,Integer>>();
  final EntryAdapter listener=new EntryAdapter(){
    @Override public void entryAdded(    EntryEvent event){
      System.out.println("Received an event " + event);
      events.add(event);
    }
  }
;
  imap.addEntryListener(listener,true);
  Thread.sleep(50L);
  imap.addEntryListener(listener,false);
  imap.put(1,1);
  final EntryEvent<Integer,Integer> event1=events.poll(10,TimeUnit.MILLISECONDS);
  final EntryEvent<Integer,Integer> event2=events.poll(10,TimeUnit.MILLISECONDS);
  assertNotNull(event1);
  assertNotNull(event2);
  assertTrue(event1.getValue() == null || event2.getValue() == null);
  assertTrue(event1.getValue() != null || event2.getValue() != null);
}

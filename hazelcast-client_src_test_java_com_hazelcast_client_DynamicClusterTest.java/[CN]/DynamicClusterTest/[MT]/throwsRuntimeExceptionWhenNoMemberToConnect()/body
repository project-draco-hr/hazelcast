{
  HazelcastInstance h1=Hazelcast.newHazelcastInstance(null);
  HazelcastInstance h2=Hazelcast.newHazelcastInstance(null);
  HazelcastInstance h3=Hazelcast.newHazelcastInstance(null);
  Map<String,Integer> realMap=h3.getMap("default");
  Map<Integer,HazelcastInstance> memberMap=getMapOfClusterMembers(h1,h2);
  client=getHazelcastClient(h1,h2);
  Map<String,Integer> map=client.getMap("default");
  int counter=0;
  realMap.get("key");
  while (counter < 3) {
    System.out.println("COUNTER: " + counter);
    map.put("key",counter);
    assertEquals(counter,map.get("key"));
    System.out.println("ASSERT MAP.GET");
    System.out.println("ASSERT REALMAP.GET");
    assertEquals(counter,realMap.get("key"));
    memberMap.get(client.getConnectionManager().getConnection().getAddress().getPort()).shutdown();
    System.out.println("Killed member");
    counter++;
  }
}

{
  Packet auth=new Packet();
  auth.set("",ClusterOperation.CLIENT_AUTHENTICATE,new byte[0],toByteArray(credentials));
  Packet packet=writeAndRead(connection,auth);
  final Object response=toObject(packet.getValue());
  logger.log(Level.FINEST,"auth response:" + response);
  if (response instanceof Exception) {
    throw new RuntimeException((Exception)response);
  }
  if (!Boolean.TRUE.equals(response)) {
    throw new AuthenticationException("Client [" + connection + "] has failed authentication");
  }
}

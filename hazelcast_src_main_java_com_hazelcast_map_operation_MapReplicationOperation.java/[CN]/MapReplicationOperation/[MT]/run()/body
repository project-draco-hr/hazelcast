{
  MapService mapService=getService();
  if (data != null) {
    for (    Entry<String,Set<RecordReplicationInfo>> dataEntry : data.entrySet()) {
      Set<RecordReplicationInfo> recordReplicationInfos=dataEntry.getValue();
      final String mapName=dataEntry.getKey();
      RecordStore recordStore=mapService.getRecordStore(getPartitionId(),mapName);
      for (      RecordReplicationInfo recordReplicationInfo : recordReplicationInfos) {
        Data key=recordReplicationInfo.getKey();
        Record newRecord=mapService.createRecord(mapName,key,recordReplicationInfo.getValue(),-1,false);
        mapService.applyRecordInfo(newRecord,mapName,recordReplicationInfo);
        final Record existingRecord=recordStore.putRecord(key,newRecord);
        final SizeEstimator sizeEstimator=recordStore.getSizeEstimator();
        updateSizeEstimator(-calculateRecordSize(existingRecord,sizeEstimator),sizeEstimator);
        updateSizeEstimator(calculateRecordSize(newRecord,sizeEstimator),sizeEstimator);
      }
      recordStore.setLoaded(true);
    }
  }
}

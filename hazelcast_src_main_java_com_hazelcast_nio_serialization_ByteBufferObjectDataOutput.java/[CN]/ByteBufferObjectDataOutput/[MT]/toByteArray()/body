{
  if (buffer == null) {
    return new byte[0];
  }
  final DynamicByteBuffer duplicate=buffer.duplicate();
  duplicate.flip();
  final byte[] newBuffer=new byte[duplicate.limit()];
  duplicate.get(newBuffer);
  return newBuffer;
}

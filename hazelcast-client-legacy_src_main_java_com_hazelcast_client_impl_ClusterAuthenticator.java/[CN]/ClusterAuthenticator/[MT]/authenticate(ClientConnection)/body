{
  final ClientClusterServiceImpl clusterService=(ClientClusterServiceImpl)client.getClientClusterService();
  final ClientPrincipal principal=clusterService.getPrincipal();
  final SerializationService ss=client.getSerializationService();
  AuthenticationRequest auth=new AuthenticationRequest(credentials,principal);
  connection.init();
  SerializableList collectionWrapper;
  final ClientInvocation clientInvocation=new ClientInvocation(client,auth,connection);
  final Future<SerializableList> future=clientInvocation.invokeUrgent();
  try {
    collectionWrapper=ss.toObject(future.get());
  }
 catch (  Exception e) {
    throw ExceptionUtil.rethrow(e,IOException.class);
  }
  final Iterator<Data> iter=collectionWrapper.iterator();
  final Data addressData=iter.next();
  final Address address=ss.toObject(addressData);
  connection.setRemoteEndpoint(address);
}

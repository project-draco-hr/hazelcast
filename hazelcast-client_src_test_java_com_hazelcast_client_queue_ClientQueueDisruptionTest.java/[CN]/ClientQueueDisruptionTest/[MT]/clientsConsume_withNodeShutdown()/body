{
  final int initial=2000, max=8000;
  for (int i=0; i < initial; i++) {
    cluster.getRandomNode().getQueue("Q1").offer(i);
    cluster.getRandomNode().getQueue("Q2").offer(i);
  }
  int expect=0;
  for (int i=initial; i < max; i++) {
    if (i == max / 2) {
      cluster.shutdownRandomNode();
    }
    assertTrue(cluster.getRandomNode().getQueue("Q1").offer(i));
    assertTrue(cluster.getRandomNode().getQueue("Q2").offer(i));
    TestCase.assertEquals(expect,client1.getQueue("Q1").poll());
    TestCase.assertEquals(expect,client2.getQueue("Q2").poll());
    expect++;
  }
  for (int i=expect; i < max; i++) {
    TestCase.assertEquals(i,client1.getQueue("Q1").poll());
    TestCase.assertEquals(i,client2.getQueue("Q2").poll());
  }
}

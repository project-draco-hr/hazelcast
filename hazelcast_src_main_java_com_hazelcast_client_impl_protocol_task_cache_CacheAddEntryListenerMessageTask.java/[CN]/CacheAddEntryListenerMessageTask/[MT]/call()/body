{
  final ClientEndpoint endpoint=getEndpoint();
  final CacheService service=getService(CacheService.SERVICE_NAME);
  CacheEventListener entryListener=new CacheEventListener(){
    @Override public void handleEvent(    Object eventObject){
      if (!endpoint.isAlive()) {
        return;
      }
      if (eventObject instanceof CacheEventSet) {
        CacheEventSet ces=(CacheEventSet)eventObject;
        Data partitionKey=getPartitionKey(eventObject);
        final ClientMessage clientMessage=CacheEventSetParameters.encode(ces.getEventType(),ces.getEvents(),ces.getCompletionId());
        sendClientMessage(partitionKey,clientMessage);
      }
    }
  }
;
  final String registrationId=service.registerListener(parameters.name,entryListener);
  return registrationId;
}

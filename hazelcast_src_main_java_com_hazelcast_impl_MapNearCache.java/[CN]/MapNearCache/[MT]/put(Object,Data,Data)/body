{
  checkThread();
  if (cache.size() != sortedMap.size()) {
    throw new IllegalStateException("cache and sorted map size should be the same: " + cache.size() + " vs. "+ sortedMap.size());
  }
  if (cache.size() + 1 >= maxSize) {
    startEviction();
  }
  if (cache.size() + 1 >= maxSize) {
    return;
  }
  if (!sortedMap.containsKey(keyData)) {
    sortedMap.put(keyData,key);
  }
  CacheEntry cacheEntry=cache.get(key);
  if (cacheEntry == null) {
    cacheEntry=new CacheEntry(key,keyData,value);
  }
 else {
    cacheEntry.setValue(value);
  }
  cache.put(key,cacheEntry);
}

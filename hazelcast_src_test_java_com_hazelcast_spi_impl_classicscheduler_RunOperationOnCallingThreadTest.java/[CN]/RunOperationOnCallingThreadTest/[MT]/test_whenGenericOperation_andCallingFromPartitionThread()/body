{
  initScheduler();
  final DummyGenericOperation genericOperation=new DummyGenericOperation();
  final int partitionId=0;
  PartitionSpecificCallable task=new PartitionSpecificCallable(partitionId){
    @Override public Object call(){
      scheduler.runOperationOnCallingThread(genericOperation);
      return null;
    }
  }
;
  scheduler.execute(task);
  assertTrueEventually(new AssertTask(){
    @Override public void run() throws Exception {
      DummyOperationHandler handler=(DummyOperationHandler)scheduler.getPartitionOperationHandlers()[partitionId];
      assertTrue(handler.operations.contains(genericOperation));
    }
  }
);
}

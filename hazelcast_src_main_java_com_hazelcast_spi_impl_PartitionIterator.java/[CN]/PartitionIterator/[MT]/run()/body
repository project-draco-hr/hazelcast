{
  final NodeService nodeService=getNodeService();
  try {
    Map<Integer,Object> results=new HashMap<Integer,Object>(partitions.size());
    Map<Integer,ResponseQueue> responses=new HashMap<Integer,ResponseQueue>(partitions.size());
    for (    final int partitionId : partitions) {
      Operation op=(Operation)nodeService.toObject(operationData);
      ResponseQueue r=new ResponseQueue();
      op.setNodeService(getNodeService()).setCaller(getCaller()).setPartitionId(partitionId).setReplicaIndex(getReplicaIndex()).setResponseHandler(r).setService(getService());
      nodeService.runOperation(op);
      responses.put(partitionId,r);
    }
    for (    Map.Entry<Integer,ResponseQueue> partitionResponse : responses.entrySet()) {
      Object result=partitionResponse.getValue().get();
      results.put(partitionResponse.getKey(),result);
    }
  }
 catch (  Exception e) {
    nodeService.getLogger(PartitionIterator.class.getName()).log(Level.WARNING,e.getMessage(),e);
  }
}

{
  final QueueItem offer=offeredQueue.peek();
  final TxnPeekOperation operation=new TxnPeekOperation(name,timeout,offer == null ? -1 : offer.getItemId(),tx.getTxnId());
  try {
    final Future<QueueItem> f=getNodeEngine().getOperationService().invokeOnPartition(QueueService.SERVICE_NAME,operation,partitionId);
    final QueueItem item=f.get();
    if (item != null) {
      if (offer != null && item.getItemId() == offer.getItemId()) {
        return offer.getData();
      }
      return item.getData();
    }
  }
 catch (  Throwable t) {
    throw ExceptionUtil.rethrow(t);
  }
  return null;
}

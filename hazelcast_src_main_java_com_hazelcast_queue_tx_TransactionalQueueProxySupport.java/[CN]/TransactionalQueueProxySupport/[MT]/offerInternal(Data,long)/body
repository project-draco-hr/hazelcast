{
  TxnReserveOfferOperation operation=new TxnReserveOfferOperation(name,timeout);
  try {
    Invocation invocation=getNodeEngine().getOperationService().createInvocationBuilder(QueueService.SERVICE_NAME,operation,partitionId).build();
    Future<Long> f=invocation.invoke();
    long itemId=f.get();
    if (itemId != -1) {
      offerQueue.offer(new QueueItem(null,itemId,data));
      tx.addTransactionLog(new QueueTransactionLog(itemId,name,partitionId,new TxnOfferOperation(name,itemId,data)));
    }
    return itemId != -1;
  }
 catch (  Throwable t) {
    ExceptionUtil.rethrow(t);
  }
  return false;
}

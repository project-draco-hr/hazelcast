{
synchronized (lock) {
    long timeLeft=unit.toMillis(timeout);
    while (results.size() == 0 && timeLeft > 0) {
      long start=System.currentTimeMillis();
      lock.wait(timeLeft);
      if (results.size() > 0) {
        return results.removeFirst();
      }
      timeLeft-=(System.currentTimeMillis() - start);
    }
    if (results.size() == 0) {
      return null;
    }
 else {
      return results.removeFirst();
    }
  }
}

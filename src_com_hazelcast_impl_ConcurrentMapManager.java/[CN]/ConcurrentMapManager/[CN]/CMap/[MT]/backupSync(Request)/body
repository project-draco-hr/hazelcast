{
  Record record=getRecord(req.key);
  if (record != null) {
    if (req.version <= record.version) {
      logger.log(Level.FINEST,req.version + " backupSync! oldVersion " + record.version);
      return false;
    }
  }
  if (req.operation == OP_CMAP_BACKUP_PUT_SYNC) {
    record=toRecord(req);
    record.owner=req.caller;
  }
 else   if (req.operation == OP_CMAP_BACKUP_REMOVE_SYNC) {
    removeRecord(req.key);
  }
 else   if (req.operation == OP_CMAP_BACKUP_LOCK_SYNC) {
    record=toRecord(req);
  }
  if (record != null) {
    record.version=req.version;
  }
  return true;
}

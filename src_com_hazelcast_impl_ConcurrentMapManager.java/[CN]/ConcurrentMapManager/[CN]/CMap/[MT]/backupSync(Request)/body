{
  Record record=getRecord(req.key);
  if (record != null) {
    if (req.version <= record.version) {
      return false;
    }
  }
  if (req.operation == OP_CMAP_BACKUP_PUT_SYNC) {
    record=toRecord(req);
    record.owner=req.caller;
  }
 else   if (req.operation == OP_CMAP_BACKUP_REMOVE_SYNC) {
    removeRecord(req.key);
  }
 else   if (req.operation == OP_CMAP_BACKUP_LOCK_SYNC) {
    record=toRecord(req);
  }
  record.version=req.version;
  return true;
}

{
  if (req.operation == OP_CMAP_BACKUP_PUT) {
    Record record=toRecord(req);
    if (record.value != null) {
      record.value.setNoData();
    }
    record.value=req.value;
    record.copyCount=(int)req.longValue;
    req.value=null;
  }
 else   if (req.operation == OP_CMAP_BACKUP_REMOVE) {
    Record record=getRecord(req.key);
    if (record != null) {
      if (record.value != null) {
        record.value.setNoData();
      }
      if (record.lsValues != null) {
        for (        Data value : record.lsValues) {
          value.setNoData();
        }
      }
      record.copyCount--;
      record.value=null;
    }
  }
 else   if (req.operation == OP_CMAP_BACKUP_LOCK) {
    toRecord(req);
  }
 else   if (req.operation == OP_CMAP_BACKUP_PUT_MULTI) {
    Record record=getRecord(req.key);
    if (record == null) {
      record=createNewRecord(req.key,null);
    }
    record.addValue(req.value);
    req.value=null;
  }
 else   if (req.operation == OP_CMAP_BACKUP_REMOVE_MULTI) {
    Record record=getRecord(req.key);
    if (record != null) {
      if (req.value == null) {
        removeRecord(req.key);
      }
 else {
        if (record.containsValue(req.value)) {
          if (record.lsValues != null) {
            Iterator<Data> itValues=record.lsValues.iterator();
            while (itValues.hasNext()) {
              Data value=itValues.next();
              if (req.value.equals(value)) {
                itValues.remove();
                value.setNoData();
              }
            }
          }
        }
      }
    }
  }
 else {
    logger.log(Level.SEVERE,"Unknown backup operation " + req.operation);
  }
}

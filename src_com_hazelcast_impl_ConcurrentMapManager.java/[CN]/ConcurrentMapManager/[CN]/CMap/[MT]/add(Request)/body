{
  Record record=getRecord(req.key);
  if (record == null) {
    req.value=ThreadContext.get().hardCopy(req.key);
    record=createNewRecord(req.key,req.value);
  }
 else {
    if (req.operation == OP_CMAP_ADD_TO_LIST) {
      record.incrementCopyAndGet();
    }
 else {
      return false;
    }
  }
  return true;
}

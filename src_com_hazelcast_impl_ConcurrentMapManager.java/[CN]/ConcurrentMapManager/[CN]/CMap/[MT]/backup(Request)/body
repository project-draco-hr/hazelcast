{
  Record record=getRecord(req.key);
  if (record != null) {
    if (req.version > record.version + 1) {
      Request reqCopy=new Request();
      reqCopy.setFromRequest(req,false);
      req.key=null;
      req.value=null;
      record.addBackupOp(new VersionedBackupOp(req));
      return true;
    }
 else     if (req.version <= record.version) {
      return false;
    }
  }
  doBackup(req);
  record=getRecord(req.key);
  if (record != null) {
    record.version=req.version;
    record.runBackupOps();
  }
  return true;
}

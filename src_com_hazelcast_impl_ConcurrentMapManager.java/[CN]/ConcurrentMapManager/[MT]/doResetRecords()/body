{
  if (isSuperClient())   return;
  final Object[] records=mapRecordsById.values().toArray();
  mapRecordsById.clear();
  Collection<CMap> cmaps=maps.values();
  for (  CMap cmap : cmaps) {
    cmap.mapRecords.clear();
  }
  for (  Object recObj : records) {
    final Record rec=(Record)recObj;
    rec.runBackupOps();
    CMap cmap=getMap(rec.name);
    cmap.removeRecord(rec.key);
    executeLocally(new Runnable(){
      public void run(){
        MMigrate mmigrate=new MMigrate();
        mmigrate.migrate(rec);
      }
    }
);
  }
  executeLocally(new Runnable(){
    public void run(){
      Processable processCompletion=new Processable(){
        public void process(){
          doMigrationComplete(thisAddress);
          sendMigrationComplete();
          if (DEBUG) {
            printBlocks();
            logger.log(Level.FINEST,"Migration ended!");
          }
        }
      }
;
      enqueueAndReturn(processCompletion);
    }
  }
);
}

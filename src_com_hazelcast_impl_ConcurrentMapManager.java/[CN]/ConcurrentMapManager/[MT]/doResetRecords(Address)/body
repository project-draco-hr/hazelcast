{
  if (isSuperClient())   return;
  Collection<CMap> cmaps=maps.values();
  for (  final CMap cmap : cmaps) {
    final Object[] records=cmap.mapRecords.values().toArray();
    cmap.reset();
    for (    Object recObj : records) {
      final Record rec=(Record)recObj;
      if (rec.key == null || rec.key.size() == 0) {
        logger.log(Level.SEVERE,"Record.key is null or empty " + rec.key);
      }
      boolean shouldMigrate=false;
      if (thisAddress.equals(rec.owner)) {
        shouldMigrate=true;
      }
 else       if (deadAddress != null && deadAddress.equals(rec.owner)) {
        rec.forceBackupOps();
        shouldMigrate=true;
      }
      if (shouldMigrate) {
        executeLocally(new Runnable(){
          public void run(){
            MMigrate mmigrate=new MMigrate();
            if (cmap.isMultiMap()) {
              List<Data> values=rec.lsValues;
              if (values == null || values.size() == 0) {
                mmigrate.migrateMulti(rec,null);
              }
 else {
                for (                Data value : values) {
                  mmigrate.migrateMulti(rec,value);
                }
              }
            }
 else {
              mmigrate.migrate(rec);
            }
          }
        }
);
      }
    }
  }
  executeLocally(new Runnable(){
    public void run(){
      Processable processCompletion=new Processable(){
        public void process(){
          doMigrationComplete(thisAddress);
          sendMigrationComplete();
          if (DEBUG) {
            printBlocks();
            logger.log(Level.FINEST,"Migration ended!");
          }
        }
      }
;
      enqueueAndReturn(processCompletion);
    }
  }
);
}

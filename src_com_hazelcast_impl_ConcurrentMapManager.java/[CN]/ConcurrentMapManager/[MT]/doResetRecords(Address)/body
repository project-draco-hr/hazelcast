{
  if (isSuperClient())   return;
  Collection<CMap> cmaps=maps.values();
  for (  CMap cmap : cmaps) {
    final Object[] records=cmap.mapRecords.values().toArray();
    cmap.reset();
    for (    Object recObj : records) {
      final Record rec=(Record)recObj;
      boolean shouldMigrate=false;
      if (thisAddress.equals(rec.owner)) {
        shouldMigrate=true;
      }
 else       if (deadAddress != null && deadAddress.equals(rec.owner)) {
        rec.forceBackupOps();
        shouldMigrate=true;
      }
      if (shouldMigrate) {
        executeLocally(new Runnable(){
          public void run(){
            MMigrate mmigrate=new MMigrate();
            mmigrate.migrate(rec);
          }
        }
);
      }
    }
  }
  executeLocally(new Runnable(){
    public void run(){
      Processable processCompletion=new Processable(){
        public void process(){
          doMigrationComplete(thisAddress);
          sendMigrationComplete();
          if (DEBUG) {
            printBlocks();
            logger.log(Level.FINEST,"Migration ended!");
          }
        }
      }
;
      enqueueAndReturn(processCompletion);
    }
  }
);
}

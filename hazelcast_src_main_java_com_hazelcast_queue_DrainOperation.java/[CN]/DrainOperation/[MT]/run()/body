{
  QueueContainer container=getContainer();
  itemList=container.drain(maxSize);
  Set<Long> keySet=new HashSet<Long>(itemList.size());
  List<Data> dataList=new ArrayList<Data>(itemList.size());
  for (  QueueItem item : itemList) {
    keySet.add(item.getItemId());
    dataList.add(item.getData());
  }
  response=dataList;
  if (!container.isStoreAsync()) {
    container.getStore().deleteAll(keySet);
  }
}

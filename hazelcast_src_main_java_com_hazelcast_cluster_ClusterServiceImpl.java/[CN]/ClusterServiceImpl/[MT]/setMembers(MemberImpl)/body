{
  if (members == null || members.length == 0)   return;
  logger.finest("Updating members -> " + Arrays.toString(members));
  lock.lock();
  try {
    Collection<MemberImpl> newMembers=new LinkedList<MemberImpl>();
    Map<Address,MemberImpl> oldMemberMap=membersRef.get();
    if (oldMemberMap == null) {
      oldMemberMap=Collections.emptyMap();
    }
    final Map<Address,MemberImpl> memberMap=new LinkedHashMap<Address,MemberImpl>();
    for (    MemberImpl member : members) {
      MemberImpl currentMember=oldMemberMap.get(member.getAddress());
      if (currentMember == null) {
        newMembers.add(member);
        masterConfirmationTimes.put(member,Clock.currentTimeMillis());
      }
      memberMap.put(member.getAddress(),member);
    }
    setMembersRef(memberMap);
    for (    MemberImpl member : newMembers) {
      node.getPartitionService().memberAdded(member);
      sendMembershipEventNotifications(member,true);
    }
  }
  finally {
    lock.unlock();
  }
}

{
  if (node.securityContext != null && !setJoins.contains(newMemberInfo)) {
    Credentials cr=joinRequest.getCredentials();
    if (cr == null) {
      throw new SecurityException("Expecting security credentials " + "but credentials could not be found in JoinRequest!");
    }
 else {
      try {
        LoginContext lc=node.securityContext.createMemberLoginContext(cr);
        lc.login();
      }
 catch (      LoginException e) {
        throw new SecurityException("Authentication has failed for " + cr.getPrincipal() + '@'+ cr.getEndpoint()+ " => ("+ e.getMessage()+ ")");
      }
    }
  }
}

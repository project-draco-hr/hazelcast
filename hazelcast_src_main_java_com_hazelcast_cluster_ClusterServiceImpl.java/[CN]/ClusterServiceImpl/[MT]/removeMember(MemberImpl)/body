{
  logger.info("Removing " + deadMember);
  lock.lock();
  try {
    final Map<Address,MemberImpl> members=membersRef.get();
    if (members != null && members.containsKey(deadMember.getAddress())) {
      Map<Address,MemberImpl> newMembers=new LinkedHashMap<Address,MemberImpl>(members);
      newMembers.remove(deadMember.getAddress());
      masterConfirmationTimes.remove(deadMember);
      setMembersRef(newMembers);
      node.getPartitionService().memberRemoved(deadMember);
      nodeEngine.onMemberLeft(deadMember);
      sendMembershipEventNotifications(deadMember,Collections.unmodifiableSet(new LinkedHashSet<Member>(newMembers.values())),false);
      if (node.isMaster()) {
        logger.finest(deadMember + " is dead. Sending remove to all other members.");
        invokeMemberRemoveOperation(deadMember.getAddress());
      }
    }
  }
  finally {
    lock.unlock();
  }
}

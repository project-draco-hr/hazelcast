{
  lock.lock();
  try {
    Map<Address,MemberImpl> oldMemberMap=membersRef.get();
    if (oldMemberMap == null) {
      oldMemberMap=Collections.emptyMap();
    }
    if (oldMemberMap.size() == members.size()) {
      boolean same=true;
      for (      MemberInfo memberInfo : members) {
        MemberImpl member=oldMemberMap.get(memberInfo.getAddress());
        if (member == null || !member.getUuid().equals(memberInfo.uuid)) {
          same=false;
          break;
        }
      }
      if (same) {
        logger.log(Level.FINEST,"No need to process member update...");
        return;
      }
    }
    MemberImpl[] newMembers=new MemberImpl[members.size()];
    int k=0;
    for (    MemberInfo memberInfo : members) {
      MemberImpl member=oldMemberMap.get(memberInfo.address);
      if (member == null) {
        member=createMember(memberInfo.address,memberInfo.uuid,thisAddress.getScopeId());
      }
      newMembers[k++]=member;
      member.didRead();
    }
    setMembers(newMembers);
    if (!getMemberList().contains(thisMember)) {
      throw new HazelcastException("Member list doesn't contain local member!");
    }
    joinReset();
    heartBeater();
    node.setJoined();
    logger.log(Level.INFO,membersString());
  }
  finally {
    lock.unlock();
  }
}

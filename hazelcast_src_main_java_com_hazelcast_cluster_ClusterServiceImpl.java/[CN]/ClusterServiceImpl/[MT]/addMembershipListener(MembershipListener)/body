{
  if (listener instanceof InitialMembershipListener) {
    lock.lock();
    try {
      ((InitialMembershipListener)listener).init(new InitialMembershipEvent(getClusterProxy(),getMembers()));
      final EventRegistration registration=nodeEngine.getEventService().registerLocalListener(SERVICE_NAME,SERVICE_NAME,listener);
      return registration.getId();
    }
  finally {
      lock.unlock();
    }
  }
 else {
    final EventRegistration registration=nodeEngine.getEventService().registerLocalListener(SERVICE_NAME,SERVICE_NAME,listener);
    return registration.getId();
  }
}

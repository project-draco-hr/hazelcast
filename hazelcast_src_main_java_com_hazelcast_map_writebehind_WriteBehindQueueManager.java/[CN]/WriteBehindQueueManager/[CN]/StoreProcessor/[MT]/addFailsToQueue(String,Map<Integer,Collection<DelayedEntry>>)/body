{
  if (failsPerPartition.isEmpty()) {
    return;
  }
  for (  Map.Entry<Integer,Collection<DelayedEntry>> entry : failsPerPartition.entrySet()) {
    final Integer partitionId=entry.getKey();
    final Collection<DelayedEntry> fails=failsPerPartition.get(partitionId);
    if (fails == null || fails.isEmpty()) {
      continue;
    }
    final RecordStore recordStore=getRecordStoreOrNull(mapName,partitionId);
    if (recordStore == null) {
      continue;
    }
    final WriteBehindQueue<DelayedEntry> queue=recordStore.getWriteBehindQueue();
    queue.addFront(fails);
  }
}

{
  if (failsPerPartition.isEmpty()) {
    return;
  }
  for (  Map.Entry<Integer,List<DelayedEntry>> entry : failsPerPartition.entrySet()) {
    final Integer partitionId=entry.getKey();
    final List<DelayedEntry> fails=failsPerPartition.get(partitionId);
    if (fails == null || fails.isEmpty()) {
      continue;
    }
    final RecordStore recordStore=getRecordStoreOrNull(mapName,partitionId);
    if (recordStore == null) {
      continue;
    }
    final WriteBehindQueue<DelayedEntry> queue=recordStore.getWriteBehindQueue();
    Collections.sort(fails,DELAYED_ENTRY_COMPARATOR);
    queue.addFront(fails);
  }
}

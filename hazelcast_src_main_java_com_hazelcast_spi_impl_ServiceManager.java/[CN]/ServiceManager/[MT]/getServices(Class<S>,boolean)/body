{
  final LinkedList<S> result=new LinkedList<S>();
  for (  Object service : services.values()) {
    if (serviceClass.isAssignableFrom(service.getClass())) {
      if (service instanceof CoreService) {
        if (coreServicesFirst) {
          result.addFirst((S)service);
        }
 else {
          result.addLast((S)service);
        }
      }
 else {
        if (coreServicesFirst) {
          result.addLast((S)service);
        }
 else {
          result.addFirst((S)service);
        }
      }
    }
  }
  return result;
}

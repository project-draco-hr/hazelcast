{
  final LinkedList<NodeGroup> groups=createNodeGroups(memberGroupFactory.createMemberGroups(members));
  if (groups.size() == 0)   return currentState;
  PartitionInfo[] newState=arrange(groups,partitionCount,new CopyStateInitializer(currentState));
  finalizeArrangement(currentState,newState,lostPartitionMigrations,immediateMigrations,scheduledMigrations);
  return newState;
}

{
  final Address[][] state=new Address[partitionCount][];
  stateInitializer.initialize(state);
  TestResult result=null;
  int tryCount=0;
  while (tryCount < MAX_RETRY_COUNT && result != TestResult.PASS) {
    boolean aggressive=tryCount >= AGGRESSIVE_RETRY_THRESHOLD;
    tryArrange(state,groups,partitionCount,aggressive);
    result=testArrangement(state,groups,partitionCount);
    if (result == TestResult.FAIL) {
      logger.warning("Error detected on partition arrangement! Try-count: " + tryCount);
      stateInitializer.initialize(state);
    }
 else     if (result == TestResult.RETRY) {
      tryCount++;
      if (logger.isFinestEnabled()) {
        logger.finest("Re-trying partition arrangement.. Count: " + tryCount);
      }
    }
  }
  if (result == TestResult.FAIL) {
    logger.severe("Failed to arrange partitions !!!");
  }
  return state;
}

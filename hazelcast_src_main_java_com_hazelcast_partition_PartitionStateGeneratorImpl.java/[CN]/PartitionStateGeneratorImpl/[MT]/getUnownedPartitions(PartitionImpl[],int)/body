{
  final LinkedList<Integer> freePartitions=new LinkedList<Integer>();
  for (  PartitionImpl partition : state) {
    if (partition.getReplicaAddress(index) == null) {
      freePartitions.add(partition.getPartitionId());
    }
  }
  Collections.shuffle(freePartitions);
  return freePartitions;
}

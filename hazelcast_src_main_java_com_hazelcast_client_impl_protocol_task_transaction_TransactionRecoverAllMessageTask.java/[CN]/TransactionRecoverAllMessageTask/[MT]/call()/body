{
  ClusterService clusterService=clientEngine.getClusterService();
  Collection<MemberImpl> memberList=clusterService.getMemberList();
  TransactionManagerServiceImpl service=getService(getServiceName());
  List<Future<SerializableCollection>> futures=recoverTransactions(memberList);
  Set<SerializableXID> xids=new HashSet<SerializableXID>();
  for (  Future<SerializableCollection> future : futures) {
    try {
      SerializableCollection collectionWrapper=future.get(RECOVER_TIMEOUT,TimeUnit.MILLISECONDS);
      for (      Data data : collectionWrapper) {
        RecoveredTransaction rt=serializationService.toObject(data);
        service.addClientRecoveredTransaction(rt);
        xids.add(rt.getXid());
      }
    }
 catch (    MemberLeftException e) {
      logger.warning("Member left while recovering: " + e);
    }
catch (    Throwable e) {
      handleException(e);
    }
  }
  return TransactionRecoverAllResultParameters.encode(xids);
}

{
  SocketChannelWrapper socketChannel=null;
  try {
    ssc.configureBlocking(true);
    ssc.socket().bind(new InetSocketAddress(PORT));
    SSLContext context=createServerSslContext();
    socketChannel=new SSLSocketChannelWrapper(context,ssc.accept(),false);
    final CountDownLatch latch=new CountDownLatch(2);
    final BlockingQueue<Integer> queue=new ArrayBlockingQueue<Integer>(count);
    ex.execute(new ChannelReader(socketChannel,count,latch){
      void processData(      int i,      int data) throws Exception {
        queue.add(data);
      }
    }
);
    ex.execute(new ChannelWriter(socketChannel,count,latch){
      int prepareData(      int i) throws Exception {
        int data=queue.poll(30,TimeUnit.SECONDS);
        return data * 2 + 1;
      }
    }
);
    latch.await(2,TimeUnit.MINUTES);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
 finally {
    IOUtil.closeResource(socketChannel);
  }
}

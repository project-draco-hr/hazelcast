{
  final boolean shouldValidateTarget=op.shouldValidateTarget();
  final int partitionId=op.getPartitionId();
  final ExecutorService executor=getExecutor(partitionId);
  executor.execute(new Runnable(){
    public void run(){
      System.out.println(Thread.currentThread() + " executing " + op);
      if (partitionId != -1 && shouldValidateTarget) {
        PartitionInfo partitionInfo=getPartitionInfo(partitionId);
        Address owner=partitionInfo.getReplicaAddress(op.getReplicaIndex());
        if (!getThisAddress().equals(owner)) {
          op.getResponseHandler().sendResponse(new WrongTargetException(getThisAddress(),owner,partitionId,op.getClass().getName()));
          return;
        }
      }
      try {
        op.run();
        System.out.println(Thread.currentThread() + " executed " + op);
      }
 catch (      Throwable e) {
        logOperationError(e);
        op.getResponseHandler().sendResponse(e);
      }
    }
  }
);
}

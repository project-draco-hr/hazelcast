{
  final int partitionId=op.getPartitionId();
  final ExecutorService executor=getExecutor(partitionId);
  executor.execute(new Runnable(){
    public void run(){
      ThreadContext.get().setCurrentOperation(op);
      try {
        checkOperation(op);
        op.run();
      }
 catch (      Throwable e) {
        logOperationError(e);
        op.getResponseHandler().sendResponse(e);
      }
    }
  }
);
}

{
  final boolean nonBlocking=op instanceof NonBlockingOperation;
  final int partitionId=op.getPartitionId();
  final ExecutorService executor=getExecutor(partitionId);
  executor.execute(new Runnable(){
    public void run(){
      if (partitionId != -1 && !nonBlocking) {
        PartitionInfo partitionInfo=getPartitionInfo(partitionId);
        Address owner=partitionInfo.getReplicaAddress(op.getReplicaIndex());
        if (!getThisAddress().equals(owner)) {
          op.getResponseHandler().sendResponse(new WrongTargetException(getThisAddress(),owner,partitionId,op.getClass().getName()));
          return;
        }
      }
      try {
        op.run();
      }
 catch (      Throwable e) {
        logOperationError(e);
        op.getResponseHandler().sendResponse(e);
      }
    }
  }
);
}

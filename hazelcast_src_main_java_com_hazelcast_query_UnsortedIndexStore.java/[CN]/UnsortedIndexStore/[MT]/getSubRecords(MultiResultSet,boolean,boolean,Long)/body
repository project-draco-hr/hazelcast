{
  Set<Long> values=mapRecords.keySet();
  for (  Long value : values) {
    boolean valid;
    if (lessThan) {
      valid=(equal) ? (value <= searchedValue) : (value < searchedValue);
    }
 else {
      valid=(equal) ? (value >= searchedValue) : (value > searchedValue);
    }
    if (valid) {
      ConcurrentMap<Long,Record> records=mapRecords.get(value);
      if (records != null) {
        results.addResultSet(value,records.values());
      }
    }
  }
}

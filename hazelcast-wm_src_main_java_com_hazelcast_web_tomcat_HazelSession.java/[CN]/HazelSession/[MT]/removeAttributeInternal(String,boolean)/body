{
  if (name == null)   return;
  HazelAttribute hattribute=(HazelAttribute)attributes.get(name);
  if (hattribute == null || hattribute.getValue() == null) {
    return;
  }
  Object value=hattribute.getValue();
  hattribute.setValue(null);
  long requestId=HazelValve.requestLocal.get();
  hattribute.touch(requestId);
  attributes.put(name,hattribute);
  if (!notify || (value == null)) {
    return;
  }
  HttpSessionBindingEvent event=null;
  if (value instanceof HttpSessionBindingListener) {
    event=new HttpSessionBindingEvent(getSession(),name,value);
    ((HttpSessionBindingListener)value).valueUnbound(event);
  }
  Context context=(Context)manager.getContainer();
  Object listeners[]=context.getApplicationEventListeners();
  if (listeners == null)   return;
  for (int i=0; i < listeners.length; i++) {
    if (!(listeners[i] instanceof HttpSessionAttributeListener))     continue;
    HttpSessionAttributeListener listener=(HttpSessionAttributeListener)listeners[i];
    try {
      fireContainerEvent(context,"beforeSessionAttributeRemoved",listener);
      if (event == null) {
        event=new HttpSessionBindingEvent(getSession(),name,value);
      }
      listener.attributeRemoved(event);
      fireContainerEvent(context,"afterSessionAttributeRemoved",listener);
    }
 catch (    Throwable t) {
      try {
        fireContainerEvent(context,"afterSessionAttributeRemoved",listener);
      }
 catch (      Exception e) {
        ;
      }
      manager.getContainer().getLogger().error(sm.getString("standardSession.attributeEvent"),t);
    }
  }
}

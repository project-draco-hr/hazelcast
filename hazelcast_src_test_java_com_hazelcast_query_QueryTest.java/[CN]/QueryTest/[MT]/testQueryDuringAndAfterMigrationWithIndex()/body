{
  Config config=new Config();
  StaticNodeFactory factory=new StaticNodeFactory(4);
  HazelcastInstance h1=factory.newHazelcastInstance(config);
  IMap imap=h1.getMap("employees");
  imap.addIndex("name",false);
  imap.addIndex("age",true);
  imap.addIndex("active",false);
  for (int i=0; i < 10000; i++) {
    imap.put(String.valueOf(i),new Employee("joe" + i,i % 60,((i & 1) == 1),Double.valueOf(i)));
  }
  HazelcastInstance h2=factory.newHazelcastInstance(config);
  HazelcastInstance h3=factory.newHazelcastInstance(config);
  HazelcastInstance h4=factory.newHazelcastInstance(config);
  long startNow=Clock.currentTimeMillis();
  int count=0;
  while ((Clock.currentTimeMillis() - startNow) < 50000) {
    Collection<Employee> values=imap.values(new SqlPredicate("active and name LIKE 'joe15%'"));
    Set names=new HashSet();
    for (    Employee employee : values) {
      assertTrue(employee.isActive());
      assertTrue(employee.getName().startsWith("joe15"));
      if (!names.add(employee.getName())) {
        fail();
      }
    }
    assertEquals(56,values.size());
    count++;
  }
  System.out.println("Done " + count);
}

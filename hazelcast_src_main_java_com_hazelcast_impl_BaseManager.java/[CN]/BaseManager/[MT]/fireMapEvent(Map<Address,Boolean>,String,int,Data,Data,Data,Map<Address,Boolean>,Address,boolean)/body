{
  if (keyListeners == null && (mapListeners == null || mapListeners.size() == 0)) {
    return;
  }
  try {
    Map<Address,Boolean> mapTargetListeners=null;
    if (keyListeners != null) {
      mapTargetListeners=new HashMap<Address,Boolean>(keyListeners);
    }
    if (mapListeners != null && mapListeners.size() > 0) {
      if (mapTargetListeners == null) {
        mapTargetListeners=new HashMap<Address,Boolean>(mapListeners);
      }
 else {
        final Set<Map.Entry<Address,Boolean>> entries=mapListeners.entrySet();
        for (        final Map.Entry<Address,Boolean> entry : entries) {
          if (mapTargetListeners.containsKey(entry.getKey())) {
            if (entry.getValue()) {
              mapTargetListeners.put(entry.getKey(),entry.getValue());
            }
          }
 else {
            mapTargetListeners.put(entry.getKey(),entry.getValue());
          }
        }
      }
    }
    if (mapTargetListeners == null || mapTargetListeners.size() == 0) {
      return;
    }
    Data packetValue=value;
    if (value != null && getInstanceType(name).isMap()) {
      Keys keys=new Keys();
      keys.add(value);
      if (oldValue != null) {
        keys.add(oldValue);
      }
      packetValue=toData(keys);
    }
    sendEvents(eventType,name,key,packetValue,mapTargetListeners,callerAddress,fireAndForget);
  }
 catch (  final Exception e) {
    logger.log(Level.WARNING,e.getMessage(),e);
  }
}

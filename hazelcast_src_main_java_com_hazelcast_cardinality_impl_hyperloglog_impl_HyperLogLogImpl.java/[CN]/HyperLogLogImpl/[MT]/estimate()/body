{
  if (cachedEstimate == null) {
    convertToDenseIfNeeded();
    cachedEstimate=encoder.estimate();
  }
  return cachedEstimate;
}

{
  HazelcastInstance h=Hazelcast.newHazelcastInstance(null);
  HazelcastInstance client=newHazelcastClient(h);
  Transaction transaction=client.getTransaction();
  transaction.begin();
  Map<String,String> map=client.getMap("rollbackTransactionWhenClientDies");
  map.put("1","A");
  client.getLifecycleService().shutdown();
  assertTrue(h.getMap("rollbackTransactionWhenClientDies").isEmpty());
  h.getMap("rollbackTransactionWhenClientDies").put("1","B");
  assertEquals("B",h.getMap("rollbackTransactionWhenClientDies").get("1"));
}

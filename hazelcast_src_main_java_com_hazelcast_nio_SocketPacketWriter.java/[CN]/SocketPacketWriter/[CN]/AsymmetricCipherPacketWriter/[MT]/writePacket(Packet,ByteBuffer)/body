{
  if (!aliasWritten) {
    String localAlias=CipherHelper.getKeyAlias(connection.getConnectionManager().ioService);
    byte[] localAliasBytes=localAlias.getBytes();
    socketBB.putInt(localAliasBytes.length);
    socketBB.put(localAliasBytes);
    aliasWritten=true;
  }
  boolean complete=encryptAndWrite(packet,socketBB);
  if (complete) {
    aliasWritten=false;
  }
  return complete;
}

{
  while (src.hasRemaining()) {
    int remaining=src.remaining();
    if (remaining > writeBlockSize) {
      int oldLimit=src.limit();
      src.limit(src.position() + writeBlockSize);
      int outputAppendSize=cipher.doFinal(src,cipherBuffer);
      src.limit(oldLimit);
    }
 else {
      int outputAppendSize=cipher.doFinal(src,cipherBuffer);
    }
  }
}

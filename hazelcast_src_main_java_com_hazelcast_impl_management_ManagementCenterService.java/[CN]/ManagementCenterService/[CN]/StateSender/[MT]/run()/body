{
  if (webServerUrl == null) {
    logger.log(Level.WARNING,"Web server url is null!");
    return;
  }
  try {
    boolean firstError=true;
    while (running.get()) {
      if (versionMismatch) {
        Thread.sleep(1000);
        versionMismatch=false;
      }
      try {
        URL url=new URL(webServerUrl + "collector.do");
        HttpURLConnection connection=(HttpURLConnection)url.openConnection();
        connection.setDoOutput(true);
        connection.setRequestMethod("POST");
        connection.setConnectTimeout(1000);
        connection.setReadTimeout(1000);
        final DataOutputStream out=new DataOutputStream(connection.getOutputStream());
        TimedMemberState ts=getTimedMemberState();
        out.writeUTF(getHazelcastInstance().node.initializer.getVersion());
        factory.node.getThisAddress().writeData(out);
        out.writeUTF(factory.getConfig().getGroupConfig().getName());
        ts.writeData(out);
        out.flush();
        connection.getInputStream();
      }
 catch (      Exception e) {
        if (firstError) {
          logger.log(Level.SEVERE,"Can not connect to Management Center. Check url connectivity:" + webServerUrl);
          firstError=false;
        }
 else {
          logger.log(Level.FINEST,e.getMessage(),e);
        }
      }
      Thread.sleep(updateIntervalMs);
    }
  }
 catch (  Throwable throwable) {
    if (throwable instanceof OutOfMemoryError) {
      OutOfMemoryErrorDispatcher.onOutOfMemory((OutOfMemoryError)throwable);
    }
    logger.log(Level.FINEST,"Web Management Center will be closed due to exception.",throwable);
    shutdown();
  }
}

{
  InternalPartitionServiceImpl service=getService();
  long[] versions=service.getPartitionReplicaVersions(getPartitionId());
  long version=0L;
  int ix=-1;
  for (int i=0; i < versions.length; i++) {
    if (versions[i] > 0) {
      version=versions[i];
      ix=i;
      break;
    }
  }
  ILogger logger=getLogger();
  boolean loggable=ix > 0 && logger.isFinestEnabled();
  String log=null;
  if (loggable) {
    log="Setting missing replica versions for partitionId=" + getPartitionId() + " overwriting-replicaIndex="+ (ix + 1)+ " Changed from replicaVersions="+ Arrays.toString(versions);
  }
  for (int i=0; i < ix; i++) {
    if (logger.isFinestEnabled() && versions[i] == InternalPartition.SYNC_WAITING) {
      logger.finest("SYNC_WAITING is overwritten. partitionId=" + getPartitionId() + " replicaIndex="+ (i + 1)+ " newVersion="+ version);
    }
    versions[i]=version;
  }
  if (loggable) {
    log+=" to replicaVersions=" + Arrays.toString(versions);
    logger.finest(log);
  }
}

{
  this.partitionId=partitionId;
  this.replicaIndex=replicaIndex;
  this.from=from;
  ByteArrayOutputStream bos=new ByteArrayOutputStream((int)(costAwareRecordList.getCost() / 100));
  DataOutputStream dos=null;
  try {
    dos=new DataOutputStream(new DeflaterOutputStream(bos));
    List<Record> lsRecordsToMigrate=costAwareRecordList.getRecords();
    dos.writeInt(lsRecordsToMigrate.size());
    for (    Record record : lsRecordsToMigrate) {
      new DataRecordEntry(record).writeData(dos);
    }
  }
  finally {
    IOUtil.closeResource(dos);
  }
  bytesRecordSet=bos.toByteArray();
}

{
  this.partitionId=partitionId;
  this.replicaIndex=replicaIndex;
  ByteArrayOutputStream bos=new ByteArrayOutputStream((int)(costAwareRecordList.getCost() / 100));
  DataOutputStream dos=new DataOutputStream(new DeflaterOutputStream(bos));
  List<Record> lsRecordsToMigrate=costAwareRecordList.getRecords();
  dos.writeInt(lsRecordsToMigrate.size());
  for (  Record record : lsRecordsToMigrate) {
    new DataRecordEntry(record).writeData(dos);
  }
  dos.flush();
  dos.close();
  bytesRecordSet=bos.toByteArray();
}

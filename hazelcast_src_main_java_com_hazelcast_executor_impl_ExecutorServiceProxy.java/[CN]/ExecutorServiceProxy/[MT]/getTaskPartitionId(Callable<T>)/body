{
  int partitionId;
  if (task instanceof PartitionAware) {
    final Object partitionKey=((PartitionAware)task).getPartitionKey();
    partitionId=getNodeEngine().getPartitionService().getPartitionId(partitionKey);
  }
 else {
    partitionId=random.nextInt(partitionCount);
  }
  return partitionId;
}

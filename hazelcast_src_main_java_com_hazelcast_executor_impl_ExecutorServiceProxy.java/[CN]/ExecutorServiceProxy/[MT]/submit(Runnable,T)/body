{
  if (task == null) {
    throw new NullPointerException();
  }
  if (isShutdown()) {
    throw new RejectedExecutionException(getRejectionMessage());
  }
  NodeEngine nodeEngine=getNodeEngine();
  Callable<T> callable=createRunnableAdapter(task);
  Data callableData=nodeEngine.toData(callable);
  String uuid=buildRandomUuidString();
  int partitionId=getTaskPartitionId(callable);
  CallableTaskOperation op=new CallableTaskOperation(name,uuid,callableData);
  ICompletableFuture future=invoke(partitionId,op);
  boolean sync=checkSync();
  if (sync) {
    try {
      future.get();
    }
 catch (    Exception exception) {
      logger.warning(exception);
    }
    return new CompletedFuture<T>(nodeEngine.getSerializationService(),result,getAsyncExecutor());
  }
  return new CancellableDelegatingFuture<T>(future,result,nodeEngine,uuid,partitionId);
}
